import{u as Pt,j as o,as as Cn,aX as or,d as k,B as E,r as de,b7 as ar,b8 as lr,a3 as cr,a_ as Sn,ah as lt,b9 as jn,I as we,Q as Wt,ba as $t,h as q,bb as Rn,ao as gt,ap as xt,aq as vt,b1 as Z,a6 as Ie,a7 as Te,a8 as Ae,f as X,bc as dr,bd as En,an as In,ar as bt,aI as ur,b3 as an,O as mt,i as be,aD as Qe,aU as dt,be as fr,C as hr,P as pr,bf as gr,bg as Et}from"./mui-Be33Q-K3.js";import{r as c,a as Y,c as Xe}from"./vendor-By_F_pnL.js";import{u as xr,c as vr,d as br,g as mr,a as yr,b as wr,e as Dr,h as Cr,i as ln,j as Sr,k as jr,l as Rr}from"./firestore-CvuUZNys.js";import{d as Er,f as Ir}from"./index-9eOP6H1w.js";import{A as It}from"./index-jvwznmng.js";import{m as Tr}from"./index-BTN6umcJ.js";const Ar=({component:e,onEdit:t,onDelete:n,onSelect:r})=>{const s=Pt();return o.jsxs(Cn,{sx:{height:"100%",display:"flex",flexDirection:"column",transition:"all 0.2s","&:hover":{boxShadow:4,transform:"translateY(-2px)"},border:`1px solid ${s.palette.mode==="dark"?s.palette.grey[800]:s.palette.grey[300]}`,marginTop:.5},children:[o.jsx(or,{title:o.jsxs(E,{sx:{display:"flex",alignItems:"center"},children:[o.jsx(k,{variant:"h6",component:"div",children:e.component}),e.device==="mobile"?o.jsx(de,{title:"Mobile Component",children:o.jsx(ar,{color:"secondary",sx:{ml:1}})}):o.jsx(de,{title:"Desktop Component",children:o.jsx(lr,{sx:{ml:1}})})]}),subheader:o.jsxs(k,{variant:"caption",color:"text.secondary",children:["ID: ",e.componentId]})}),o.jsx(cr,{}),o.jsxs(Sn,{sx:{flexGrow:1},children:[o.jsxs(E,{sx:{mb:2},children:[o.jsx(k,{variant:"subtitle1",gutterBottom:!0,children:e.title}),o.jsx(k,{variant:"body2",color:"text.secondary",sx:{display:"-webkit-box",overflow:"hidden",WebkitBoxOrient:"vertical",WebkitLineClamp:3},children:e.description})]}),o.jsxs(E,{sx:{display:"flex",gap:1,mb:2},children:[o.jsx(lt,{label:e.brand,size:"small",color:e.brand==="lexus"?"secondary":"primary"}),o.jsx(lt,{label:e.context,size:"small",color:"default"})]}),e.tags&&e.tags.length>0&&o.jsx(E,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.tags.map(i=>o.jsx(lt,{label:i,size:"small",variant:"outlined",sx:{fontSize:"0.7rem"}},i))})]}),o.jsxs(jn,{sx:{justifyContent:"space-between",px:2,pb:2},children:[o.jsxs(E,{children:[o.jsx(de,{title:"Edit",children:o.jsx(we,{size:"small",onClick:()=>t(e),children:o.jsx(Wt,{fontSize:"small"})})}),o.jsx(de,{title:"Delete",children:o.jsx(we,{size:"small",color:"error",onClick:()=>n(e),children:o.jsx($t,{fontSize:"small"})})})]}),o.jsx(q,{variant:"contained",size:"small",onClick:()=>r(e.id),endIcon:o.jsx(Rn,{}),children:"View Scenarios"})]})]})},Or=({open:e,isEditing:t,currentComponent:n,formErrors:r,onClose:s,onChange:i,onSelectChange:a,onTagsChange:l,onDeviceChange:u,onSave:h})=>o.jsxs(gt,{open:e,onClose:s,fullWidth:!0,maxWidth:"md",children:[o.jsx(xt,{children:t?"Edit Component":"Add New Component"}),o.jsx(vt,{children:o.jsxs(E,{sx:{mt:1,display:"flex",flexDirection:"column",gap:2},children:[o.jsx(Z,{name:"componentId",label:"Component ID",fullWidth:!0,value:(n==null?void 0:n.componentId)||"",onChange:i,disabled:t,helperText:"Unique identifier for this component"}),o.jsx(E,{sx:{display:"flex",gap:2},children:o.jsxs(Ie,{fullWidth:!0,children:[o.jsx(Te,{id:"component-label",children:"Component Name"}),o.jsx(Ae,{labelId:"component-label",name:"component",value:(n==null?void 0:n.component)||"car-filter",onChange:a,label:"Component Name",error:!!r.component,required:!0,children:Object.entries(Er).map(([f,{title:d,description:g}])=>o.jsxs(X,{value:f,sx:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[d,o.jsx(E,{sx:{fontSize:"0.8em",color:"text.secondary"},children:g})]},f))})]})}),o.jsxs(E,{sx:{display:"flex",gap:2},children:[o.jsxs(Ie,{fullWidth:!0,children:[o.jsx(Te,{id:"brand-label",children:"Brand"}),o.jsxs(Ae,{labelId:"brand-label",name:"brand",value:(n==null?void 0:n.brand)||"toyota",onChange:a,label:"Brand",children:[o.jsx(X,{value:"toyota",children:"Toyota"}),o.jsx(X,{value:"lexus",children:"Lexus"})]})]}),o.jsxs(Ie,{fullWidth:!0,children:[o.jsx(Te,{id:"context-label",children:"Context"}),o.jsxs(Ae,{labelId:"context-label",name:"context",value:(n==null?void 0:n.context)||"used",onChange:a,label:"Context",children:[o.jsx(X,{value:"used",children:"Used"}),o.jsx(X,{value:"stock",children:"Stock"}),o.jsx(X,{value:"new",children:"New"})]})]})]}),o.jsx(Z,{name:"title",label:"Title",fullWidth:!0,value:(n==null?void 0:n.title)||"",onChange:i,error:!!r.title,helperText:r.title||"A user-friendly title for this component",required:!0}),o.jsx(Z,{name:"description",label:"Description",fullWidth:!0,multiline:!0,rows:3,value:(n==null?void 0:n.description)||"",onChange:i,error:!!r.description,helperText:r.description||"Detailed description of the component's purpose and functionality",required:!0}),o.jsxs(Ie,{fullWidth:!0,children:[o.jsx(Te,{id:"tags-label",children:"Tags"}),o.jsx(Ae,{labelId:"tags-label",multiple:!0,value:(n==null?void 0:n.tags)||[],onChange:l,input:o.jsx(dr,{label:"Tags"}),renderValue:f=>o.jsx(E,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:f.map(d=>o.jsx(lt,{label:d,size:"small"},d))}),children:["filters","search","details","specs","photos","pricing","forms"].map(f=>o.jsx(X,{value:f,children:f},f))})]}),o.jsx(En,{control:o.jsx(In,{checked:(n==null?void 0:n.device)==="mobile",onChange:f=>u(f.target.checked)}),label:"Mobile-specific component"})]})}),o.jsxs(bt,{children:[o.jsx(q,{onClick:s,children:"Cancel"}),o.jsx(q,{onClick:h,variant:"contained",children:t?"Update":"Create"})]})]}),Mr=({searchTerm:e,filterBrand:t,filterContext:n,onSearchChange:r,onBrandFilterChange:s,onContextFilterChange:i})=>o.jsxs(E,{sx:{mb:3,display:"flex",gap:2,flexWrap:"wrap"},children:[o.jsx(Z,{placeholder:"Search components...",size:"small",InputProps:{startAdornment:o.jsx(ur,{sx:{color:"action.active",mr:1}})},value:e,onChange:a=>r(a.target.value),sx:{flexGrow:1,minWidth:"200px"}}),o.jsxs(Ie,{size:"small",sx:{minWidth:120},children:[o.jsx(Te,{id:"filter-brand-label",children:"Brand"}),o.jsxs(Ae,{labelId:"filter-brand-label",value:t,label:"Brand",onChange:a=>s(a.target.value),startAdornment:o.jsx(an,{sx:{color:"action.active",mr:1,ml:-.5}}),children:[o.jsx(X,{value:"all",children:"All Brands"}),o.jsx(X,{value:"toyota",children:"Toyota"}),o.jsx(X,{value:"lexus",children:"Lexus"})]})]}),o.jsxs(Ie,{size:"small",sx:{minWidth:120},children:[o.jsx(Te,{id:"filter-context-label",children:"Context"}),o.jsxs(Ae,{labelId:"filter-context-label",value:n,label:"Context",onChange:a=>i(a.target.value),startAdornment:o.jsx(an,{sx:{color:"action.active",mr:1,ml:-.5}}),children:[o.jsx(X,{value:"all",children:"All Contexts"}),o.jsx(X,{value:"used",children:"Used"}),o.jsx(X,{value:"stock",children:"Stock"}),o.jsx(X,{value:"new",children:"New"})]})]})]}),qt=({open:e,title:t="Confirm Deletion",messageContent:n,itemName:r,itemType:s="item",additionalWarning:i,loading:a=!1,contentSx:l,onClose:u,onConfirm:h,confirmButtonText:f="Delete",cancelButtonText:d="Cancel"})=>o.jsxs(gt,{open:e,onClose:u,children:[o.jsx(xt,{children:t}),o.jsxs(vt,{sx:l,children:[o.jsx(mt,{severity:"warning",sx:{mb:2},children:"This action cannot be undone!"}),n||o.jsxs(o.Fragment,{children:[o.jsxs(k,{children:["Are you sure you want to delete"," ",r?`the ${s} "${r}"`:`this ${s}`,"?",i&&` ${i}`]}),r&&s==="test step"&&o.jsxs(k,{variant:"body2",sx:{mt:1,mb:1,fontStyle:"italic"},children:['"',r,'"']})]})]}),o.jsxs(bt,{children:[o.jsx(q,{onClick:u,children:d}),o.jsx(q,{onClick:h,color:"error",variant:"contained",disabled:a,children:a?o.jsx(be,{size:24}):f})]})]}),kr=e=>{const[t,n]=c.useState(""),[r,s]=c.useState("all"),[i,a]=c.useState("all"),l=c.useMemo(()=>Ir(e,t,r,i),[e,t,r,i]);return{searchTerm:t,filterBrand:r,filterContext:i,setSearchTerm:n,setFilterBrand:s,setFilterContext:a,filteredComponents:l,clearFilters:()=>{n(""),s("all"),a("all")}}},Nr=e=>{const[t,n]=c.useState(!1),[r,s]=c.useState(!1),[i,a]=c.useState(null),[l,u]=c.useState({}),h=p=>{p?(a(p),s(!0)):(a({componentId:`comp-${Date.now()}`,component:"",brand:"toyota",context:"used",title:"",description:"",tags:[],device:"desktop"}),s(!1)),u({}),n(!0)},f=()=>{n(!1),a(null)},d=p=>{const{name:y,value:w}=p.target;y&&a(D=>({...D,[y]:w}))},g=(p,y)=>{const w=p.target.name;a(D=>({...D,[w]:p.target.value}))},x=p=>{a(y=>({...y,tags:p.target.value}))},m=p=>{a(y=>({...y,device:p?"mobile":"desktop"}))},b=()=>{const p={};return i!=null&&i.component||(p.component="Component name is required"),i!=null&&i.title||(p.title="Title is required"),i!=null&&i.description||(p.description="Description is required"),u(p),Object.keys(p).length===0};return{currentComponent:i,setCurrentComponent:a,isEditing:r,formErrors:l,dialogOpen:t,handleOpenDialog:h,handleCloseDialog:f,handleChange:d,handleSelectChange:g,handleTagsChange:x,handleDeviceChange:m,handleSave:async()=>{if(!(!i||!b()))try{if(r&&i.id){const{id:p,createdAt:y,updatedAt:w,...D}=i;await xr(p,D)}else{const{id:p,createdAt:y,updatedAt:w,...D}=i;await vr(D)}f(),e()}catch(p){console.error("Error saving component:",p)}},validateForm:b}},Fr=({components:e,onSelectComponent:t,onComponentsChange:n})=>{const{searchTerm:r,filterBrand:s,filterContext:i,setSearchTerm:a,setFilterBrand:l,setFilterContext:u,filteredComponents:h,clearFilters:f}=kr(e),{currentComponent:d,setCurrentComponent:g,isEditing:x,formErrors:m,dialogOpen:b,handleOpenDialog:v,handleCloseDialog:p,handleChange:y,handleSelectChange:w,handleTagsChange:D,handleDeviceChange:I,handleSave:T}=Nr(()=>{n==null||n()}),[j,S]=c.useState(!1),M=R=>{g(R),S(!0)},C=async()=>{if(d!=null&&d.id)try{await br(d.id),S(!1),p(),n==null||n()}catch(R){console.error("Error deleting component:",R)}};return o.jsxs(E,{sx:{height:"100%",width:"100%",display:"flex",flexDirection:"column"},children:[o.jsxs(E,{sx:{mb:3,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx(k,{variant:"h6",component:"h2",children:"Components"}),o.jsx(E,{children:o.jsx(q,{variant:"contained",startIcon:o.jsx(Qe,{}),onClick:()=>v(),children:"Add Component"})})]}),o.jsx(Mr,{searchTerm:r,filterBrand:s,filterContext:i,onSearchChange:a,onBrandFilterChange:l,onContextFilterChange:u}),o.jsx(E,{sx:{flexGrow:1,overflow:"auto"},children:e.length===0?o.jsxs(E,{sx:{textAlign:"center",py:8},children:[o.jsx(be,{sx:{mb:2}}),o.jsx(k,{children:"Loading components..."})]}):h.length===0?o.jsxs(E,{sx:{textAlign:"center",py:8},children:[o.jsx(k,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No components match your search"}),o.jsx(q,{variant:"outlined",onClick:f,children:"Clear Filters"})]}):o.jsx(dt,{container:!0,spacing:2,children:o.jsx(It,{mode:"popLayout",children:h.map((R,F)=>o.jsx(dt,{size:{xs:12,sm:6,md:4},component:Tr.div,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.95},transition:{duration:.35,delay:F*.05,ease:"easeOut"},layout:!0,children:o.jsx(Ar,{component:R,onEdit:v,onDelete:M,onSelect:t})},R.id))})})}),o.jsx(It,{children:b&&o.jsx(Or,{open:b,isEditing:x,currentComponent:d,formErrors:m,onClose:p,onChange:y,onSelectChange:w,onTagsChange:D,onDeviceChange:I,onSave:T})}),o.jsx(It,{children:j&&o.jsx(qt,{open:j,title:"Confirm Deletion",itemName:(d==null?void 0:d.title)||"",itemType:"component",additionalWarning:"This will also delete all scenarios and test steps associated with this component.",onClose:()=>S(!1),onConfirm:C})})]})},Lr=e=>{const[t,n]=c.useState([]),[r,s]=c.useState(!1),[i,a]=c.useState(null),[l,u]=c.useState(!1),[h,f]=c.useState(!1),[d,g]=c.useState(null),[x,m]=c.useState({}),[b,v]=c.useState(!1),p=async()=>{s(!0),a(null);try{const C=await mr(e);n(C)}catch(C){console.error("Error fetching scenarios:",C),a("Failed to load scenarios. Please try again.")}finally{s(!1)}};c.useEffect(()=>{e&&p()},[e]);const y=C=>{if(C)g(C),f(!0);else{const R=t.length>0?Math.max(...t.map(F=>F.order))+1:0;g({scenarioId:`scenario-${Date.now()}`,title:"",description:"",order:R}),f(!1)}m({}),u(!0)},w=()=>{u(!1),g(null)},D=C=>{const{name:R,value:F}=C.target;R&&g(L=>({...L,[R]:F}))},I=()=>{const C={};return d!=null&&d.scenarioId||(C.scenarioId="Scenario ID is required"),d!=null&&d.title||(C.title="Title is required"),d!=null&&d.description||(C.description="Description is required"),m(C),Object.keys(C).length===0},T=async()=>{if(!(!d||!I()))try{if(s(!0),h&&d.id){const{id:C,createdAt:R,updatedAt:F,...L}=d;await wr(e,C,L)}else{const{id:C,createdAt:R,updatedAt:F,...L}=d;await Dr(e,L)}await p(),w()}catch(C){console.error("Error saving scenario:",C),a("Failed to save scenario. Please try again.")}finally{s(!1)}},j=C=>{g(C),v(!0)},S=()=>{v(!1)};return{scenarios:t,loading:r,error:i,currentScenario:d,formErrors:x,dialogOpen:l,isEditing:h,deleteDialogOpen:b,openDialog:y,closeDialog:w,handleChange:D,saveScenario:T,confirmDelete:j,closeDeleteDialog:S,executeDelete:async()=>{if(d!=null&&d.id)try{s(!0),await yr(e,d.id),await p(),S()}catch(C){console.error("Error deleting scenario:",C),a("Failed to delete scenario. Please try again.")}finally{s(!1)}},refreshScenarios:p}},zr=({scenario:e,onEdit:t,onDelete:n,onSelect:r})=>{const s=Pt();return o.jsxs(Cn,{elevation:1,sx:{height:"100%",display:"flex",flexDirection:"column",transition:"all 0.2s","&:hover":{boxShadow:4,transform:"translateY(-2px)"},border:`1px solid ${s.palette.mode==="dark"?s.palette.grey[800]:s.palette.grey[300]}`},children:[o.jsxs(Sn,{sx:{flexGrow:1},children:[o.jsx(k,{variant:"h6",gutterBottom:!0,component:"div",noWrap:!0,children:e.title}),o.jsxs(k,{variant:"caption",color:"text.secondary",gutterBottom:!0,sx:{display:"block"},children:["ID: ",e.scenarioId]}),o.jsx(k,{variant:"body2",color:"text.secondary",sx:{display:"-webkit-box",overflow:"hidden",WebkitBoxOrient:"vertical",WebkitLineClamp:3},children:e.description})]}),o.jsxs(jn,{sx:{justifyContent:"space-between"},children:[o.jsxs(E,{children:[o.jsx(de,{title:"Edit",children:o.jsx(we,{size:"small",onClick:()=>t(e),children:o.jsx(Wt,{fontSize:"small"})})}),o.jsx(de,{title:"Delete",children:o.jsx(we,{size:"small",color:"error",onClick:()=>n(e),children:o.jsx($t,{fontSize:"small"})})})]}),o.jsx(de,{title:"View Test Steps",children:o.jsx(we,{size:"small",color:"primary",onClick:()=>r(e.id),children:o.jsx(Rn,{fontSize:"small"})})})]})]})},Br=({open:e,isEditing:t,loading:n,scenario:r,formErrors:s,onClose:i,onSave:a,onChange:l})=>o.jsxs(gt,{open:e,onClose:i,fullWidth:!0,maxWidth:"md",children:[o.jsx(xt,{children:t?"Edit Scenario":"Add New Scenario"}),o.jsx(vt,{children:o.jsxs(E,{sx:{mt:1,display:"flex",flexDirection:"column",gap:2},children:[o.jsx(Z,{name:"scenarioId",label:"Scenario ID",fullWidth:!0,value:(r==null?void 0:r.scenarioId)||"",onChange:l,disabled:t,error:!!s.scenarioId,helperText:s.scenarioId||"Unique identifier for this scenario",required:!0}),o.jsx(Z,{name:"title",label:"Title",fullWidth:!0,value:(r==null?void 0:r.title)||"",onChange:l,error:!!s.title,helperText:s.title||"A descriptive title for this scenario",required:!0}),o.jsx(Z,{name:"description",label:"Description",fullWidth:!0,multiline:!0,rows:3,value:(r==null?void 0:r.description)||"",onChange:l,error:!!s.description,helperText:s.description||"Detailed description of what this scenario tests",required:!0}),o.jsx(Z,{name:"order",label:"Display Order",type:"number",fullWidth:!0,value:(r==null?void 0:r.order)||0,onChange:l,helperText:"Scenarios are displayed in this order (lower numbers first)"})]})}),o.jsxs(bt,{children:[o.jsx(q,{onClick:i,children:"Cancel"}),o.jsx(q,{onClick:a,variant:"contained",disabled:n,children:n?o.jsx(be,{size:24}):t?"Update":"Create"})]})]}),Pr=({onAddClick:e})=>o.jsxs(E,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",py:8},children:[o.jsx(k,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No scenarios found"}),o.jsx(k,{variant:"body2",color:"text.secondary",mb:2,children:"Add your first scenario to get started"}),o.jsx(q,{variant:"outlined",startIcon:o.jsx(Qe,{}),onClick:e,children:"Add Scenario"})]}),Wr=({componentId:e,onSelectScenario:t})=>{const{scenarios:n,loading:r,error:s,currentScenario:i,formErrors:a,dialogOpen:l,isEditing:u,deleteDialogOpen:h,openDialog:f,closeDialog:d,handleChange:g,saveScenario:x,confirmDelete:m,closeDeleteDialog:b,executeDelete:v}=Lr(e);return o.jsxs(E,{sx:{height:"100%",width:"100%",display:"flex",flexDirection:"column"},children:[o.jsxs(E,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx(k,{variant:"h6",component:"h2",children:"Test Scenarios"}),o.jsx(q,{variant:"contained",startIcon:o.jsx(Qe,{}),onClick:()=>f(),children:"Add Scenario"})]}),s&&o.jsx(mt,{severity:"error",sx:{mb:2},children:s}),r&&n.length===0?o.jsx(E,{sx:{display:"flex",justifyContent:"center",pt:4},children:o.jsx(be,{})}):n.length===0?o.jsx(Pr,{onAddClick:()=>f()}):o.jsx(dt,{container:!0,spacing:2,children:n.map(p=>o.jsx(dt,{size:{xs:12,sm:6,md:4},children:o.jsx(zr,{scenario:p,onEdit:f,onDelete:m,onSelect:t})},p.id))}),o.jsx(Br,{open:l,isEditing:u,loading:r,scenario:i,formErrors:a,onClose:d,onSave:x,onChange:g}),o.jsx(qt,{open:h,loading:r,itemName:(i==null?void 0:i.title)||"",itemType:"scenario",additionalWarning:"This will also delete all test steps associated with this scenario.",onClose:b,onConfirm:v})]})};function $r(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return c.useMemo(()=>r=>{t.forEach(s=>s(r))},t)}const yt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Me(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Ut(e){return"nodeType"in e}function G(e){var t,n;return e?Me(e)?e:Ut(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Xt(e){const{Document:t}=G(e);return e instanceof t}function Ze(e){return Me(e)?!1:e instanceof G(e).HTMLElement}function Tn(e){return e instanceof G(e).SVGElement}function ke(e){return e?Me(e)?e.document:Ut(e)?Xt(e)?e:Ze(e)||Tn(e)?e.ownerDocument:document:document:document}const se=yt?c.useLayoutEffect:c.useEffect;function Yt(e){const t=c.useRef(e);return se(()=>{t.current=e}),c.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}function qr(){const e=c.useRef(null),t=c.useCallback((r,s)=>{e.current=setInterval(r,s)},[]),n=c.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function He(e,t){t===void 0&&(t=[e]);const n=c.useRef(e);return se(()=>{n.current!==e&&(n.current=e)},t),n}function et(e,t){const n=c.useRef();return c.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function ut(e){const t=Yt(e),n=c.useRef(null),r=c.useCallback(s=>{s!==n.current&&(t==null||t(s,n.current)),n.current=s},[]);return[n,r]}function Nt(e){const t=c.useRef();return c.useEffect(()=>{t.current=e},[e]),t.current}let Tt={};function tt(e,t){return c.useMemo(()=>{if(t)return t;const n=Tt[e]==null?0:Tt[e]+1;return Tt[e]=n,e+"-"+n},[e,t])}function An(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((i,a)=>{const l=Object.entries(a);for(const[u,h]of l){const f=i[u];f!=null&&(i[u]=f+e*h)}return i},{...t})}}const Oe=An(1),Ke=An(-1);function Ur(e){return"clientX"in e&&"clientY"in e}function Gt(e){if(!e)return!1;const{KeyboardEvent:t}=G(e.target);return t&&e instanceof t}function Xr(e){if(!e)return!1;const{TouchEvent:t}=G(e.target);return t&&e instanceof t}function Ft(e){if(Xr(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Ur(e)?{x:e.clientX,y:e.clientY}:null}const _e=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[_e.Translate.toString(e),_e.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),cn="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Yr(e){return e.matches(cn)?e:e.querySelector(cn)}const Gr={display:"none"};function Vr(e){let{id:t,value:n}=e;return Y.createElement("div",{id:t,style:Gr},n)}function Hr(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Y.createElement("div",{id:t,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function Kr(){const[e,t]=c.useState("");return{announce:c.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const On=c.createContext(null);function _r(e){const t=c.useContext(On);c.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Jr(){const[e]=c.useState(()=>new Set),t=c.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[c.useCallback(r=>{let{type:s,event:i}=r;e.forEach(a=>{var l;return(l=a[s])==null?void 0:l.call(a,i)})},[e]),t]}const Qr={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Zr={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function es(e){let{announcements:t=Zr,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=Qr}=e;const{announce:i,announcement:a}=Kr(),l=tt("DndLiveRegion"),[u,h]=c.useState(!1);if(c.useEffect(()=>{h(!0)},[]),_r(c.useMemo(()=>({onDragStart(d){let{active:g}=d;i(t.onDragStart({active:g}))},onDragMove(d){let{active:g,over:x}=d;t.onDragMove&&i(t.onDragMove({active:g,over:x}))},onDragOver(d){let{active:g,over:x}=d;i(t.onDragOver({active:g,over:x}))},onDragEnd(d){let{active:g,over:x}=d;i(t.onDragEnd({active:g,over:x}))},onDragCancel(d){let{active:g,over:x}=d;i(t.onDragCancel({active:g,over:x}))}}),[i,t])),!u)return null;const f=Y.createElement(Y.Fragment,null,Y.createElement(Vr,{id:r,value:s.draggable}),Y.createElement(Hr,{id:l,announcement:a}));return n?Xe.createPortal(f,n):f}var z;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(z||(z={}));function ft(){}function dn(e,t){return c.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function ts(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return c.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const ee=Object.freeze({x:0,y:0});function Mn(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function kn(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function ns(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function un(e){let{left:t,top:n,height:r,width:s}=e;return[{x:t,y:n},{x:t+s,y:n},{x:t,y:n+r},{x:t+s,y:n+r}]}function Nn(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function fn(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const rs=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=fn(t,t.left,t.top),i=[];for(const a of r){const{id:l}=a,u=n.get(l);if(u){const h=Mn(fn(u),s);i.push({id:l,data:{droppableContainer:a,value:h}})}}return i.sort(kn)},ss=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=un(t),i=[];for(const a of r){const{id:l}=a,u=n.get(l);if(u){const h=un(u),f=s.reduce((g,x,m)=>g+Mn(h[m],x),0),d=Number((f/4).toFixed(4));i.push({id:l,data:{droppableContainer:a,value:d}})}}return i.sort(kn)};function is(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),a=s-r,l=i-n;if(r<s&&n<i){const u=t.width*t.height,h=e.width*e.height,f=a*l,d=f/(u+h-f);return Number(d.toFixed(4))}return 0}const os=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=[];for(const i of r){const{id:a}=i,l=n.get(a);if(l){const u=is(l,t);u>0&&s.push({id:a,data:{droppableContainer:i,value:u}})}}return s.sort(ns)};function as(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function Fn(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:ee}function ls(e){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return s.reduce((a,l)=>({...a,top:a.top+e*l.y,bottom:a.bottom+e*l.y,left:a.left+e*l.x,right:a.right+e*l.x}),{...n})}}const cs=ls(1);function ds(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function us(e,t,n){const r=ds(t);if(!r)return e;const{scaleX:s,scaleY:i,x:a,y:l}=r,u=e.left-a-(1-s)*parseFloat(n),h=e.top-l-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),f=s?e.width/s:e.width,d=i?e.height/i:e.height;return{width:f,height:d,top:h,right:u+f,bottom:h+d,left:u}}const fs={ignoreTransform:!1};function Ne(e,t){t===void 0&&(t=fs);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:h,transformOrigin:f}=G(e).getComputedStyle(e);h&&(n=us(n,h,f))}const{top:r,left:s,width:i,height:a,bottom:l,right:u}=n;return{top:r,left:s,width:i,height:a,bottom:l,right:u}}function hn(e){return Ne(e,{ignoreTransform:!0})}function hs(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function ps(e,t){return t===void 0&&(t=G(e).getComputedStyle(e)),t.position==="fixed"}function gs(e,t){t===void 0&&(t=G(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const i=t[s];return typeof i=="string"?n.test(i):!1})}function wt(e,t){const n=[];function r(s){if(t!=null&&n.length>=t||!s)return n;if(Xt(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!Ze(s)||Tn(s)||n.includes(s))return n;const i=G(e).getComputedStyle(s);return s!==e&&gs(s,i)&&n.push(s),ps(s,i)?n:r(s.parentNode)}return e?r(e):n}function Ln(e){const[t]=wt(e,1);return t??null}function At(e){return!yt||!e?null:Me(e)?e:Ut(e)?Xt(e)||e===ke(e).scrollingElement?window:Ze(e)?e:null:null}function zn(e){return Me(e)?e.scrollX:e.scrollLeft}function Bn(e){return Me(e)?e.scrollY:e.scrollTop}function Lt(e){return{x:zn(e),y:Bn(e)}}var B;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(B||(B={}));function Pn(e){return!yt||!e?!1:e===document.scrollingElement}function Wn(e){const t={x:0,y:0},n=Pn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},s=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,a=e.scrollTop>=r.y,l=e.scrollLeft>=r.x;return{isTop:s,isLeft:i,isBottom:a,isRight:l,maxScroll:r,minScroll:t}}const xs={x:.2,y:.2};function vs(e,t,n,r,s){let{top:i,left:a,right:l,bottom:u}=n;r===void 0&&(r=10),s===void 0&&(s=xs);const{isTop:h,isBottom:f,isLeft:d,isRight:g}=Wn(e),x={x:0,y:0},m={x:0,y:0},b={height:t.height*s.y,width:t.width*s.x};return!h&&i<=t.top+b.height?(x.y=B.Backward,m.y=r*Math.abs((t.top+b.height-i)/b.height)):!f&&u>=t.bottom-b.height&&(x.y=B.Forward,m.y=r*Math.abs((t.bottom-b.height-u)/b.height)),!g&&l>=t.right-b.width?(x.x=B.Forward,m.x=r*Math.abs((t.right-b.width-l)/b.width)):!d&&a<=t.left+b.width&&(x.x=B.Backward,m.x=r*Math.abs((t.left+b.width-a)/b.width)),{direction:x,speed:m}}function bs(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:t,left:n,right:r,bottom:s}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:s,width:e.clientWidth,height:e.clientHeight}}function $n(e){return e.reduce((t,n)=>Oe(t,Lt(n)),ee)}function ms(e){return e.reduce((t,n)=>t+zn(n),0)}function ys(e){return e.reduce((t,n)=>t+Bn(n),0)}function ws(e,t){if(t===void 0&&(t=Ne),!e)return;const{top:n,left:r,bottom:s,right:i}=t(e);Ln(e)&&(s<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Ds=[["x",["left","right"],ms],["y",["top","bottom"],ys]];class Vt{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=wt(n),s=$n(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,a,l]of Ds)for(const u of a)Object.defineProperty(this,u,{get:()=>{const h=l(r),f=s[i]-h;return this.rect[u]+f},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Ye{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var s;(s=this.target)==null||s.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function Cs(e){const{EventTarget:t}=G(e);return e instanceof t?e:ke(e)}function Ot(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var Q;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Q||(Q={}));function pn(e){e.preventDefault()}function Ss(e){e.stopPropagation()}var A;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(A||(A={}));const qn={start:[A.Space,A.Enter],cancel:[A.Esc],end:[A.Space,A.Enter,A.Tab]},js=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case A.Right:return{...n,x:n.x+25};case A.Left:return{...n,x:n.x-25};case A.Down:return{...n,y:n.y+25};case A.Up:return{...n,y:n.y-25}}};class Ht{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Ye(ke(n)),this.windowListeners=new Ye(G(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Q.Resize,this.handleCancel),this.windowListeners.add(Q.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Q.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&ws(r),n(ee)}handleKeyDown(t){if(Gt(t)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:i=qn,coordinateGetter:a=js,scrollBehavior:l="smooth"}=s,{code:u}=t;if(i.end.includes(u)){this.handleEnd(t);return}if(i.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:h}=r.current,f=h?{x:h.left,y:h.top}:ee;this.referenceCoordinates||(this.referenceCoordinates=f);const d=a(t,{active:n,context:r.current,currentCoordinates:f});if(d){const g=Ke(d,f),x={x:0,y:0},{scrollableAncestors:m}=r.current;for(const b of m){const v=t.code,{isTop:p,isRight:y,isLeft:w,isBottom:D,maxScroll:I,minScroll:T}=Wn(b),j=bs(b),S={x:Math.min(v===A.Right?j.right-j.width/2:j.right,Math.max(v===A.Right?j.left:j.left+j.width/2,d.x)),y:Math.min(v===A.Down?j.bottom-j.height/2:j.bottom,Math.max(v===A.Down?j.top:j.top+j.height/2,d.y))},M=v===A.Right&&!y||v===A.Left&&!w,C=v===A.Down&&!D||v===A.Up&&!p;if(M&&S.x!==d.x){const R=b.scrollLeft+g.x,F=v===A.Right&&R<=I.x||v===A.Left&&R>=T.x;if(F&&!g.y){b.scrollTo({left:R,behavior:l});return}F?x.x=b.scrollLeft-R:x.x=v===A.Right?b.scrollLeft-I.x:b.scrollLeft-T.x,x.x&&b.scrollBy({left:-x.x,behavior:l});break}else if(C&&S.y!==d.y){const R=b.scrollTop+g.y,F=v===A.Down&&R<=I.y||v===A.Up&&R>=T.y;if(F&&!g.x){b.scrollTo({top:R,behavior:l});return}F?x.y=b.scrollTop-R:x.y=v===A.Down?b.scrollTop-I.y:b.scrollTop-T.y,x.y&&b.scrollBy({top:-x.y,behavior:l});break}}this.handleMove(t,Oe(Ke(d,this.referenceCoordinates),x))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Ht.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=qn,onActivation:s}=t,{active:i}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const l=i.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function gn(e){return!!(e&&"distance"in e)}function xn(e){return!!(e&&"delay"in e)}class Kt{constructor(t,n,r){var s;r===void 0&&(r=Cs(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:a}=i;this.props=t,this.events=n,this.document=ke(a),this.documentListeners=new Ye(this.document),this.listeners=new Ye(r),this.windowListeners=new Ye(G(a)),this.initialCoordinates=(s=Ft(i))!=null?s:ee,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Q.Resize,this.handleCancel),this.windowListeners.add(Q.DragStart,pn),this.windowListeners.add(Q.VisibilityChange,this.handleCancel),this.windowListeners.add(Q.ContextMenu,pn),this.documentListeners.add(Q.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(xn(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(gn(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:s}=this.props;s(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Q.Click,Ss,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Q.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:s,props:i}=this,{onMove:a,options:{activationConstraint:l}}=i;if(!s)return;const u=(n=Ft(t))!=null?n:ee,h=Ke(s,u);if(!r&&l){if(gn(l)){if(l.tolerance!=null&&Ot(h,l.tolerance))return this.handleCancel();if(Ot(h,l.distance))return this.handleStart()}if(xn(l)&&Ot(h,l.tolerance))return this.handleCancel();this.handlePending(l,h);return}t.cancelable&&t.preventDefault(),a(u)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===A.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Rs={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class _t extends Kt{constructor(t){const{event:n}=t,r=ke(n.target);super(t,Rs,r)}}_t.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const Es={move:{name:"mousemove"},end:{name:"mouseup"}};var zt;(function(e){e[e.RightClick=2]="RightClick"})(zt||(zt={}));class Is extends Kt{constructor(t){super(t,Es,ke(t.event.target))}}Is.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===zt.RightClick?!1:(r==null||r({event:n}),!0)}}];const Mt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Ts extends Kt{constructor(t){super(t,Mt)}static setup(){return window.addEventListener(Mt.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Mt.move.name,t)};function t(){}}}Ts.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var Ge;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Ge||(Ge={}));var ht;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(ht||(ht={}));function As(e){let{acceleration:t,activator:n=Ge.Pointer,canScroll:r,draggingRect:s,enabled:i,interval:a=5,order:l=ht.TreeOrder,pointerCoordinates:u,scrollableAncestors:h,scrollableAncestorRects:f,delta:d,threshold:g}=e;const x=Ms({delta:d,disabled:!i}),[m,b]=qr(),v=c.useRef({x:0,y:0}),p=c.useRef({x:0,y:0}),y=c.useMemo(()=>{switch(n){case Ge.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case Ge.DraggableRect:return s}},[n,s,u]),w=c.useRef(null),D=c.useCallback(()=>{const T=w.current;if(!T)return;const j=v.current.x*p.current.x,S=v.current.y*p.current.y;T.scrollBy(j,S)},[]),I=c.useMemo(()=>l===ht.TreeOrder?[...h].reverse():h,[l,h]);c.useEffect(()=>{if(!i||!h.length||!y){b();return}for(const T of I){if((r==null?void 0:r(T))===!1)continue;const j=h.indexOf(T),S=f[j];if(!S)continue;const{direction:M,speed:C}=vs(T,S,y,t,g);for(const R of["x","y"])x[R][M[R]]||(C[R]=0,M[R]=0);if(C.x>0||C.y>0){b(),w.current=T,m(D,a),v.current=C,p.current=M;return}}v.current={x:0,y:0},p.current={x:0,y:0},b()},[t,D,r,b,i,a,JSON.stringify(y),JSON.stringify(x),m,h,I,f,JSON.stringify(g)])}const Os={x:{[B.Backward]:!1,[B.Forward]:!1},y:{[B.Backward]:!1,[B.Forward]:!1}};function Ms(e){let{delta:t,disabled:n}=e;const r=Nt(t);return et(s=>{if(n||!r||!s)return Os;const i={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[B.Backward]:s.x[B.Backward]||i.x===-1,[B.Forward]:s.x[B.Forward]||i.x===1},y:{[B.Backward]:s.y[B.Backward]||i.y===-1,[B.Forward]:s.y[B.Forward]||i.y===1}}},[n,t,r])}function ks(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return et(s=>{var i;return t==null?null:(i=r??s)!=null?i:null},[r,t])}function Ns(e,t){return c.useMemo(()=>e.reduce((n,r)=>{const{sensor:s}=r,i=s.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,r)}));return[...n,...i]},[]),[e,t])}var Je;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Je||(Je={}));var Bt;(function(e){e.Optimized="optimized"})(Bt||(Bt={}));const vn=new Map;function Fs(e,t){let{dragging:n,dependencies:r,config:s}=t;const[i,a]=c.useState(null),{frequency:l,measure:u,strategy:h}=s,f=c.useRef(e),d=v(),g=He(d),x=c.useCallback(function(p){p===void 0&&(p=[]),!g.current&&a(y=>y===null?p:y.concat(p.filter(w=>!y.includes(w))))},[g]),m=c.useRef(null),b=et(p=>{if(d&&!n)return vn;if(!p||p===vn||f.current!==e||i!=null){const y=new Map;for(let w of e){if(!w)continue;if(i&&i.length>0&&!i.includes(w.id)&&w.rect.current){y.set(w.id,w.rect.current);continue}const D=w.node.current,I=D?new Vt(u(D),D):null;w.rect.current=I,I&&y.set(w.id,I)}return y}return p},[e,i,n,d,u]);return c.useEffect(()=>{f.current=e},[e]),c.useEffect(()=>{d||x()},[n,d]),c.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),c.useEffect(()=>{d||typeof l!="number"||m.current!==null||(m.current=setTimeout(()=>{x(),m.current=null},l))},[l,d,x,...r]),{droppableRects:b,measureDroppableContainers:x,measuringScheduled:i!=null};function v(){switch(h){case Je.Always:return!1;case Je.BeforeDragging:return n;default:return!n}}}function Un(e,t){return et(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Ls(e,t){return Un(e,t)}function zs(e){let{callback:t,disabled:n}=e;const r=Yt(t),s=c.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return c.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function Dt(e){let{callback:t,disabled:n}=e;const r=Yt(t),s=c.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return c.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function Bs(e){return new Vt(Ne(e),e)}function bn(e,t,n){t===void 0&&(t=Bs);const[r,s]=c.useState(null);function i(){s(u=>{if(!e)return null;if(e.isConnected===!1){var h;return(h=u??n)!=null?h:null}const f=t(e);return JSON.stringify(u)===JSON.stringify(f)?u:f})}const a=zs({callback(u){if(e)for(const h of u){const{type:f,target:d}=h;if(f==="childList"&&d instanceof HTMLElement&&d.contains(e)){i();break}}}}),l=Dt({callback:i});return se(()=>{i(),e?(l==null||l.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),a==null||a.disconnect())},[e]),r}function Ps(e){const t=Un(e);return Fn(e,t)}const mn=[];function Ws(e){const t=c.useRef(e),n=et(r=>e?r&&r!==mn&&e&&t.current&&e.parentNode===t.current.parentNode?r:wt(e):mn,[e]);return c.useEffect(()=>{t.current=e},[e]),n}function $s(e){const[t,n]=c.useState(null),r=c.useRef(e),s=c.useCallback(i=>{const a=At(i.target);a&&n(l=>l?(l.set(a,Lt(a)),new Map(l)):null)},[]);return c.useEffect(()=>{const i=r.current;if(e!==i){a(i);const l=e.map(u=>{const h=At(u);return h?(h.addEventListener("scroll",s,{passive:!0}),[h,Lt(h)]):null}).filter(u=>u!=null);n(l.length?new Map(l):null),r.current=e}return()=>{a(e),a(i)};function a(l){l.forEach(u=>{const h=At(u);h==null||h.removeEventListener("scroll",s)})}},[s,e]),c.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,a)=>Oe(i,a),ee):$n(e):ee,[e,t])}function yn(e,t){t===void 0&&(t=[]);const n=c.useRef(null);return c.useEffect(()=>{n.current=null},t),c.useEffect(()=>{const r=e!==ee;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?Ke(e,n.current):ee}function qs(e){c.useEffect(()=>{if(!yt)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function Us(e,t){return c.useMemo(()=>e.reduce((n,r)=>{let{eventName:s,handler:i}=r;return n[s]=a=>{i(a,t)},n},{}),[e,t])}function Xn(e){return c.useMemo(()=>e?hs(e):null,[e])}const wn=[];function Xs(e,t){t===void 0&&(t=Ne);const[n]=e,r=Xn(n?G(n):null),[s,i]=c.useState(wn);function a(){i(()=>e.length?e.map(u=>Pn(u)?r:new Vt(t(u),u)):wn)}const l=Dt({callback:a});return se(()=>{l==null||l.disconnect(),a(),e.forEach(u=>l==null?void 0:l.observe(u))},[e]),s}function Ys(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Ze(t)?t:e}function Gs(e){let{measure:t}=e;const[n,r]=c.useState(null),s=c.useCallback(h=>{for(const{target:f}of h)if(Ze(f)){r(d=>{const g=t(f);return d?{...d,width:g.width,height:g.height}:g});break}},[t]),i=Dt({callback:s}),a=c.useCallback(h=>{const f=Ys(h);i==null||i.disconnect(),f&&(i==null||i.observe(f)),r(f?t(f):null)},[t,i]),[l,u]=ut(a);return c.useMemo(()=>({nodeRef:l,rect:n,setRef:u}),[n,l,u])}const Vs=[{sensor:_t,options:{}},{sensor:Ht,options:{}}],Hs={current:{}},ct={draggable:{measure:hn},droppable:{measure:hn,strategy:Je.WhileDragging,frequency:Bt.Optimized},dragOverlay:{measure:Ne}};class Ve extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const Ks={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Ve,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:ft},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:ct,measureDroppableContainers:ft,windowRect:null,measuringScheduled:!1},_s={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:ft,draggableNodes:new Map,over:null,measureDroppableContainers:ft},Ct=c.createContext(_s),Yn=c.createContext(Ks);function Js(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Ve}}}function Qs(e,t){switch(t.type){case z.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case z.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case z.DragEnd:case z.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case z.RegisterDroppable:{const{element:n}=t,{id:r}=n,s=new Ve(e.droppable.containers);return s.set(r,n),{...e,droppable:{...e.droppable,containers:s}}}case z.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const a=new Ve(e.droppable.containers);return a.set(n,{...i,disabled:s}),{...e,droppable:{...e.droppable,containers:a}}}case z.UnregisterDroppable:{const{id:n,key:r}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const i=new Ve(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function Zs(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:s}=c.useContext(Ct),i=Nt(r),a=Nt(n==null?void 0:n.id);return c.useEffect(()=>{if(!t&&!r&&i&&a!=null){if(!Gt(i)||document.activeElement===i.target)return;const l=s.get(a);if(!l)return;const{activatorNode:u,node:h}=l;if(!u.current&&!h.current)return;requestAnimationFrame(()=>{for(const f of[u.current,h.current]){if(!f)continue;const d=Yr(f);if(d){d.focus();break}}})}},[r,t,s,a,i]),null}function ei(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((s,i)=>i({transform:s,...r}),n):n}function ti(e){return c.useMemo(()=>({draggable:{...ct.draggable,...e==null?void 0:e.draggable},droppable:{...ct.droppable,...e==null?void 0:e.droppable},dragOverlay:{...ct.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function ni(e){let{activeNode:t,measure:n,initialRect:r,config:s=!0}=e;const i=c.useRef(!1),{x:a,y:l}=typeof s=="boolean"?{x:s,y:s}:s;se(()=>{if(!a&&!l||!t){i.current=!1;return}if(i.current||!r)return;const h=t==null?void 0:t.node.current;if(!h||h.isConnected===!1)return;const f=n(h),d=Fn(f,r);if(a||(d.x=0),l||(d.y=0),i.current=!0,Math.abs(d.x)>0||Math.abs(d.y)>0){const g=Ln(h);g&&g.scrollBy({top:d.y,left:d.x})}},[t,a,l,r,n])}const Gn=c.createContext({...ee,scaleX:1,scaleY:1});var ve;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(ve||(ve={}));const ri=c.memo(function(t){var n,r,s,i;let{id:a,accessibility:l,autoScroll:u=!0,children:h,sensors:f=Vs,collisionDetection:d=os,measuring:g,modifiers:x,...m}=t;const b=c.useReducer(Qs,void 0,Js),[v,p]=b,[y,w]=Jr(),[D,I]=c.useState(ve.Uninitialized),T=D===ve.Initialized,{draggable:{active:j,nodes:S,translate:M},droppable:{containers:C}}=v,R=j!=null?S.get(j):null,F=c.useRef({initial:null,translated:null}),L=c.useMemo(()=>{var W;return j!=null?{id:j,data:(W=R==null?void 0:R.data)!=null?W:Hs,rect:F}:null},[j,R]),N=c.useRef(null),[me,Fe]=c.useState(null),[$,Le]=c.useState(null),ie=He(m,Object.values(m)),ze=tt("DndDescribedBy",a),nt=c.useMemo(()=>C.getEnabled(),[C]),U=ti(g),{droppableRects:oe,measureDroppableContainers:ye,measuringScheduled:Be}=Fs(nt,{dragging:T,dependencies:[M.x,M.y],config:U.droppable}),_=ks(S,j),rt=c.useMemo(()=>$?Ft($):null,[$]),ue=ir(),ae=Ls(_,U.draggable.measure);ni({activeNode:j!=null?S.get(j):null,config:ue.layoutShiftCompensation,initialRect:ae,measure:U.draggable.measure});const O=bn(_,U.draggable.measure,ae),Pe=bn(_?_.parentElement:null),te=c.useRef({activatorEvent:null,active:null,activeNode:_,collisionRect:null,collisions:null,droppableRects:oe,draggableNodes:S,draggingNode:null,draggingNodeRect:null,droppableContainers:C,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),De=C.getNodeFor((n=te.current.over)==null?void 0:n.id),le=Gs({measure:U.dragOverlay.measure}),Ce=(r=le.nodeRef.current)!=null?r:_,Se=T?(s=le.rect)!=null?s:O:null,Qt=!!(le.nodeRef.current&&le.rect),Zt=Ps(Qt?null:O),St=Xn(Ce?G(Ce):null),fe=Ws(T?De??_:null),st=Xs(fe),it=ei(x,{transform:{x:M.x-Zt.x,y:M.y-Zt.y,scaleX:1,scaleY:1},activatorEvent:$,active:L,activeNodeRect:O,containerNodeRect:Pe,draggingNodeRect:Se,over:te.current.over,overlayNodeRect:le.rect,scrollableAncestors:fe,scrollableAncestorRects:st,windowRect:St}),en=rt?Oe(rt,M):null,tn=$s(fe),Qn=yn(tn),Zn=yn(tn,[O]),je=Oe(it,Qn),Re=Se?cs(Se,it):null,We=L&&Re?d({active:L,collisionRect:Re,droppableRects:oe,droppableContainers:nt,pointerCoordinates:en}):null,nn=Nn(We,"id"),[he,rn]=c.useState(null),er=Qt?it:Oe(it,Zn),tr=as(er,(i=he==null?void 0:he.rect)!=null?i:null,O),jt=c.useRef(null),sn=c.useCallback((W,V)=>{let{sensor:H,options:pe}=V;if(N.current==null)return;const J=S.get(N.current);if(!J)return;const K=W.nativeEvent,ne=new H({active:N.current,activeNode:J,event:K,options:pe,context:te,onAbort(P){if(!S.get(P))return;const{onDragAbort:re}=ie.current,ce={id:P};re==null||re(ce),y({type:"onDragAbort",event:ce})},onPending(P,ge,re,ce){if(!S.get(P))return;const{onDragPending:qe}=ie.current,xe={id:P,constraint:ge,initialCoordinates:re,offset:ce};qe==null||qe(xe),y({type:"onDragPending",event:xe})},onStart(P){const ge=N.current;if(ge==null)return;const re=S.get(ge);if(!re)return;const{onDragStart:ce}=ie.current,$e={activatorEvent:K,active:{id:ge,data:re.data,rect:F}};Xe.unstable_batchedUpdates(()=>{ce==null||ce($e),I(ve.Initializing),p({type:z.DragStart,initialCoordinates:P,active:ge}),y({type:"onDragStart",event:$e}),Fe(jt.current),Le(K)})},onMove(P){p({type:z.DragMove,coordinates:P})},onEnd:Ee(z.DragEnd),onCancel:Ee(z.DragCancel)});jt.current=ne;function Ee(P){return async function(){const{active:re,collisions:ce,over:$e,scrollAdjustedTranslate:qe}=te.current;let xe=null;if(re&&qe){const{cancelDrop:Ue}=ie.current;xe={activatorEvent:K,active:re,collisions:ce,delta:qe,over:$e},P===z.DragEnd&&typeof Ue=="function"&&await Promise.resolve(Ue(xe))&&(P=z.DragCancel)}N.current=null,Xe.unstable_batchedUpdates(()=>{p({type:P}),I(ve.Uninitialized),rn(null),Fe(null),Le(null),jt.current=null;const Ue=P===z.DragEnd?"onDragEnd":"onDragCancel";if(xe){const Rt=ie.current[Ue];Rt==null||Rt(xe),y({type:Ue,event:xe})}})}}},[S]),nr=c.useCallback((W,V)=>(H,pe)=>{const J=H.nativeEvent,K=S.get(pe);if(N.current!==null||!K||J.dndKit||J.defaultPrevented)return;const ne={active:K};W(H,V.options,ne)===!0&&(J.dndKit={capturedBy:V.sensor},N.current=pe,sn(H,V))},[S,sn]),on=Ns(f,nr);qs(f),se(()=>{O&&D===ve.Initializing&&I(ve.Initialized)},[O,D]),c.useEffect(()=>{const{onDragMove:W}=ie.current,{active:V,activatorEvent:H,collisions:pe,over:J}=te.current;if(!V||!H)return;const K={active:V,activatorEvent:H,collisions:pe,delta:{x:je.x,y:je.y},over:J};Xe.unstable_batchedUpdates(()=>{W==null||W(K),y({type:"onDragMove",event:K})})},[je.x,je.y]),c.useEffect(()=>{const{active:W,activatorEvent:V,collisions:H,droppableContainers:pe,scrollAdjustedTranslate:J}=te.current;if(!W||N.current==null||!V||!J)return;const{onDragOver:K}=ie.current,ne=pe.get(nn),Ee=ne&&ne.rect.current?{id:ne.id,rect:ne.rect.current,data:ne.data,disabled:ne.disabled}:null,P={active:W,activatorEvent:V,collisions:H,delta:{x:J.x,y:J.y},over:Ee};Xe.unstable_batchedUpdates(()=>{rn(Ee),K==null||K(P),y({type:"onDragOver",event:P})})},[nn]),se(()=>{te.current={activatorEvent:$,active:L,activeNode:_,collisionRect:Re,collisions:We,droppableRects:oe,draggableNodes:S,draggingNode:Ce,draggingNodeRect:Se,droppableContainers:C,over:he,scrollableAncestors:fe,scrollAdjustedTranslate:je},F.current={initial:Se,translated:Re}},[L,_,We,Re,S,Ce,Se,oe,C,he,fe,je]),As({...ue,delta:M,draggingRect:Re,pointerCoordinates:en,scrollableAncestors:fe,scrollableAncestorRects:st});const rr=c.useMemo(()=>({active:L,activeNode:_,activeNodeRect:O,activatorEvent:$,collisions:We,containerNodeRect:Pe,dragOverlay:le,draggableNodes:S,droppableContainers:C,droppableRects:oe,over:he,measureDroppableContainers:ye,scrollableAncestors:fe,scrollableAncestorRects:st,measuringConfiguration:U,measuringScheduled:Be,windowRect:St}),[L,_,O,$,We,Pe,le,S,C,oe,he,ye,fe,st,U,Be,St]),sr=c.useMemo(()=>({activatorEvent:$,activators:on,active:L,activeNodeRect:O,ariaDescribedById:{draggable:ze},dispatch:p,draggableNodes:S,over:he,measureDroppableContainers:ye}),[$,on,L,O,p,ze,S,he,ye]);return Y.createElement(On.Provider,{value:w},Y.createElement(Ct.Provider,{value:sr},Y.createElement(Yn.Provider,{value:rr},Y.createElement(Gn.Provider,{value:tr},h)),Y.createElement(Zs,{disabled:(l==null?void 0:l.restoreFocus)===!1})),Y.createElement(es,{...l,hiddenTextDescribedById:ze}));function ir(){const W=(me==null?void 0:me.autoScrollEnabled)===!1,V=typeof u=="object"?u.enabled===!1:u===!1,H=T&&!W&&!V;return typeof u=="object"?{...u,enabled:H}:{enabled:H}}}),si=c.createContext(null),Dn="button",ii="Draggable";function oi(e){let{id:t,data:n,disabled:r=!1,attributes:s}=e;const i=tt(ii),{activators:a,activatorEvent:l,active:u,activeNodeRect:h,ariaDescribedById:f,draggableNodes:d,over:g}=c.useContext(Ct),{role:x=Dn,roleDescription:m="draggable",tabIndex:b=0}=s??{},v=(u==null?void 0:u.id)===t,p=c.useContext(v?Gn:si),[y,w]=ut(),[D,I]=ut(),T=Us(a,t),j=He(n);se(()=>(d.set(t,{id:t,key:i,node:y,activatorNode:D,data:j}),()=>{const M=d.get(t);M&&M.key===i&&d.delete(t)}),[d,t]);const S=c.useMemo(()=>({role:x,tabIndex:b,"aria-disabled":r,"aria-pressed":v&&x===Dn?!0:void 0,"aria-roledescription":m,"aria-describedby":f.draggable}),[r,x,b,v,m,f.draggable]);return{active:u,activatorEvent:l,activeNodeRect:h,attributes:S,isDragging:v,listeners:r?void 0:T,node:y,over:g,setNodeRef:w,setActivatorNodeRef:I,transform:p}}function ai(){return c.useContext(Yn)}const li="Droppable",ci={timeout:25};function di(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:s}=e;const i=tt(li),{active:a,dispatch:l,over:u,measureDroppableContainers:h}=c.useContext(Ct),f=c.useRef({disabled:n}),d=c.useRef(!1),g=c.useRef(null),x=c.useRef(null),{disabled:m,updateMeasurementsFor:b,timeout:v}={...ci,...s},p=He(b??r),y=c.useCallback(()=>{if(!d.current){d.current=!0;return}x.current!=null&&clearTimeout(x.current),x.current=setTimeout(()=>{h(Array.isArray(p.current)?p.current:[p.current]),x.current=null},v)},[v]),w=Dt({callback:y,disabled:m||!a}),D=c.useCallback((S,M)=>{w&&(M&&(w.unobserve(M),d.current=!1),S&&w.observe(S))},[w]),[I,T]=ut(D),j=He(t);return c.useEffect(()=>{!w||!I.current||(w.disconnect(),d.current=!1,w.observe(I.current))},[I,w]),c.useEffect(()=>(l({type:z.RegisterDroppable,element:{id:r,key:i,disabled:n,node:I,rect:g,data:j}}),()=>l({type:z.UnregisterDroppable,key:i,id:r})),[r]),c.useEffect(()=>{n!==f.current.disabled&&(l({type:z.SetDroppableDisabled,id:r,key:i,disabled:n}),f.current.disabled=n)},[r,i,n,l]),{active:a,rect:g,isOver:(u==null?void 0:u.id)===r,node:I,over:u,setNodeRef:T}}function Jt(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function ui(e,t){return e.reduce((n,r,s)=>{const i=t.get(r);return i&&(n[s]=i),n},Array(e.length))}function ot(e){return e!==null&&e>=0}function fi(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function hi(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Vn=e=>{let{rects:t,activeIndex:n,overIndex:r,index:s}=e;const i=Jt(t,r,n),a=t[s],l=i[s];return!l||!a?null:{x:l.left-a.left,y:l.top-a.top,scaleX:l.width/a.width,scaleY:l.height/a.height}},at={scaleX:1,scaleY:1},pi=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:s,rects:i,overIndex:a}=e;const l=(t=i[n])!=null?t:r;if(!l)return null;if(s===n){const h=i[a];return h?{x:0,y:n<a?h.top+h.height-(l.top+l.height):h.top-l.top,...at}:null}const u=gi(i,s,n);return s>n&&s<=a?{x:0,y:-l.height-u,...at}:s<n&&s>=a?{x:0,y:l.height+u,...at}:{x:0,y:0,...at}};function gi(e,t,n){const r=e[t],s=e[t-1],i=e[t+1];return r?n<t?s?r.top-(s.top+s.height):i?i.top-(r.top+r.height):0:i?i.top-(r.top+r.height):s?r.top-(s.top+s.height):0:0}const Hn="Sortable",Kn=Y.createContext({activeIndex:-1,containerId:Hn,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Vn,disabled:{draggable:!1,droppable:!1}});function xi(e){let{children:t,id:n,items:r,strategy:s=Vn,disabled:i=!1}=e;const{active:a,dragOverlay:l,droppableRects:u,over:h,measureDroppableContainers:f}=ai(),d=tt(Hn,n),g=l.rect!==null,x=c.useMemo(()=>r.map(T=>typeof T=="object"&&"id"in T?T.id:T),[r]),m=a!=null,b=a?x.indexOf(a.id):-1,v=h?x.indexOf(h.id):-1,p=c.useRef(x),y=!fi(x,p.current),w=v!==-1&&b===-1||y,D=hi(i);se(()=>{y&&m&&f(x)},[y,x,m,f]),c.useEffect(()=>{p.current=x},[x]);const I=c.useMemo(()=>({activeIndex:b,containerId:d,disabled:D,disableTransforms:w,items:x,overIndex:v,useDragOverlay:g,sortedRects:ui(x,u),strategy:s}),[b,d,D.draggable,D.droppable,w,x,v,u,g,s]);return Y.createElement(Kn.Provider,{value:I},t)}const vi=e=>{let{id:t,items:n,activeIndex:r,overIndex:s}=e;return Jt(n,r,s).indexOf(t)},bi=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:s,items:i,newIndex:a,previousItems:l,previousContainerId:u,transition:h}=e;return!h||!r||l!==i&&s===a?!1:n?!0:a!==s&&t===u},mi={duration:200,easing:"ease"},_n="transform",yi=_e.Transition.toString({property:_n,duration:0,easing:"linear"}),wi={roleDescription:"sortable"};function Di(e){let{disabled:t,index:n,node:r,rect:s}=e;const[i,a]=c.useState(null),l=c.useRef(n);return se(()=>{if(!t&&n!==l.current&&r.current){const u=s.current;if(u){const h=Ne(r.current,{ignoreTransform:!0}),f={x:u.left-h.left,y:u.top-h.top,scaleX:u.width/h.width,scaleY:u.height/h.height};(f.x||f.y)&&a(f)}}n!==l.current&&(l.current=n)},[t,n,r,s]),c.useEffect(()=>{i&&a(null)},[i]),i}function Ci(e){let{animateLayoutChanges:t=bi,attributes:n,disabled:r,data:s,getNewIndex:i=vi,id:a,strategy:l,resizeObserverConfig:u,transition:h=mi}=e;const{items:f,containerId:d,activeIndex:g,disabled:x,disableTransforms:m,sortedRects:b,overIndex:v,useDragOverlay:p,strategy:y}=c.useContext(Kn),w=Si(r,x),D=f.indexOf(a),I=c.useMemo(()=>({sortable:{containerId:d,index:D,items:f},...s}),[d,s,D,f]),T=c.useMemo(()=>f.slice(f.indexOf(a)),[f,a]),{rect:j,node:S,isOver:M,setNodeRef:C}=di({id:a,data:I,disabled:w.droppable,resizeObserverConfig:{updateMeasurementsFor:T,...u}}),{active:R,activatorEvent:F,activeNodeRect:L,attributes:N,setNodeRef:me,listeners:Fe,isDragging:$,over:Le,setActivatorNodeRef:ie,transform:ze}=oi({id:a,data:I,attributes:{...wi,...n},disabled:w.draggable}),nt=$r(C,me),U=!!R,oe=U&&!m&&ot(g)&&ot(v),ye=!p&&$,Be=ye&&oe?ze:null,rt=oe?Be??(l??y)({rects:b,activeNodeRect:L,activeIndex:g,overIndex:v,index:D}):null,ue=ot(g)&&ot(v)?i({id:a,items:f,activeIndex:g,overIndex:v}):D,ae=R==null?void 0:R.id,O=c.useRef({activeId:ae,items:f,newIndex:ue,containerId:d}),Pe=f!==O.current.items,te=t({active:R,containerId:d,isDragging:$,isSorting:U,id:a,index:D,items:f,newIndex:O.current.newIndex,previousItems:O.current.items,previousContainerId:O.current.containerId,transition:h,wasDragging:O.current.activeId!=null}),De=Di({disabled:!te,index:D,node:S,rect:j});return c.useEffect(()=>{U&&O.current.newIndex!==ue&&(O.current.newIndex=ue),d!==O.current.containerId&&(O.current.containerId=d),f!==O.current.items&&(O.current.items=f)},[U,ue,d,f]),c.useEffect(()=>{if(ae===O.current.activeId)return;if(ae!=null&&O.current.activeId==null){O.current.activeId=ae;return}const Ce=setTimeout(()=>{O.current.activeId=ae},50);return()=>clearTimeout(Ce)},[ae]),{active:R,activeIndex:g,attributes:N,data:I,rect:j,index:D,newIndex:ue,items:f,isOver:M,isSorting:U,isDragging:$,listeners:Fe,node:S,overIndex:v,over:Le,setNodeRef:nt,setActivatorNodeRef:ie,setDroppableNodeRef:C,setDraggableNodeRef:me,transform:De??rt,transition:le()};function le(){if(De||Pe&&O.current.newIndex===D)return yi;if(!(ye&&!Gt(F)||!h)&&(U||te))return _e.Transition.toString({...h,property:_n})}}function Si(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function pt(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const ji=[A.Down,A.Right,A.Up,A.Left],Ri=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:s,droppableContainers:i,over:a,scrollableAncestors:l}}=t;if(ji.includes(e.code)){if(e.preventDefault(),!n||!r)return;const u=[];i.getEnabled().forEach(d=>{if(!d||d!=null&&d.disabled)return;const g=s.get(d.id);if(g)switch(e.code){case A.Down:r.top<g.top&&u.push(d);break;case A.Up:r.top>g.top&&u.push(d);break;case A.Left:r.left>g.left&&u.push(d);break;case A.Right:r.left<g.left&&u.push(d);break}});const h=ss({collisionRect:r,droppableRects:s,droppableContainers:u});let f=Nn(h,"id");if(f===(a==null?void 0:a.id)&&h.length>1&&(f=h[1].id),f!=null){const d=i.get(n.id),g=i.get(f),x=g?s.get(g.id):null,m=g==null?void 0:g.node.current;if(m&&x&&d&&g){const v=wt(m).some((T,j)=>l[j]!==T),p=Jn(d,g),y=Ei(d,g),w=v||!p?{x:0,y:0}:{x:y?r.width-x.width:0,y:y?r.height-x.height:0},D={x:x.left,y:x.top};return w.x&&w.y?D:Ke(D,w)}}}};function Jn(e,t){return!pt(e)||!pt(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Ei(e,t){return!pt(e)||!pt(t)||!Jn(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const Ii=({componentId:e,scenarioId:t})=>{const[n,r]=c.useState([]),[s,i]=c.useState(!1),[a,l]=c.useState(null),[u,h]=c.useState(!1);c.useEffect(()=>{f()},[e,t]);const f=async()=>{if(!(!e||!t)){i(!0),l(null);try{const v=await Cr(e,t);r(v)}catch(v){console.error("Error fetching test steps:",v),l("Failed to load test steps. Please try again.")}finally{i(!1)}}};return{testSteps:n,loading:s,error:a,reordering:u,fetchTestSteps:f,addTestStep:async v=>{i(!0),l(null);try{return await jr(e,t,v),await f(),!0}catch(p){return console.error("Error creating test step:",p),l("Failed to create test step. Please try again."),!1}finally{i(!1)}},editTestStep:async(v,p)=>{i(!0),l(null);try{return await ln(e,t,v,p),await f(),!0}catch(y){return console.error("Error updating test step:",y),l("Failed to update test step. Please try again."),!1}finally{i(!1)}},removeTestStep:async v=>{i(!0),l(null);try{return await Sr(e,t,v),await f(),!0}catch(p){return console.error("Error deleting test step:",p),l("Failed to delete test step. Please try again."),!1}finally{i(!1)}},reorderSteps:async v=>{h(!0),l(null);try{const p=v.map((y,w)=>{const D=(w+1)*10;return ln(e,t,y.id,{order:D})});return await Promise.all(p),await f(),!0}catch(p){return console.error("Error updating test step order:",p),l("Failed to update step order. Please try again."),!1}finally{h(!1)}},getNextStepDefaults:()=>{const v=n.length+1,p=n.length>0?Math.max(...n.map(y=>y.order))+10:0;return{stepId:`step-${v}`,instruction:"",expectedResult:"",order:p,device:"desktop"}}}},Ti=()=>{const[e,t]=c.useState(null),[n,r]=c.useState(!1),[s,i]=c.useState({}),[a,l]=c.useState(!1);return{currentStep:e,setCurrentStep:t,isEditing:n,formErrors:s,dialogOpen:a,openCreateDialog:m=>{t(m),r(!1),i({}),l(!0)},openEditDialog:m=>{t(m),r(!0),i({}),l(!0)},closeDialog:()=>{l(!1),t(null)},handleFormChange:m=>{const{name:b,value:v}=m.target;b&&t(p=>({...p,[b]:v}))},validateForm:()=>{const m={};return e!=null&&e.stepId||(m.stepId="Step ID is required"),e!=null&&e.instruction||(m.instruction="Instruction is required"),e!=null&&e.expectedResult||(m.expectedResult="Expected result is required"),i(m),Object.keys(m).length===0},setDeviceType:m=>{t(b=>({...b,device:m?"mobile":"desktop"}))}}},Ai=({items:e,onReorder:t})=>({sensors:ts(dn(_t),dn(Ht,{coordinateGetter:Ri})),handleDragEnd:async s=>{const{active:i,over:a}=s;if(a&&i.id!==a.id){const l=e.findIndex(f=>f.id===i.id),u=e.findIndex(f=>f.id===a.id),h=Jt(e,l,u);await t(h)}}}),Oi=({step:e,onEdit:t,onDelete:n})=>{const r=Pt(),{attributes:s,listeners:i,setNodeRef:a,transform:l,transition:u,isDragging:h}=Ci({id:e.id}),f={transform:_e.Transform.toString(l),transition:u,opacity:h?.5:1,zIndex:h?1:0};return o.jsxs(E,{ref:a,style:f,sx:{display:"flex",bgcolor:r.palette.background.paper,borderRadius:1,mb:1,p:2,boxShadow:1,transition:"all 0.2s","&:hover":{boxShadow:4,transform:"translateY(-2px)"},"&:focus":{outline:`2px solid ${r.palette.primary.main}`,outlineOffset:"2px"},border:`1px solid ${r.palette.mode==="dark"?r.palette.grey[800]:r.palette.grey[300]}`},children:[o.jsx(E,{sx:{mr:1,display:"flex",alignItems:"center",cursor:"grab"},...s,...i,children:o.jsx(fr,{color:"action"})}),o.jsxs(E,{sx:{flexGrow:1},children:[o.jsx(k,{variant:"subtitle2",sx:{mb:.5},children:e.instruction}),o.jsxs(k,{variant:"body2",color:"text.secondary",sx:{mt:1},children:[o.jsx("strong",{children:"Expected Result:"})," ",e.expectedResult]}),e.device==="mobile"&&o.jsx(k,{variant:"caption",color:"secondary",sx:{display:"block",mt:1},children:"Mobile specific"}),o.jsxs(k,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.5},children:["ID: ",e.stepId]})]}),o.jsxs(E,{sx:{ml:1,display:"flex",alignItems:"flex-start"},children:[o.jsx(de,{title:"Edit",children:o.jsx(we,{size:"small",onClick:()=>t(e),children:o.jsx(Wt,{fontSize:"small"})})}),o.jsx(de,{title:"Delete",children:o.jsx(we,{size:"small",color:"error",onClick:()=>n(e),children:o.jsx($t,{fontSize:"small"})})})]})]})},Mi=({open:e,onClose:t,onSave:n,currentStep:r,isEditing:s,loading:i,formErrors:a,onChange:l,onDeviceChange:u})=>o.jsxs(gt,{open:e,onClose:t,fullWidth:!0,maxWidth:"md",children:[o.jsx(xt,{children:s?"Edit Test Step":"Add New Test Step"}),o.jsx(vt,{children:o.jsxs(E,{sx:{mt:1,display:"flex",flexDirection:"column",gap:2},children:[o.jsx(Z,{name:"stepId",label:"Step ID",fullWidth:!0,value:(r==null?void 0:r.stepId)||"",onChange:l,disabled:s,error:!!a.stepId,helperText:a.stepId||"Unique identifier for this test step",required:!0}),o.jsx(Z,{name:"instruction",label:"Instruction",fullWidth:!0,multiline:!0,rows:3,value:(r==null?void 0:r.instruction)||"",onChange:l,error:!!a.instruction,helperText:a.instruction||"What the tester should do in this step",required:!0}),o.jsx(Z,{name:"expectedResult",label:"Expected Result",fullWidth:!0,multiline:!0,rows:3,value:(r==null?void 0:r.expectedResult)||"",onChange:l,error:!!a.expectedResult,helperText:a.expectedResult||"What should happen after following the instruction",required:!0}),o.jsx(En,{control:o.jsx(In,{checked:(r==null?void 0:r.device)==="mobile",onChange:h=>u(h.target.checked),name:"device"}),label:"Mobile-specific test step"}),o.jsx(Z,{name:"order",label:"Display Order",type:"number",fullWidth:!0,value:(r==null?void 0:r.order)||0,onChange:l,helperText:"Test steps are displayed in this order (lower numbers first)"})]})}),o.jsxs(bt,{children:[o.jsx(q,{onClick:t,children:"Cancel"}),o.jsx(q,{onClick:n,variant:"contained",disabled:i,children:i?o.jsx(be,{size:24}):s?"Update":"Create"})]})]}),ki=({onAddClick:e})=>o.jsxs(E,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",py:8},children:[o.jsx(k,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No test steps found"}),o.jsx(k,{variant:"body2",color:"text.secondary",mb:2,children:"Add your first test step to get started"}),o.jsx(q,{variant:"outlined",startIcon:o.jsx(Qe,{}),onClick:e,children:"Add Test Step"})]}),Ni=({componentId:e,scenarioId:t})=>{const{testSteps:n,loading:r,error:s,reordering:i,addTestStep:a,editTestStep:l,removeTestStep:u,reorderSteps:h,getNextStepDefaults:f}=Ii({componentId:e,scenarioId:t}),{currentStep:d,setCurrentStep:g,isEditing:x,formErrors:m,dialogOpen:b,openCreateDialog:v,openEditDialog:p,closeDialog:y,handleFormChange:w,validateForm:D,setDeviceType:I}=Ti(),{sensors:T,handleDragEnd:j}=Ai({items:n,onReorder:h}),[S,M]=c.useState(!1),C=()=>{v(f())},R=N=>{g(N),M(!0)},F=async()=>{if(!(!d||!D()))if(x&&d.id){const{id:N,createdAt:me,updatedAt:Fe,...$}=d;await l(N,$)&&y()}else{if(!d.stepId||!d.instruction||!d.expectedResult)return;const N={stepId:d.stepId,instruction:d.instruction,expectedResult:d.expectedResult,order:d.order||0,device:d.device||"desktop"};await a(N)&&y()}},L=async()=>{if(!(d!=null&&d.id))return;await u(d.id)&&M(!1)};return o.jsxs(E,{sx:{height:"100%",width:"100%",display:"flex",flexDirection:"column"},children:[o.jsxs(E,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx(k,{variant:"h6",component:"h2",children:"Test Steps"}),o.jsx(q,{variant:"contained",startIcon:o.jsx(Qe,{}),onClick:C,children:"Add Test Step"})]}),s&&o.jsx(mt,{severity:"error",sx:{mb:2},children:s}),r&&n.length===0?o.jsx(E,{sx:{display:"flex",justifyContent:"center",pt:4},children:o.jsx(be,{})}):n.length===0?o.jsx(ki,{onAddClick:C}):o.jsxs(E,{sx:{flexGrow:1,overflow:"auto",px:1,pt:1,pb:5},children:[i&&o.jsxs(E,{sx:{display:"flex",justifyContent:"center",py:2},children:[o.jsx(be,{size:24}),o.jsx(k,{variant:"body2",color:"text.secondary",sx:{ml:1},children:"Updating order..."})]}),o.jsx(ri,{sensors:T,collisionDetection:rs,onDragEnd:j,children:o.jsx(xi,{items:n.map(N=>N.id),strategy:pi,children:n.map(N=>o.jsx(Oi,{step:N,onEdit:p,onDelete:R},N.id))})})]}),o.jsx(Mi,{open:b,onClose:y,onSave:F,currentStep:d,isEditing:x,loading:r,formErrors:m,onChange:w,onDeviceChange:I}),o.jsx(qt,{open:S,onClose:()=>M(!1),onConfirm:L,itemName:(d==null?void 0:d.instruction)||"",itemType:"test step",loading:r})]})};function Fi(){const[e,t]=c.useState([]),[n,r]=c.useState(!1),[s,i]=c.useState(null),[a,l]=c.useState(null),[u,h]=c.useState(null);c.useEffect(()=>{h(null)},[a]);const f=c.useCallback(async()=>{r(!0),i(null);try{const d=await Rr();t(d)}catch(d){console.error("Failed to fetch components:",d),i("Failed to load components. Please try again later.")}finally{r(!1)}},[]);return c.useEffect(()=>{f()},[f]),{components:e,loading:n,error:s,selectedComponentId:a,selectedScenarioId:u,setSelectedComponentId:l,setSelectedScenarioId:h,refreshComponents:f}}function kt(e){const{children:t,value:n,index:r,...s}=e;return o.jsx("div",{role:"tabpanel",hidden:n!==r,id:`test-management-tabpanel-${r}`,"aria-labelledby":`test-management-tab-${r}`,...s,style:{height:"100%"},children:n===r&&o.jsx(E,{sx:{p:3,height:"100%"},children:t})})}const qi=()=>{const[e,t]=c.useState(0),{components:n,loading:r,error:s,selectedComponentId:i,selectedScenarioId:a,setSelectedComponentId:l,setSelectedScenarioId:u,refreshComponents:h}=Fi(),f=(d,g)=>{t(g)};return o.jsxs(hr,{maxWidth:"xl",sx:{height:"calc(100vh - 64px)",display:"flex",flexDirection:"column",pt:2,pb:4,px:2},children:[o.jsxs(E,{sx:{mb:3},children:[o.jsx(k,{variant:"h4",component:"h1",gutterBottom:!0,children:"Test Case Management"}),o.jsx(k,{variant:"body1",color:"text.secondary",children:"Create and manage test components, scenarios, and test cases"})]}),s&&o.jsx(mt,{severity:"error",sx:{mb:3},children:s}),o.jsxs(pr,{elevation:2,sx:{flexGrow:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[o.jsx(E,{sx:{borderBottom:1,borderColor:"divider"},children:o.jsxs(gr,{value:e,onChange:f,"aria-label":"test case management tabs",indicatorColor:"primary",textColor:"primary",children:[o.jsx(Et,{label:"Components"}),o.jsx(Et,{label:"Scenarios",disabled:!i}),o.jsx(Et,{label:"Test Cases",disabled:!a})]})}),r?o.jsx(E,{sx:{display:"flex",justifyContent:"center",alignItems:"center",flex:1},children:o.jsx(be,{})}):o.jsxs(o.Fragment,{children:[o.jsx(kt,{value:e,index:0,children:o.jsx(Fr,{components:n,onSelectComponent:d=>{l(d),t(1)},onComponentsChange:h})}),o.jsx(kt,{value:e,index:1,children:i&&o.jsx(Wr,{componentId:i,onSelectScenario:d=>{u(d),t(2)}})}),o.jsx(kt,{value:e,index:2,children:i&&a&&o.jsx(Ni,{componentId:i,scenarioId:a})})]})]})]})};export{qi as default};
