import{u as Re,j as e,B as v,$ as ft,aa as nt,aj as bt,a5 as ot,d as Y,I as we,ak as st,S as qe,a6 as yt,a7 as Ct,a8 as wt,f as Ye,al as St,a3 as $e,m as jt,am as Ke,an as kt,ao as vt,ap as Lt,aq as Et,H as Mt,ar as Ft,h as zt,a as pe,ag as Rt,as as Tt,r as Ie,at as rt,w as Ot,au as Dt,ad as Pt,av as It,aw as Ht,ax as $t,P as ut,ay as Wt,az as At,aA as Ut,aB as Bt,aC as Me,aD as Gt,aE as Yt,aF as Nt,aG as Zt,aH as Xt,aI as _t,aJ as Kt,aK as ht,a9 as it,b as qt,aL as Vt,F as Jt,e as Qt,n as Ve,ah as Je,U as en}from"./mui-B3MKZ-aL.js";import{r as t,a as tn}from"./vendor-By_F_pnL.js";import{g as Ae,c as Ce}from"./index-CgseieSn.js";import{e as nn,a as on,g as tt,d as lt,c as He,C as Ue,f as sn,F as rn,D as an,N as ln}from"./DeviceSizeMenu-CRul4MVU.js";import{m as cn,L as dn}from"./index-kHsenwn3.js";import{A as ct}from"./index-DSV94F9p.js";const un=()=>{const[n,o]=t.useState([]),[p,h]=t.useState(null),[r,x]=t.useState(!0),[z,f]=t.useState(!1);t.useEffect(()=>{n.length===0&&$()},[]),t.useEffect(()=>{if(n.length>0){const d=n[0];nn({selectedOptions:d.selectedOptions,countryLanguageCode:d.countryLanguageCode})}},[n]);const $=()=>{const d=on(),c=d?L(0,d.selectedOptions,d.countryLanguageCode):R(0),l=R(1);o([c,l])},L=(d,c,l)=>{const m=`frame-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,S=Ae(c,l),O=60;return{id:m,selectedOptions:{...c},countryLanguageCode:l,generatedUrl:S,iframeLoading:!0,customSized:!1,syncEnabled:!1,syncOptions:tt(),position:{x:100+O*d,y:100+O*d}}},R=d=>{const c=`frame-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,l=Object.keys(Ce)[0],m=Ae(lt,l),S=60;return{id:c,selectedOptions:{...lt},countryLanguageCode:l,generatedUrl:m,iframeLoading:!0,customSized:!1,syncEnabled:!1,syncOptions:tt(),position:{x:100+S*d,y:100+S*d}}};t.useEffect(()=>{if(p){const d=setTimeout(()=>{h(null)},3e3);return()=>{clearTimeout(d)}}},[p]);const i=()=>{const d=R(n.length);o(c=>[...c,d])},E=(d,c)=>{o(l=>l.map(m=>m.id===d?{...m,position:c,customSized:!0}:m))},U=(d,c)=>{o(l=>{const m=[...l],S=m.findIndex(Z=>Z.id===d),O=m.findIndex(Z=>Z.id===c);if(S===-1||O===-1)return l;const[I]=m.splice(S,1);return m.splice(O,0,I),m})},T=d=>{if(n.length<=1){H("Cannot remove the last frame");return}o(c=>c.filter(l=>l.id!==d))},N=(d,c,l)=>{o(m=>{var s,u,g,D;const S=[...m],O=S.findIndex(w=>w.id===d);if(O===-1)return m;const I=S[O],Z={...I.selectedOptions,[c]:l},j=(s=Ce[I.countryLanguageCode])==null?void 0:s.hasLexus,de=(u=Ce[I.countryLanguageCode])==null?void 0:u.hasStock,oe=((g=Ce[I.countryLanguageCode])==null?void 0:g.hasUsed)!==!1;c==="brand"&&l==="lexus"&&!j&&(H("Lexus is not available for this country"),Z.brand="toyota"),c==="uscContext"&&l==="stock"&&!de&&(H("Stock Cars is not set up for this country"),Z.uscContext="used"),c==="uscContext"&&l==="used"&&!oe&&(H("Used Cars is not available for this country"),Z.uscContext="stock");const ue=Ae(Z,I.countryLanguageCode);return S[O]={...I,selectedOptions:Z,generatedUrl:ue,iframeLoading:!0},(z||I.syncEnabled)&&(((D=I.syncOptions)==null?void 0:D[c])!==!1?(H(`Syncing ${c} to other frames`),S.forEach((k,B)=>{var X,Q,se;if(B!==O){const Oe=(X=Ce[k.countryLanguageCode])==null?void 0:X.hasLexus,ke=(Q=Ce[k.countryLanguageCode])==null?void 0:Q.hasStock,V=((se=Ce[k.countryLanguageCode])==null?void 0:se.hasUsed)!==!1,G={...k.selectedOptions};c==="brand"&&l==="lexus"?G.brand=Oe?l:"toyota":c==="uscContext"&&l==="stock"?G.uscContext=ke?l:V?"used":"stock":c==="uscContext"&&l==="used"?G.uscContext=V?l:ke?"stock":"used":G[c]=l;const re=Ae(G,k.countryLanguageCode);S[B]={...k,selectedOptions:G,generatedUrl:re,iframeLoading:!0}}})):H(`Sync for "${c}" is disabled in settings`)),S})},y=(d,c)=>{o(l=>{var j;const m=[...l],S=m.findIndex(de=>de.id===d);if(S===-1)return l;const O=m[S],I=Ae(O.selectedOptions,c);return m[S]={...O,countryLanguageCode:c,generatedUrl:I,iframeLoading:!0},(z||O.syncEnabled)&&(((j=O.syncOptions)==null?void 0:j.country)!==!1?(H("Syncing country to other frames"),m.forEach((oe,ue)=>{if(ue!==S){const ge=Ae(oe.selectedOptions,c);m[ue]={...oe,countryLanguageCode:c,generatedUrl:ge,iframeLoading:!0}}})):H("Country sync is disabled in settings")),m})},P=async d=>{try{await navigator.clipboard.writeText(d),H("URL copied to clipboard")}catch(c){H(`Failed to copy URL. ${c.message}`)}},M=d=>{o(c=>c.map(l=>l.id===d?{...l,iframeLoading:!1}:l))},b=()=>{x(!r)},H=d=>{h(d)};return{frames:n,notification:p,sidebarOpen:r,globalSyncEnabled:z,addNewFrame:i,removeFrame:T,handleOptionChange:N,changeCountry:y,copyUrlToClipboard:P,handleIframeLoad:M,toggleSidebar:b,showNotification:H,reorderFrames:U,markFrameAsCustomSized:d=>{o(c=>c.map(l=>l.id===d?{...l,customSized:!0}:l))},resetFrameCustomSize:d=>{o(c=>c.map(l=>l.id===d?{...l,customSized:!1}:l))},updateFramePosition:E,toggleFrameSync:d=>{var S;const c=n.find(O=>O.id===d);if(!c)return;const l=!c.syncEnabled;o(O=>O.map(I=>I.id===d?{...I,syncEnabled:l}:I));const m=((S=Ce[c.countryLanguageCode])==null?void 0:S.pretty)||"Frame";H(l?`Frame sync enabled for ${m}`:`Frame sync disabled for ${m}`)},toggleGlobalSync:()=>{const d=!z;f(d),H(d?"Global sync enabled":"Global sync disabled")},updateFrameSyncOptions:(d,c,l)=>{o(m=>m.map(S=>S.id===d?{...S,syncOptions:{...S.syncOptions||{},[c]:l}}:S)),H(`${l?"Enabled":"Disabled"} syncing ${c}`)},refreshFrame:d=>{const c=n.find(l=>l.id===d);if(c){const l=Date.now(),m=c.generatedUrl.includes("?")?"&":"?",S=`${c.generatedUrl}${m}_t=${l}`;o(O=>O.map(I=>I.id===d?{...I,generatedUrl:S,iframeLoading:!0}:I)),H("Reloading frame...")}}}},Ze=200,Qe=400,et=800,je=800,ie=100,dt=15,hn=16,Xe=20,_e=(n,o)=>Math.round(n/o)*o,pn={n:"ns-resize",s:"ns-resize",e:"ew-resize",w:"ew-resize",ne:"nesw-resize",nw:"nwse-resize",se:"nwse-resize",sw:"nesw-resize"},mn=n=>pn[n]||"default",gn=({frames:n,onUpdateFramePosition:o,onMarkFrameAsCustomSized:p,snapToGrid:h=!1})=>{const[r,x]=t.useState({}),[z,f]=t.useState(null),[$,L]=t.useState(null),[R,i]=t.useState(null),[E,U]=t.useState(null),[T,N]=t.useState(!1),[y,P]=t.useState(null),[M,b]=t.useState(new Set),[H,Te]=t.useState(h),q=t.useRef(null),le=t.useRef({}),ce=t.useRef(""),ne=t.useRef(null),me=t.useRef({x:0,y:0}),d=t.useRef({}),c=t.useRef(null),l=t.useCallback(()=>{Object.keys(d.current).length!==0&&(x(s=>({...s,...d.current})),d.current={},c.current=null)},[]),m=t.useCallback((s,u)=>{d.current[s]={...r[s]||{width:je,height:je,maxHeight:!1},...u},c.current!==null&&window.cancelAnimationFrame(c.current),c.current=window.requestAnimationFrame(l)},[r,l]);t.useEffect(()=>()=>{c.current!==null&&window.cancelAnimationFrame(c.current)},[]),t.useEffect(()=>{const s=q.current;if(!s)return;const u=requestAnimationFrame(()=>{let g=0,D=0;n.forEach(w=>{const k=r[w.id],B=(k==null?void 0:k.position)||w.position||{x:0,y:0};k&&(g=Math.max(g,B.x+k.width),D=Math.max(D,B.y+k.height))}),s.style.minWidth=`${g+Ze}px`,s.style.minHeight=`${D+Ze}px`});return()=>cancelAnimationFrame(u)},[n,r]),t.useEffect(()=>{const s={};n.forEach(u=>{r[u.id]||(s[u.id]={height:je,width:je,maxHeight:!1,position:u.position})}),Object.keys(s).length>0&&x(u=>({...u,...s}))},[n,r]),t.useEffect(()=>{if(T||z)return;let s=null;const u=()=>{Object.entries(r).forEach(([g,D])=>{if(!D.position)return;const w=n.find(X=>X.id===g);if(!w)return;const k=w.position,B=D.position;((k==null?void 0:k.x)!==B.x||(k==null?void 0:k.y)!==B.y)&&o(g,B)})};return s=window.setTimeout(u,100),()=>{s&&window.clearTimeout(s)}},[r,T,z,n,o]);const S=t.useCallback((s,u)=>{let g=null;const D=()=>{var B;const k=(B=q.current)==null?void 0:B.parentElement;k&&(g&&window.clearInterval(g),g=window.setInterval(()=>{if(!s.current){w();return}const{horizontal:X,vertical:Q}=u();X!==0&&(k.scrollLeft+=X*dt),Q!==0&&(k.scrollTop+=Q*dt)},hn))},w=()=>{g&&(window.clearInterval(g),g=null)};return{startAutoScroll:D,clearAutoScroll:w}},[]),O=t.useCallback((s,u,g,D)=>{const w=q.current;if(!w)return;const k=parseInt(w.style.minWidth||"0",10),B=parseInt(w.style.minHeight||"0",10),X=s+g+Ze,Q=u+D+Ze;X>k&&(w.style.minWidth=`${X}px`),Q>B&&(w.style.minHeight=`${Q}px`)},[]),I=t.useCallback(s=>H?{x:_e(s.x,Xe),y:_e(s.y,Xe)}:s,[H]),Z=t.useCallback(s=>H?{width:Math.max(Qe,_e(s.width,Xe)),height:Math.max(et,_e(s.height,Xe))}:s,[H]),j=t.useCallback((s,u)=>{if(s.preventDefault(),s.stopPropagation(),!s.target.closest(".frame-drag-handle"))return;N(!0),P(u);const g=le.current[u],D=q.current;if(!g||!D)return;const w=s.target.closest(".frame-drag-handle"),k=g.getBoundingClientRect(),B=D.getBoundingClientRect(),X=window.getComputedStyle(D).transform,se=new DOMMatrix(X).a||1,Oe=s.clientX,ke=s.clientY,V=k.left-B.left+D.scrollLeft,G=k.top-B.top+D.scrollTop,te=(r[u]||{width:k.width,height:k.height,position:{x:V,y:G}}).position||{x:V,y:G};m(u,{position:te}),p(u);const xe={current:!0};ce.current=document.body.style.cursor,document.body.style.cursor="grabbing",w&&w.requestPointerLock();let Se=0,fe=0,be=performance.now(),ve={x:te.x,y:te.y};const Be=()=>{const W=D.parentElement;if(!W)return{horizontal:0,vertical:0};const _=W.getBoundingClientRect(),he=me.current.x,C=me.current.y;let A=0,a=0;return he>_.right-ie?A=1:he<_.left+ie&&(A=-1),C>_.bottom-ie?a=1:C<_.top+ie&&(a=-1),{horizontal:A,vertical:a}},{startAutoScroll:Ge,clearAutoScroll:We}=S(xe,Be),Le=W=>{var Ee,at;if(!xe.current)return;W.preventDefault(),W.stopPropagation(),me.current={x:W.clientX,y:W.clientY};let _,he;document.pointerLockElement===w?(Se+=W.movementX,fe+=W.movementY,_=Se/se,he=fe/se):(_=(W.clientX-Oe)/se,he=(W.clientY-ke)/se);let C=Math.max(0,te.x+_),a=Math.max(60,te.y+he);const F=I({x:C,y:a});C=F.x,a=F.y;const K=performance.now();(K-be>16||Math.abs(C-ve.x)>10||Math.abs(a-ve.y)>10)&&(m(u,{position:{x:C,y:a}}),be=K,ve={x:C,y:a});const J=D.parentElement;if(J){const Ne=J.getBoundingClientRect();(W.clientX>Ne.right-ie||W.clientX<Ne.left+ie||W.clientY>Ne.bottom-ie||W.clientY<Ne.top+ie)&&Ge()}const ee=((Ee=r[u])==null?void 0:Ee.width)||je,ye=((at=r[u])==null?void 0:at.height)||je;O(C,a,ee,ye)},ae=()=>{var _;xe.current=!1,N(!1),P(null),document.pointerLockElement===w&&document.exitPointerLock(),l();const W=((_=r[u])==null?void 0:_.position)||ve;o(u,W),We(),document.body.style.cursor=ce.current,document.removeEventListener("mousemove",Le),document.removeEventListener("mouseup",ae),document.removeEventListener("mouseleave",De),document.removeEventListener("pointerlockchange",Pe)},De=W=>{var _;document.pointerLockElement!==w&&(W!=null&&W.target)&&((_=W.target)==null?void 0:_.nodeName)==="HTML"&&ae()},Pe=()=>{document.pointerLockElement!==w&&xe.current&&ae()};document.addEventListener("mousemove",Le),document.addEventListener("mouseup",ae),document.addEventListener("mouseleave",De),document.addEventListener("pointerlockchange",Pe)},[r,I,S,O,m,l,p,o]),de=t.useCallback((s,u,g)=>{var W,_,he;s.preventDefault(),s.stopPropagation(),f(u),L(g),P(u);const D=le.current[u],w=q.current;if(!D||!w)return;ne.current=s.target;const k=window.getComputedStyle(w).transform,X=new DOMMatrix(k).a||1,Q=D.getBoundingClientRect(),se=w.getBoundingClientRect(),Oe=s.clientX,ke=s.clientY,V=((W=r[u])==null?void 0:W.width)||Q.width,G=((_=r[u])==null?void 0:_.height)||Q.height,re=((he=r[u])==null?void 0:he.position)||{x:Q.left-se.left+w.scrollLeft,y:Q.top-se.top+w.scrollTop};p(u);const te={current:!0};ce.current=document.body.style.cursor,document.body.style.cursor=mn(g),ne.current&&ne.current.requestPointerLock();let xe=0,Se=0,fe=performance.now(),be={x:re.x,y:re.y,width:V,height:G};const ve=()=>{const C=w.parentElement;if(!C)return{horizontal:0,vertical:0};const{x:A,y:a,width:F,height:K}=We();let J=0,ee=0;return g.includes("e")&&A+F>C.scrollLeft+C.clientWidth-ie?J=1:g.includes("w")&&A<C.scrollLeft+ie&&(J=-1),g.includes("s")&&a+K>C.scrollTop+C.clientHeight-ie?ee=1:g.includes("n")&&a<C.scrollTop+ie&&(ee=-1),{horizontal:J,vertical:ee}},{startAutoScroll:Be,clearAutoScroll:Ge}=S(te,ve),We=()=>{let C=V,A=G,a=re.x,F=re.y;const K=xe/X,J=Se/X;if(g.includes("e")&&(C=Math.max(Qe,V+K)),g.includes("w")){const ee=Math.max(Qe,V-K);C=ee,a=re.x+(V-ee)}if(g.includes("s")&&(A=Math.max(et,G+J)),g.includes("n")){const ye=Math.max(et,G-J);A=ye;const Ee=re.y+(G-ye);F=Math.max(60,Ee),F>Ee&&(A=G-(F-re.y)*X)}if(H){const ee=I({x:a,y:F});a=ee.x,F=ee.y;const ye=Z({width:C,height:A});C=ye.width,A=ye.height}return{x:a,y:F,width:C,height:A}},Le=C=>{if(!te.current)return;C.preventDefault(),C.stopPropagation(),document.pointerLockElement===ne.current?(xe+=C.movementX,Se+=C.movementY):(xe=C.clientX-Oe,Se=C.clientY-ke);const{x:A,y:a,width:F,height:K}=We(),J=performance.now();(J-fe>16||Math.abs(F-be.width)>5||Math.abs(K-be.height)>5||Math.abs(A-be.x)>5||Math.abs(a-be.y)>5)&&(m(u,{width:F,height:K,position:{x:A,y:a},maxHeight:!1}),fe=J,be={x:A,y:a,width:F,height:K}),Be(),O(A,a,F,K)},ae=()=>{te.current=!1,document.pointerLockElement===ne.current&&document.exitPointerLock(),l();const C=r[u];C!=null&&C.position&&o(u,C.position),f(null),L(null),P(null),Ge(),document.body.style.cursor=ce.current,document.removeEventListener("mousemove",Le),document.removeEventListener("mouseup",ae),document.removeEventListener("mouseleave",De),document.removeEventListener("pointerlockchange",Pe)},De=C=>{var A;document.pointerLockElement!==ne.current&&(C!=null&&C.target)&&((A=C.target)==null?void 0:A.nodeName)==="HTML"&&ae()},Pe=()=>{document.pointerLockElement!==ne.current&&te.current&&ae()};document.addEventListener("mousemove",Le),document.addEventListener("mouseup",ae),document.addEventListener("mouseleave",De),document.addEventListener("pointerlockchange",Pe)},[r,I,Z,S,O,m,l,p,o,H]),oe=t.useCallback(s=>{x(u=>{const g=u[s];if(!g)return u;const D=g.maxHeight?je:window.innerHeight-180,w={...g,height:D,maxHeight:!g.maxHeight};return p(s),w.position&&o(s,w.position),{...u,[s]:w}})},[p,o]),ue=t.useCallback((s,u=je,g=je)=>{x(D=>{var k;const w=(k=D[s])==null?void 0:k.position;return{...D,[s]:{height:g,width:u,maxHeight:!1,position:w}}})},[]),ge=t.useCallback(s=>{b(u=>{const g=new Set(u);return g.has(s)?g.delete(s):g.add(s),g})},[]);return{frameLayouts:r,resizingFrameId:z,resizeDirection:$,draggedFrameId:R,dragOverFrameId:E,draggingFrame:T,activeFrameId:y,frameRefs:le,framesContainerRef:q,expandedConfigFrames:M,handleFrameMoveStart:j,handleMultiDirectionResize:de,toggleMaximizeHeight:oe,resetFrameSize:ue,toggleConfigPanel:ge,setActiveFrameId:P,setResizingFrameId:f,setResizeDirection:L,setDraggedFrameId:i,setDragOverFrameId:U,snapToGrid:H,setSnapToGrid:Te}},xn=n=>{const[o,p]=t.useState(100),[h,r]=t.useState(!1),{containerRef:x,controlsHideDelay:z=2e3}=n||{},f=t.useRef(null),$=()=>{f.current!==null&&(window.clearTimeout(f.current),f.current=null)},L=t.useCallback(()=>{$(),f.current=window.setTimeout(()=>{r(!1)},z)},[z]),R=t.useCallback((T,N)=>{p(N)},[]),i=t.useCallback(()=>{p(T=>Math.min(T+10,200)),r(!0),L()},[L]),E=t.useCallback(()=>{p(T=>Math.max(T-10,50)),r(!0),L()},[L]),U=t.useCallback(()=>{r(T=>(T||$(),!T))},[]);return t.useEffect(()=>{const T=(x==null?void 0:x.current)||window,N=y=>{const P=y;(P.ctrlKey||P.metaKey)&&(P.preventDefault(),r(!0),P.deltaY<0?p(M=>Math.min(M+5,200)):p(M=>Math.max(M-5,50)),L())};return T.addEventListener("wheel",N,{passive:!1}),()=>{T.removeEventListener("wheel",N),$()}},[x,L]),t.useEffect(()=>()=>{$()},[]),{zoomLevel:o,showZoomControls:h,handleZoomChange:R,handleZoomIn:i,handleZoomOut:E,toggleZoomControls:U,setShowZoomControls:r}},fn=({parentRef:n})=>{const[o,p]=t.useState(!1),[h,r]=t.useState(!1),x=t.useRef({x:0,y:0}),z=t.useRef({left:0,top:0}),f=t.useRef(!1),$=t.useRef(""),L=t.useRef(new Map),R=t.useCallback(y=>{document.querySelectorAll("iframe").forEach(M=>{L.current.has(M)||L.current.set(M,M.style.pointerEvents||"auto"),M.style.pointerEvents=y})},[]),i=t.useCallback(()=>{L.current.forEach((y,P)=>{P.style.pointerEvents=y}),L.current.clear()},[]);t.useEffect(()=>{$.current=document.documentElement.style.overflow;const y=M=>{if(M.key===" "||M.code==="Space")return M.preventDefault(),M.stopPropagation(),M.stopImmediatePropagation(),M.type==="keydown"&&!M.repeat&&!f.current&&(f.current=!0,r(!0),document.body.style.cursor="grab",document.documentElement.style.overflow="hidden",R("none")),M.type==="keyup"&&(f.current=!1,r(!1),document.body.style.cursor="",document.documentElement.style.overflow=$.current,R("auto"),i(),T()),!1},P=M=>{if(f.current)return M.preventDefault(),M.stopPropagation(),!1};return document.addEventListener("keydown",y,{capture:!0,passive:!1}),document.addEventListener("keypress",y,{capture:!0,passive:!1}),document.addEventListener("keyup",y,{capture:!0,passive:!1}),document.addEventListener("scroll",P,{capture:!0,passive:!1}),document.addEventListener("wheel",P,{capture:!0,passive:!1}),document.addEventListener("focusin",()=>{f.current&&(document.documentElement.style.overflow="hidden",R("none"))},{capture:!0}),window.addEventListener("blur",()=>{f.current&&(f.current=!1,r(!1),document.body.style.cursor="",document.documentElement.style.overflow=$.current,i(),T())}),()=>{document.removeEventListener("keydown",y,{capture:!0}),document.removeEventListener("keypress",y,{capture:!0}),document.removeEventListener("keyup",y,{capture:!0}),document.removeEventListener("scroll",P,{capture:!0}),document.removeEventListener("wheel",P,{capture:!0}),document.documentElement.style.overflow=$.current,document.body.style.cursor="",i()}},[R,i]);const E=t.useCallback(y=>{if(!o||!n.current)return;y.preventDefault(),y.stopPropagation();const P=y.clientX-x.current.x,M=y.clientY-x.current.y;n.current.scrollLeft=z.current.left-P,n.current.scrollTop=z.current.top-M,document.body.style.cursor="grabbing"},[o,n]);t.useEffect(()=>{if(o)return document.addEventListener("mousemove",E,{passive:!1}),document.addEventListener("mouseup",T),()=>{document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",T)}},[o,E]);const U=t.useCallback(y=>{!h||!n.current||(y.preventDefault(),y.stopPropagation(),p(!0),x.current={x:y.clientX,y:y.clientY},z.current={left:n.current.scrollLeft,top:n.current.scrollTop},document.body.style.cursor="grabbing",R("none"))},[h,n,R]),T=t.useCallback(()=>{p(!1),document.body.style.cursor=f.current?"grab":"",f.current||i()},[i]),N=t.useCallback(()=>{r(y=>!y)},[]);return{isPanning:o,isPanningEnabled:h,startPanning:U,stopPanning:T,togglePanningMode:N}},Fe={position:"absolute",width:20,height:20,zIndex:100,display:"flex",justifyContent:"center",alignItems:"center",transition:"background-color 0.2s ease"},ze={width:10,height:10,borderRadius:"50%",backgroundColor:"currentColor",transition:"transform 0.2s ease, background-color 0.2s ease, box-shadow 0.2s ease",boxShadow:"0 0 0 2px rgba(255, 255, 255, 0.5), 0 0 0 1px rgba(0, 0, 0, 0.2)","&:hover":{transform:"scale(1.5)",boxShadow:"0 0 0 2px rgba(255, 255, 255, 0.8), 0 0 0 1px rgba(0, 0, 0, 0.5)"}},bn=({frameId:n,onResize:o})=>{const p=Re(),r={color:p.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.5)","&::before":{content:'""',position:"absolute",width:"100%",height:"100%",borderRadius:"50%",backgroundColor:"rgba(255, 255, 255, 0.1)",zIndex:-1},"&:hover":{color:p.palette.primary.main,"&::before":{backgroundColor:"rgba(255, 255, 255, 0.3)"}}};return e.jsxs(e.Fragment,{children:[e.jsx(v,{sx:{...Fe,top:0,left:0,cursor:"nwse-resize",...r},onMouseDown:x=>o(x,n,"nw"),children:e.jsx(v,{sx:ze})}),e.jsx(v,{sx:{...Fe,top:0,right:0,cursor:"nesw-resize",...r},onMouseDown:x=>o(x,n,"ne"),children:e.jsx(v,{sx:ze})}),e.jsx(v,{sx:{...Fe,bottom:0,left:0,cursor:"nesw-resize",...r},onMouseDown:x=>o(x,n,"sw"),children:e.jsx(v,{sx:ze})}),e.jsx(v,{sx:{...Fe,bottom:0,right:0,cursor:"nwse-resize",...r},onMouseDown:x=>o(x,n,"se"),children:e.jsx(v,{sx:ze})}),e.jsx(v,{sx:{...Fe,top:"50%",right:0,transform:"translateY(-50%)",cursor:"ew-resize",...r},onMouseDown:x=>o(x,n,"e"),children:e.jsx(v,{sx:ze})}),e.jsx(v,{sx:{...Fe,top:"50%",left:0,transform:"translateY(-50%)",cursor:"ew-resize",...r},onMouseDown:x=>o(x,n,"w"),children:e.jsx(v,{sx:ze})}),e.jsx(v,{sx:{...Fe,top:0,left:"50%",transform:"translateX(-50%)",cursor:"ns-resize",...r},onMouseDown:x=>o(x,n,"n"),children:e.jsx(v,{sx:ze})}),e.jsx(v,{sx:{...Fe,bottom:0,left:"50%",transform:"translateX(-50%)",cursor:"ns-resize",...r},onMouseDown:x=>o(x,n,"s"),children:e.jsx(v,{sx:ze})})]})},yn=({frame:n,onChangeCountry:o,onOptionChange:p})=>{const h=Re(),[r,x]=t.useState(null),z=!!r,f={};He.forEach(i=>{f[i.key]=n.selectedOptions[i.key]||i.defaultValue});const $=i=>{x(i.currentTarget)},L=()=>{x(null)},R=i=>{o(n.id,i)};return e.jsxs(e.Fragment,{children:[e.jsx(ft,{size:"small",color:"default","aria-label":"configuration options",onClick:$,sx:{position:"absolute",bottom:16,right:16,bgcolor:z?h.palette.primary.main:h.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.4)",color:z?"#fff":h.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)","&:hover":{bgcolor:h.palette.primary.main,color:"#fff"},transition:"background-color 0.3s, color 0.3s, opacity 0.3s",boxShadow:z?h.shadows[8]:"none",backdropFilter:"blur(4px)",opacity:z?1:.7,zIndex:100},children:e.jsx(nt,{})}),e.jsxs(bt,{open:z,anchorEl:r,onClose:L,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"right"},slots:{transition:ot},slotProps:{transition:{timeout:{enter:200,exit:200}},paper:{elevation:4,sx:{borderRadius:2,bgcolor:h.palette.background.paper,maxWidth:380,width:"100%",overflow:"hidden",backdropFilter:"blur(8px)"}}},children:[e.jsxs(v,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:2,borderBottom:`1px solid ${h.palette.divider}`,bgcolor:h.palette.mode==="dark"?"rgba(66, 66, 66, 0.2)":"rgba(248, 248, 248, 0.8)"},children:[e.jsx(Y,{variant:"subtitle1",fontWeight:"medium",color:"primary",children:"Frame Configuration"}),e.jsx(we,{size:"small",onClick:L,children:e.jsx(st,{fontSize:"small"})})]}),e.jsx(v,{sx:{p:2,maxHeight:"40rem",overflowY:"auto",scrollbarWidth:"thin","&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-track":{background:h.palette.background.default},"&::-webkit-scrollbar-thumb":{backgroundColor:h.palette.divider,borderRadius:"4px"}},children:e.jsxs(qe,{spacing:2.5,children:[e.jsxs(v,{sx:{backgroundColor:h.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.9)",p:1.5,borderRadius:1,boxShadow:h.shadows[1]},children:[e.jsx(Y,{variant:"subtitle2",color:"primary",gutterBottom:!0,fontWeight:"medium",children:"Country"}),e.jsxs(yt,{fullWidth:!0,size:"small",children:[e.jsx(Ct,{id:"country-label",children:"Country"}),e.jsx(wt,{labelId:"country-label",id:"country",value:n.countryLanguageCode,label:"Country",onChange:i=>R(i.target.value),MenuProps:{PaperProps:{style:{maxHeight:300}}},children:Object.entries(Ce).map(([i,E])=>e.jsxs(Ye,{value:i,children:[E.pretty," (",i,")"]},i))}),e.jsx(St,{children:"Use the dropdown to change country"})]})]}),e.jsx($e,{}),e.jsxs(v,{sx:{backgroundColor:h.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.9)",p:1.5,borderRadius:1,boxShadow:h.shadows[1]},children:[e.jsx(Y,{variant:"subtitle2",color:"primary",gutterBottom:!0,fontWeight:"medium",children:"Environment"}),e.jsx(Ue,{fields:He.filter(i=>["environment","uscEnv"].includes(i.key)),values:f,countryCode:n.countryLanguageCode,onChange:(i,E)=>p(n.id,i,E),size:"small",showLabels:!0,showDescriptions:!0,layout:"vertical"})]}),e.jsx($e,{}),e.jsxs(v,{sx:{backgroundColor:h.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.9)",p:1.5,borderRadius:1,boxShadow:h.shadows[1]},children:[e.jsx(Y,{variant:"subtitle2",color:"primary",gutterBottom:!0,fontWeight:"medium",children:"Component"}),e.jsx(Ue,{fields:He.filter(i=>["component"].includes(i.key)),values:f,countryCode:n.countryLanguageCode,onChange:(i,E)=>p(n.id,i,E),size:"small",showLabels:!0,showDescriptions:!0,layout:"vertical"})]}),e.jsx($e,{}),e.jsxs(v,{sx:{backgroundColor:h.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.9)",p:1.5,borderRadius:1,boxShadow:h.shadows[1]},children:[e.jsx(Y,{variant:"subtitle2",color:"primary",gutterBottom:!0,fontWeight:"medium",children:"USC Context"}),e.jsx(Ue,{fields:He.filter(i=>["uscContext"].includes(i.key)),values:f,countryCode:n.countryLanguageCode,onChange:(i,E)=>p(n.id,i,E),size:"small",showLabels:!0,showDescriptions:!0,layout:"vertical"})]}),e.jsx($e,{}),e.jsxs(v,{sx:{backgroundColor:h.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.9)",p:1.5,borderRadius:1,boxShadow:h.shadows[1]},children:[e.jsx(Y,{variant:"subtitle2",color:"primary",gutterBottom:!0,fontWeight:"medium",children:"Brand Settings"}),e.jsx(Ue,{fields:He.filter(i=>["brand","variantBrand"].includes(i.key)),values:f,countryCode:n.countryLanguageCode,onChange:(i,E)=>p(n.id,i,E),size:"small",showLabels:!0,showDescriptions:!0,layout:"vertical"})]}),e.jsx($e,{}),e.jsxs(v,{sx:{backgroundColor:h.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.9)",p:1.5,borderRadius:1,boxShadow:h.shadows[1]},children:[e.jsx(Y,{variant:"subtitle2",color:"primary",gutterBottom:!0,fontWeight:"medium",children:"Retailer Screen"}),e.jsx(Ue,{fields:He.filter(i=>["retailerscreen"].includes(i.key)),values:f,countryCode:n.countryLanguageCode,onChange:(i,E)=>p(n.id,i,E),size:"small",showLabels:!0,showDescriptions:!0,layout:"vertical"})]}),e.jsx($e,{}),e.jsxs(v,{sx:{backgroundColor:h.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.9)",p:1.5,borderRadius:1,boxShadow:h.shadows[1]},children:[e.jsx(Y,{variant:"subtitle2",color:"primary",gutterBottom:!0,fontWeight:"medium",children:"Toyota Code"}),e.jsx(Ue,{fields:He.filter(i=>["tyCode"].includes(i.key)),values:f,countryCode:n.countryLanguageCode,onChange:(i,E)=>p(n.id,i,E),size:"small",showLabels:!0,showDescriptions:!0,layout:"vertical"})]})]})})]})]})},Cn=({open:n,onClose:o,frame:p,onUpdateSyncOption:h})=>{const r=Re(),x=p.syncOptions||tt(),z=L=>R=>{h(p.id,L,R.target.checked)},f=sn(),$=f.reduce((L,R,i)=>(L.push(e.jsx(jt,{secondaryAction:e.jsx(kt,{edge:"end",onChange:z(R.key),checked:x[R.key],color:"primary"}),children:e.jsx(Ke,{primary:R.label,secondary:R.description,primaryTypographyProps:{fontWeight:500}})},R.key)),i<f.length-1&&L.push(e.jsx($e,{variant:"inset",component:"li"},`divider-${R.key}`)),L),[]);return e.jsxs(vt,{open:n,onClose:o,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[e.jsxs(Lt,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:r.palette.mode==="dark"?"rgba(66, 66, 66, 0.2)":"rgba(248, 248, 248, 0.8)",borderBottom:`1px solid ${r.palette.divider}`,p:2},children:[e.jsxs(v,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(nt,{color:"primary",sx:{mr:1}}),e.jsx(Y,{variant:"h6",component:"div",children:"Sync Configuration Settings"})]}),e.jsx(we,{onClick:o,size:"small",children:e.jsx(st,{fontSize:"small"})})]}),e.jsxs(Et,{children:[e.jsx(Y,{variant:"body2",color:"text.secondary",component:"p",sx:{mt:2},children:"Choose which settings should be synchronized between frames when sync is enabled. Disabled settings will remain independent for each frame."}),e.jsx(Mt,{sx:{pt:2},children:$})]}),e.jsx(Ft,{sx:{p:2,backgroundColor:r.palette.mode==="dark"?"rgba(66, 66, 66, 0.2)":"rgba(248, 248, 248, 0.8)",borderTop:`1px solid ${r.palette.divider}`},children:e.jsx(zt,{onClick:o,color:"primary",children:"Close"})})]})},pt=t.memo(({frame:n,layout:o,isActive:p,isDragging:h,isResizing:r,isDraggedOver:x,globalSyncEnabled:z,onMove:f,onResize:$,onRemove:L,onCopyUrl:R,onMenuOpen:i,onToggleSync:E,onIframeLoad:U,onOptionChange:T,onChangeCountry:N,onShowNotification:y,onUpdateSyncOption:P,onReload:M})=>{var ge;const b=Re(),H=t.useRef(null),[Te,q]=t.useState(!1),[le,ce]=t.useState(!1),[ne,me]=t.useState(!1);t.useEffect(()=>{let s=null;return le&&!h&&!r?s=window.setTimeout(()=>me(!0),150):s=window.setTimeout(()=>me(!1),100),()=>{s!==null&&clearTimeout(s)}},[le,h,r,p]);const d=()=>{},c=()=>{},l=()=>q(!0),m=()=>q(!1),S=((ge=Ce[n.countryLanguageCode])==null?void 0:ge.pretty)||"Frame",O=t.useMemo(()=>h?"frame-dragging":r?"frame-resizing":x?"frame-drag-over":p?"frame-active":"",[h,r,x,p]),I=t.useMemo(()=>({height:o.height||400,display:"flex",flexDirection:"column",overflow:"hidden",transition:r||h?"none":b.transitions.create(["box-shadow","transform"],{duration:200}),transform:x?"scale(1.01)":"scale(1)",position:"relative",boxShadow:p?b.shadows[12]:le?b.shadows[6]:b.shadows[3],border:`1px solid ${p?b.palette.primary.main:x?pe(b.palette.primary.main,.5):b.palette.divider}`,"&:hover":{boxShadow:b.shadows[8]},"&::before":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,opacity:.03,pointerEvents:"none",backgroundImage:`radial-gradient(${b.palette.primary.light} 1px, transparent 1px)`,backgroundSize:"20px 20px",zIndex:0},backgroundColor:b.palette.background.paper}),[o.height,r,h,p,le,x,b]),Z=t.useMemo(()=>({p:1,bgcolor:b.palette.mode==="dark"?pe(b.palette.background.paper,.7):pe(b.palette.background.paper,.85),backdropFilter:"blur(8px)",borderBottom:`1px solid ${b.palette.divider}`,display:"flex",alignItems:"center",justifyContent:"space-between",minHeight:"48px",position:"relative",zIndex:10,"&:hover":{backgroundColor:b.palette.mode==="dark"?pe(b.palette.background.default,.8):pe(b.palette.background.paper,.95)}}),[b]),j=t.useMemo(()=>({display:"flex",alignItems:"center",flex:1,cursor:"move",borderRadius:"4px",py:.5,pl:.5,pr:1,transition:"background-color 0.2s ease",".MuiSvgIcon-root":{transition:"transform 0.2s ease"},"&:hover .MuiSvgIcon-root":{transform:"scale(1.1)"}}),[]),de=t.useMemo(()=>e.jsx(Rt,{size:"small",variant:"outlined",label:`${Math.round(o.width)||400}Ã—${Math.round(o.height)||400}`,sx:{height:"22px",fontSize:"0.7rem",borderRadius:"4px",fontFamily:"monospace",fontWeight:"medium",bgcolor:pe(b.palette.background.default,.7),backdropFilter:"blur(4px)",borderColor:b.palette.divider,color:b.palette.text.secondary,ml:1,"& .MuiChip-label":{px:.75}}}),[o.width,o.height,b]),oe=t.useMemo(()=>{const s=o.width||400,u=[];return s>=220&&u.push("reload"),s>=280&&u.push("sync"),s>=350&&u.push("copy"),s>=420&&u.push("syncOptions"),u},[o.width]),ue=t.useMemo(()=>ne||p,[ne,p]);return e.jsxs(Tt,{elevation:0,sx:I,className:`frame ${O}`,onMouseEnter:()=>!h&&!r&&ce(!0),onMouseLeave:()=>ce(!1),children:[e.jsxs(v,{sx:Z,children:[e.jsxs(v,{className:"frame-drag-handle",sx:j,onMouseDown:s=>f(s,n.id),children:[e.jsx(Ie,{title:"Drag to move frame",children:e.jsx(rt,{fontSize:"small",sx:{mr:1,color:b.palette.primary.main,opacity:.7}})}),e.jsx(rn,{selectedOptions:n.selectedOptions,countryLanguageCode:n.countryLanguageCode,maxWidth:o.width?Math.max(60,o.width-260):120}),o.width>280&&de]}),e.jsxs(qe,{direction:"row",spacing:.5,sx:{ml:"auto","& .MuiButtonBase-root":{color:b.palette.text.secondary},minWidth:"72px",justifyContent:"flex-end"},children:[e.jsx(ct,{initial:!1,onExitComplete:d,children:ue&&e.jsx(cn.div,{initial:{opacity:0,width:0},animate:{opacity:1,width:"auto",transition:{duration:.2,ease:"easeOut"}},exit:{opacity:0,width:0,transition:{duration:.15,ease:"easeIn"}},onAnimationStart:c,onAnimationComplete:d,style:{display:"flex",overflow:"hidden"},children:e.jsxs(Ot,{variant:"text",size:"small",sx:{display:"flex",alignItems:"center",backgroundColor:pe(b.palette.background.paper,1),backdropFilter:"blur(8px)",border:`1px solid ${b.palette.divider}`,borderColor:p?b.palette.primary.main:b.palette.divider,boxShadow:b.shadows[2],borderRadius:"4px",mr:.5,"& .MuiButtonGroup-grouped":{minWidth:"auto",px:.5}},children:[oe.includes("reload")&&e.jsx(Ie,{title:"Reload frame",placement:"top",children:e.jsx(we,{size:"small",onClick:()=>M(n.id),children:e.jsx(Dt,{fontSize:"small"})})}),oe.includes("copy")&&e.jsx(Ie,{title:"Copy URL",placement:"top",children:e.jsx(we,{size:"small",onClick:()=>R(n.generatedUrl),children:e.jsx(Pt,{fontSize:"small"})})}),oe.includes("sync")&&e.jsx(Ie,{title:n.syncEnabled?"Disable config sync":"Enable config sync",placement:"top",children:e.jsx(we,{size:"small",onClick:()=>E(n.id),color:n.syncEnabled||z?"primary":"default",disabled:z,children:n.syncEnabled?e.jsx(It,{fontSize:"small"}):e.jsx(Ht,{fontSize:"small"})})}),oe.includes("syncOptions")&&e.jsx(Ie,{title:"Sync configuration options",placement:"top",children:e.jsx(we,{size:"small",onClick:l,color:n.syncEnabled||z?"primary":"default",disabled:z,children:e.jsx($t,{fontSize:"small"})})})]})})}),e.jsx(Ie,{title:"Configure",placement:"top",children:e.jsx(we,{size:"small",onClick:s=>i(s,n.id),sx:{bgcolor:pe(b.palette.background.default,.5),"&:hover":{bgcolor:pe(b.palette.background.default,.8)}},children:e.jsx(nt,{fontSize:"small"})})}),e.jsx(Ie,{title:"Remove frame",placement:"top",children:e.jsx(we,{size:"small",color:"error",onClick:()=>L(n.id),sx:{bgcolor:pe(b.palette.error.light,.1),"&:hover":{bgcolor:pe(b.palette.error.light,.2)}},children:e.jsx(st,{fontSize:"small"})})})]})]}),e.jsxs(v,{sx:{flex:1,position:"relative",minHeight:"360px",overflow:"hidden",bgcolor:b.palette.mode==="dark"?"#121212":"#fafafa"},children:[e.jsx(ct,{children:n.iframeLoading&&e.jsx(dn,{message:`Loading ${S}...`})}),e.jsx("iframe",{ref:H,src:n.generatedUrl,style:{border:"none",width:"100%",height:"100%",display:"block",backgroundColor:b.palette.mode==="dark"?"#1E1E1E":"#FFFFFF"},onLoad:()=>U(n.id),title:`Frame ${n.id}`}),e.jsx(yn,{frame:n,onChangeCountry:N,onOptionChange:T,onShowNotification:y})]}),e.jsx(bn,{frameId:n.id,onResize:$}),e.jsx(Cn,{open:Te,onClose:m,frame:n,onUpdateSyncOption:P})]})});pt.displayName="Frame";const mt=tn.memo(({zoomLevel:n,onZoomChange:o,onZoomIn:p,onZoomOut:h})=>e.jsx(ut,{elevation:3,sx:{p:2,width:240,borderRadius:2},children:e.jsxs(qe,{spacing:2,children:[e.jsxs(Y,{variant:"subtitle2",textAlign:"center",children:["Zoom Level: ",n,"%"]}),e.jsxs(qe,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(we,{onClick:h,size:"small",children:e.jsx(Wt,{})}),e.jsx(At,{value:n,onChange:o,min:50,max:200,step:5,valueLabelDisplay:"auto",valueLabelFormat:r=>`${r}%`}),e.jsx(we,{onClick:p,size:"small",children:e.jsx(Ut,{})})]})]})}));mt.displayName="ZoomControls";const gt=t.memo(({open:n,onOpen:o,onClose:p,globalSyncEnabled:h,showGrid:r,snapToGrid:x,showZoomControls:z,isPanningEnabled:f,onAddFrame:$,onToggleGlobalSync:L,onToggleGrid:R,onToggleSnapToGrid:i,onToggleZoomControls:E,onTogglePanningMode:U,onSyncFrameSizes:T,onShowKeyboardShortcuts:N})=>{const y=Re(),P=b=>({bgcolor:b?y.palette.mode==="dark"?"#2c5282":"#e3f2fd":y.palette.mode==="dark"?"#333333":"#ffffff",color:b?y.palette.primary.main:"inherit","&:hover":{bgcolor:b?y.palette.mode==="dark"?"#3b6eb4":"#bbdefb":y.palette.mode==="dark"?"#444444":"#f5f5f5",transform:"scale(1.05)"},boxShadow:y.shadows[2]}),M={bgcolor:y.palette.mode==="dark"?"#333333":"#ffffff","&:hover":{bgcolor:y.palette.mode==="dark"?"#444444":"#f5f5f5",transform:"scale(1.05)"},boxShadow:y.shadows[2]};return e.jsxs(Bt,{ariaLabel:"Action controls",open:n,onOpen:o,onClose:p,sx:{position:"fixed",bottom:16,right:16,zIndex:1501,"& .MuiFab-primary":{bgcolor:y.palette.primary.main,"&:hover":{bgcolor:y.palette.primary.dark},transition:"all 0.3s ease"},"& .MuiSpeedDial-actions":{gap:.5}},icon:e.jsx(it,{}),direction:"up",openIcon:e.jsx(it,{}),FabProps:{sx:{boxShadow:y.shadows[4],"&:hover":{boxShadow:y.shadows[8],transform:"scale(1.05)"}}},children:[e.jsx(Me,{icon:e.jsx(Gt,{}),tooltipTitle:"Add new frame",tooltipPlacement:"left",onClick:$,sx:M},"add-frame"),e.jsx(Me,{icon:e.jsx(Yt,{}),tooltipTitle:h?"Disable global sync":"Enable global sync",tooltipPlacement:"left",onClick:L,sx:P(h)},"toggle-sync"),e.jsx(Me,{icon:r?e.jsx(Nt,{}):e.jsx(Zt,{}),tooltipTitle:r?"Hide grid":"Show grid",tooltipPlacement:"left",onClick:R,sx:P(r)},"toggle-grid"),e.jsx(Me,{icon:e.jsx(Xt,{}),tooltipTitle:x?"Disable snap to grid":"Enable snap to grid",tooltipPlacement:"left",onClick:i,sx:P(x)},"toggle-snap"),e.jsx(Me,{icon:e.jsx(_t,{}),tooltipTitle:"Zoom controls",tooltipPlacement:"left",onClick:E,sx:P(z)},"toggle-zoom"),e.jsx(Me,{icon:e.jsx(Kt,{}),tooltipTitle:"Sync all frame sizes",tooltipPlacement:"left",onClick:T,sx:M},"sync-frame-sizes"),e.jsx(Me,{icon:e.jsx(rt,{}),tooltipTitle:f?"Disable panning mode":"Enable panning mode",tooltipPlacement:"left",onClick:U,sx:P(f)},"toggle-panning"),e.jsx(Me,{icon:e.jsx(ht,{}),tooltipTitle:"Keyboard shortcuts",tooltipPlacement:"left",onClick:N,sx:M},"toggle-keyboard-shortcuts")]})});gt.displayName="ActionSpeedDial";const wn=({visible:n,onClose:o})=>{const p=Re();return n?e.jsx(ot,{in:n,children:e.jsxs(ut,{elevation:3,sx:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"auto",minWidth:300,maxWidth:400,p:3,zIndex:1600,backdropFilter:"blur(5px)",backgroundColor:p.palette.mode==="dark"?"rgba(30, 30, 30, 0.9)":"rgba(255, 255, 255, 0.9)",borderRadius:2,border:`1px solid ${p.palette.divider}`},children:[e.jsxs(Y,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(ht,{sx:{mr:1}})," Keyboard Shortcuts"]}),e.jsxs(v,{sx:{display:"grid",gridTemplateColumns:"auto 1fr",gap:2,alignItems:"center"},children:[e.jsx(Y,{variant:"body2",fontWeight:"bold",children:"Space + Drag"}),e.jsx(Y,{variant:"body2",children:"Pan around the canvas"}),e.jsx(Y,{variant:"body2",fontWeight:"bold",children:"Ctrl + Scroll"}),e.jsx(Y,{variant:"body2",children:"Zoom in/out"}),e.jsx(Y,{variant:"body2",fontWeight:"bold",children:"Esc"}),e.jsx(Y,{variant:"body2",children:"Close this panel"})]}),e.jsx(v,{sx:{display:"flex",justifyContent:"flex-end",mt:2},children:e.jsx(Y,{variant:"body2",color:"primary",sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:o,children:"Close"})})]})}):null},xt=t.memo(({showGrid:n,zoomLevel:o,isPanningEnabled:p,onStartPanning:h,containerStyle:r,containerRef:x,children:z})=>{const f=Re(),$=t.useRef(null),L=x||$,R=20,i=t.useMemo(()=>R*(100/o),[R,o]),E=t.useMemo(()=>({backgroundSize:n?`${i}px ${i}px`:"initial",backgroundImage:n?`linear-gradient(to right, ${f.palette.divider} 1px, transparent 1px),
       linear-gradient(to bottom, ${f.palette.divider} 1px, transparent 1px)`:"none","&::after":n?{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,pointerEvents:"none",background:`radial-gradient(
        circle at center,
        transparent 30%,
        ${f.palette.background.default} 100%
      )`,zIndex:0}:{}}),[n,i,f.palette.divider,f.palette.background.default]),U=t.useMemo(()=>({display:"flex",flexWrap:"wrap",gap:2,position:"relative",transform:`scale(${o/100})`,transformOrigin:"top left",transition:"transform 0.2s ease",padding:o<100?`${(100-o)/2}px`:0,minWidth:`${1e4/o}%`,height:o<100?`${1e4/o*.01}%`:"auto",...E,...r}),[o,E,r]);return e.jsxs(e.Fragment,{children:[p&&e.jsx(ot,{in:!0,children:e.jsxs(v,{sx:{position:"fixed",bottom:80,left:16,zIndex:1e3,backgroundColor:f.palette.mode==="dark"?"rgba(0,0,0,0.7)":"rgba(255,255,255,0.7)",backdropFilter:"blur(4px)",borderRadius:2,padding:1,display:"flex",alignItems:"center",boxShadow:f.shadows[3],border:`1px solid ${f.palette.divider}`},children:[e.jsx(rt,{sx:{mr:1,color:f.palette.primary.main}}),e.jsxs(Y,{variant:"body2",children:["Press ",e.jsx("b",{children:"Space + Drag"})," to pan"]})]})}),e.jsx(v,{ref:L,className:"frames-container",sx:U,onMouseDown:T=>{p&&(T.target===T.currentTarget||T.target.closest(".frames-container"))&&h(T)},children:z})]})});xt.displayName="FrameGridContainer";const Fn=()=>{var C,A;const n=Re(),o=qt(n.breakpoints.down("md")),[p,h]=t.useState(null),[r,x]=t.useState(!1),[z,f]=t.useState(!1),[$,L]=t.useState(!1),[R,i]=t.useState(null),E=t.useRef(null),{frames:U,notification:T,globalSyncEnabled:N,addNewFrame:y,removeFrame:P,handleOptionChange:M,changeCountry:b,copyUrlToClipboard:H,handleIframeLoad:Te,showNotification:q,markFrameAsCustomSized:le,resetFrameCustomSize:ce,updateFramePosition:ne,toggleFrameSync:me,toggleGlobalSync:d,updateFrameSyncOptions:c,refreshFrame:l}=un(),{frameLayouts:m,resizingFrameId:S,draggedFrameId:O,dragOverFrameId:I,draggingFrame:Z,activeFrameId:j,frameRefs:de,framesContainerRef:oe,expandedConfigFrames:ue,handleFrameMoveStart:ge,handleMultiDirectionResize:s,toggleMaximizeHeight:u,resetFrameSize:g,setActiveFrameId:D,snapToGrid:w,setSnapToGrid:k}=gn({frames:U,onUpdateFramePosition:ne,onMarkFrameAsCustomSized:le}),{zoomLevel:B,showZoomControls:X,handleZoomChange:Q,handleZoomIn:se,handleZoomOut:Oe,toggleZoomControls:ke}=xn({containerRef:E}),{isPanning:V,isPanningEnabled:G,startPanning:re,stopPanning:te,togglePanningMode:xe}=fn({parentRef:E});t.useEffect(()=>{const a=F=>{F.key==="Escape"&&$&&L(!1)};return document.addEventListener("keydown",a),()=>{document.removeEventListener("keydown",a)}},[$]),t.useEffect(()=>{const a=()=>{V&&te()},F=()=>{V&&te()};return document.addEventListener("mouseup",a),document.addEventListener("mouseleave",F),()=>{document.removeEventListener("mouseup",a),document.removeEventListener("mouseleave",F)}},[V,te]);const Se=t.useCallback((a,F)=>{h(a.currentTarget),D(F)},[D]),fe=t.useCallback(()=>{h(null),D(null)},[D]),be=t.useCallback(a=>{i(a.currentTarget)},[]),ve=t.useCallback(()=>{i(null)},[]),Be=t.useCallback((a,F)=>{j&&g(j,a,F)},[j,g]),Ge=t.useCallback(()=>{x(a=>!a)},[]),We=t.useCallback(()=>{k(!w),q(w?"Snap to grid disabled":"Snap to grid enabled")},[w,k,q]),Le=t.useCallback(()=>{L(a=>!a)},[]),ae=t.useCallback(a=>F=>{de.current[a]=F},[de]),De=t.useCallback(()=>{j&&g(j,o?window.innerWidth-40:400)},[j,g,o]),Pe=t.useCallback(()=>{j&&(g(j,o?window.innerWidth-40:400),ce(j)),fe()},[j,g,ce,fe,o]),W=t.useCallback(()=>{var K,J,ee,ye;if(!U.length)return;const a=j&&((K=m[j])!=null&&K.width)?m[j].width:((J=m[U[0].id])==null?void 0:J.width)||400,F=j&&((ee=m[j])!=null&&ee.height)?m[j].height:((ye=m[U[0].id])==null?void 0:ye.height)||400;U.forEach(Ee=>{Ee.id!==j&&g(Ee.id,a,F)}),q(`All frames synced to ${a}px width and ${F}px height`)},[U,j,m,g,q]),_=t.useMemo(()=>U.map(a=>{const F=m[a.id]||{width:400,height:400,maxHeight:!1},K=F.position||a.position||{x:0,y:0},J={width:F.width||400,height:F.height||"auto",position:"absolute",left:K.x,top:K.y,transition:O===a.id||S===a.id||Z?"none":"all 0.2s ease",opacity:O===a.id?.6:1,transform:I===a.id?"scale(1.01)":"scale(1)",zIndex:j===a.id?1001:Z&&O===a.id?1e3:1,boxShadow:S===a.id||j===a.id?n.shadows[8]:n.shadows[2]};return e.jsx(v,{ref:ae(a.id),sx:J,children:e.jsx(pt,{frame:a,layout:F,isActive:j===a.id,isDragging:O===a.id,isResizing:S===a.id,isDraggedOver:I===a.id,isConfigExpanded:ue.has(a.id),globalSyncEnabled:N,onMove:ge,onResize:s,onRemove:P,onCopyUrl:H,onMenuOpen:Se,onToggleSync:me,onIframeLoad:Te,onOptionChange:M,onChangeCountry:b,onShowNotification:q,frameRef:null,onUpdateSyncOption:c,onReload:l})},a.id)}),[U,m,O,S,Z,j,ue,N,n.shadows,ge,s,P,H,Se,me,Te,M,b,q,ae,I]),he=t.useMemo(()=>{var a;return e.jsx(Ye,{onClick:()=>j&&u(j),children:j&&((a=m[j])!=null&&a.maxHeight)?e.jsxs(e.Fragment,{children:[e.jsx(Vt,{fontSize:"small",sx:{mr:1}}),"Reset Height"]}):e.jsxs(e.Fragment,{children:[e.jsx(Jt,{fontSize:"small",sx:{mr:1}}),"Maximize Height"]})})},[j,m,u]);return e.jsxs(v,{ref:E,sx:{height:"100%",width:"100%",overflow:"auto",p:2,backgroundColor:n.palette.background.default,position:"relative",cursor:G?V?"grabbing":"grab":"default"},children:[e.jsx(xt,{showGrid:r,zoomLevel:B,isPanningEnabled:G,isPanning:V,onStartPanning:re,containerRef:oe,parentRef:E,children:_}),e.jsx(wn,{visible:$,onClose:Le}),e.jsxs(Qt,{anchorEl:p,open:!!p,onClose:fe,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[he,e.jsxs(Ye,{onClick:be,children:[e.jsx(Ve,{children:e.jsx(Je,{fontSize:"small"})}),e.jsx(Ke,{primary:"Change Frame Size",secondary:j?`Current: ${((C=m[j])==null?void 0:C.width)||400}px`:void 0}),e.jsx(en,{fontSize:"small"})]}),e.jsxs(Ye,{onClick:()=>De(),children:[e.jsx(Ve,{children:e.jsx(Je,{fontSize:"small"})}),e.jsx(Ke,{primary:"Reset Size"})]}),e.jsxs(Ye,{onClick:Pe,children:[e.jsx(Ve,{children:e.jsx(Je,{fontSize:"small"})}),e.jsx(Ke,{primary:"Reset All"})]})]}),e.jsx(an,{anchorEl:R,currentWidth:j&&((A=m[j])==null?void 0:A.width)||400,onClose:ve,onSelect:Be,onCloseParentMenu:fe}),e.jsx(ln,{message:T,open:!!T}),e.jsx(gt,{open:z,onOpen:()=>f(!0),onClose:()=>f(!1),globalSyncEnabled:N,showGrid:r,snapToGrid:w,showZoomControls:X,isPanningEnabled:G,onAddFrame:y,onToggleGlobalSync:d,onToggleGrid:Ge,onToggleSnapToGrid:We,onToggleZoomControls:ke,onTogglePanningMode:xe,onSyncFrameSizes:W,onShowKeyboardShortcuts:Le}),X&&e.jsx(v,{sx:{position:"fixed",bottom:16,right:80,zIndex:1e3,transition:n.transitions.create("all")},children:e.jsx(mt,{zoomLevel:B,onZoomChange:Q,onZoomIn:se,onZoomOut:Oe})})]})};export{Fn as default};
