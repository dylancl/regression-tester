import{u as Re,j as e,B as O,$ as yt,ab as ot,ak as Ct,a5 as st,d as V,I as Se,al as rt,S as Ne,a6 as He,a7 as Ue,a8 as Ae,f as _,aa as We,a3 as Xe,m as wt,am as Je,an as St,ao as vt,ap as jt,aq as kt,H as Lt,ar as Et,h as Mt,a as me,ah as Ft,as as zt,r as $e,at,w as Ot,au as Rt,ae as Tt,av as Dt,aw as It,ax as Pt,P as pt,ay as Ht,az as Ut,aA as At,aB as Wt,aC as Fe,aD as $t,aE as Bt,aF as Gt,aG as Nt,aH as Yt,aI as Zt,aJ as Xt,aK as mt,a9 as lt,b as _t,aL as Kt,F as Vt,e as qt,n as Qe,ai as et,U as Jt}from"./mui-Be33Q-K3.js";import{r as t,a as Qt}from"./vendor-By_F_pnL.js";import{g as Ge,c as ge,d as en}from"./index-9eOP6H1w.js";import{c as tn,a as nn,d as ct,F as on,D as sn,N as rn}from"./DeviceSizeMenu-ATQMBxAq.js";import{m as an,L as ln}from"./index-B5SzGSGr.js";import{A as dt}from"./index-BnnKfIRr.js";const cn=()=>{const[n,o]=t.useState([]),[g,p]=t.useState(null),[r,x]=t.useState(!0),[R,b]=t.useState(!1);t.useEffect(()=>{n.length===0&&P()},[]),t.useEffect(()=>{if(n.length>0){const c=n[0];tn({selectedOptions:c.selectedOptions,countryLanguageCode:c.countryLanguageCode})}},[n]);const P=()=>{const c=nn(),l=c?k(0,c.selectedOptions,c.countryLanguageCode):L(0),i=L(1);o([l,i])},k=(c,l,i)=>{const u=`frame-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,w=Ge(l,i),T=60;return{id:u,selectedOptions:{...l},countryLanguageCode:i,generatedUrl:w,iframeLoading:!0,customSized:!1,syncEnabled:!1,syncOptions:{environment:!0,component:!0,uscContext:!0,uscEnv:!0,brand:!0,variantBrand:!0,country:!0},position:{x:100+T*c,y:100+T*c}}},L=c=>{const l=`frame-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,i=Object.keys(ge)[0],u=Ge(ct,i),w=60;return{id:l,selectedOptions:{...ct},countryLanguageCode:i,generatedUrl:u,iframeLoading:!0,customSized:!1,syncEnabled:!1,syncOptions:{environment:!0,component:!0,uscContext:!0,uscEnv:!0,brand:!0,variantBrand:!0,country:!0},position:{x:100+w*c,y:100+w*c}}};t.useEffect(()=>{if(g){const c=setTimeout(()=>{p(null)},3e3);return()=>{clearTimeout(c)}}},[g]);const A=()=>{const c=L(n.length);o(l=>[...l,c])},B=(c,l)=>{o(i=>i.map(u=>u.id===c?{...u,position:l,customSized:!0}:u))},H=(c,l)=>{o(i=>{const u=[...i],w=u.findIndex(Y=>Y.id===c),T=u.findIndex(Y=>Y.id===l);if(w===-1||T===-1)return i;const[I]=u.splice(w,1);return u.splice(T,0,I),u})},E=c=>{if(n.length<=1){U("Cannot remove the last frame");return}o(l=>l.filter(i=>i.id!==c))},M=(c,l,i)=>{o(u=>{var s,d,h,D;const w=[...u],T=w.findIndex(C=>C.id===c);if(T===-1)return u;const I=w[T],Y={...I.selectedOptions,[l]:i},S=(s=ge[I.countryLanguageCode])==null?void 0:s.hasLexus,ue=(d=ge[I.countryLanguageCode])==null?void 0:d.hasStock,se=((h=ge[I.countryLanguageCode])==null?void 0:h.hasUsed)!==!1;l==="brand"&&i==="lexus"&&!S&&(U("Lexus is not available for this country"),Y.brand="toyota"),l==="uscContext"&&i==="stock"&&!ue&&(U("Stock Cars is not set up for this country"),Y.uscContext="used"),l==="uscContext"&&i==="used"&&!se&&(U("Used Cars is not available for this country"),Y.uscContext="stock");const he=Ge(Y,I.countryLanguageCode);return w[T]={...I,selectedOptions:Y,generatedUrl:he,iframeLoading:!0},(R||I.syncEnabled)&&(((D=I.syncOptions)==null?void 0:D[l])!==!1?(U(`Syncing ${l} to other frames`),w.forEach((v,G)=>{var Z,ee,re;if(G!==T){const De=(Z=ge[v.countryLanguageCode])==null?void 0:Z.hasLexus,ke=(ee=ge[v.countryLanguageCode])==null?void 0:ee.hasStock,J=((re=ge[v.countryLanguageCode])==null?void 0:re.hasUsed)!==!1;let N={...v.selectedOptions};l==="brand"&&i==="lexus"?N.brand=De?i:"toyota":l==="uscContext"&&i==="stock"?N.uscContext=ke?i:J?"used":"stock":l==="uscContext"&&i==="used"?N.uscContext=J?i:ke?"stock":"used":N[l]=i;const ae=Ge(N,v.countryLanguageCode);w[G]={...v,selectedOptions:N,generatedUrl:ae,iframeLoading:!0}}})):U(`Sync for "${l}" is disabled in settings`)),w})},m=(c,l)=>{o(i=>{var S;const u=[...i],w=u.findIndex(ue=>ue.id===c);if(w===-1)return i;const T=u[w],I=Ge(T.selectedOptions,l);return u[w]={...T,countryLanguageCode:l,generatedUrl:I,iframeLoading:!0},(R||T.syncEnabled)&&(((S=T.syncOptions)==null?void 0:S.country)!==!1?(U("Syncing country to other frames"),u.forEach((se,he)=>{if(he!==w){const fe=Ge(se.selectedOptions,l);u[he]={...se,countryLanguageCode:l,generatedUrl:fe,iframeLoading:!0}}})):U("Country sync is disabled in settings")),u})},j=async c=>{try{await navigator.clipboard.writeText(c),U("URL copied to clipboard")}catch{U("Failed to copy URL")}},F=c=>{o(l=>l.map(i=>i.id===c?{...i,iframeLoading:!1}:i))},f=()=>{x(!r)},U=c=>{p(c)};return{frames:n,notification:g,sidebarOpen:r,globalSyncEnabled:R,addNewFrame:A,removeFrame:E,handleOptionChange:M,changeCountry:m,copyUrlToClipboard:j,handleIframeLoad:F,toggleSidebar:f,showNotification:U,reorderFrames:H,markFrameAsCustomSized:c=>{o(l=>l.map(i=>i.id===c?{...i,customSized:!0}:i))},resetFrameCustomSize:c=>{o(l=>l.map(i=>i.id===c?{...i,customSized:!1}:i))},updateFramePosition:B,toggleFrameSync:c=>{var w;const l=n.find(T=>T.id===c);if(!l)return;const i=!l.syncEnabled;o(T=>T.map(I=>I.id===c?{...I,syncEnabled:i}:I));const u=((w=ge[l.countryLanguageCode])==null?void 0:w.pretty)||"Frame";U(i?`Frame sync enabled for ${u}`:`Frame sync disabled for ${u}`)},toggleGlobalSync:()=>{const c=!R;b(c),U(c?"Global sync enabled":"Global sync disabled")},updateFrameSyncOptions:(c,l,i)=>{o(u=>u.map(w=>w.id===c?{...w,syncOptions:{...w.syncOptions||{},[l]:i}}:w)),U(`${i?"Enabled":"Disabled"} syncing ${l}`)},refreshFrame:c=>{const l=n.find(i=>i.id===c);if(l){const i=Date.now(),u=l.generatedUrl.includes("?")?"&":"?",w=`${l.generatedUrl}${u}_t=${i}`;o(T=>T.map(I=>I.id===c?{...I,generatedUrl:w,iframeLoading:!0}:I)),U("Reloading frame...")}}}},Ke=200,tt=400,nt=800,je=800,le=100,ut=15,dn=16,Ve=20,qe=(n,o)=>Math.round(n/o)*o,un={n:"ns-resize",s:"ns-resize",e:"ew-resize",w:"ew-resize",ne:"nesw-resize",nw:"nwse-resize",se:"nwse-resize",sw:"nesw-resize"},hn=n=>un[n]||"default",pn=({frames:n,onUpdateFramePosition:o,onMarkFrameAsCustomSized:g,snapToGrid:p=!1})=>{const[r,x]=t.useState({}),[R,b]=t.useState(null),[P,k]=t.useState(null),[L,A]=t.useState(null),[B,H]=t.useState(null),[E,M]=t.useState(!1),[m,j]=t.useState(null),[F,f]=t.useState(new Set),[U,Te]=t.useState(p),q=t.useRef(null),ce=t.useRef({}),de=t.useRef(""),oe=t.useRef(null),xe=t.useRef({x:0,y:0}),c=t.useRef({}),l=t.useRef(null),i=t.useCallback(()=>{Object.keys(c.current).length!==0&&(x(s=>({...s,...c.current})),c.current={},l.current=null)},[]),u=t.useCallback((s,d)=>{c.current[s]={...r[s]||{width:je,height:je,maxHeight:!1},...d},l.current!==null&&window.cancelAnimationFrame(l.current),l.current=window.requestAnimationFrame(i)},[r,i]);t.useEffect(()=>()=>{l.current!==null&&window.cancelAnimationFrame(l.current)},[]),t.useEffect(()=>{const s=q.current;if(!s)return;const d=requestAnimationFrame(()=>{let h=0,D=0;n.forEach(C=>{const v=r[C.id],G=(v==null?void 0:v.position)||C.position||{x:0,y:0};v&&(h=Math.max(h,G.x+v.width),D=Math.max(D,G.y+v.height))}),s.style.minWidth=`${h+Ke}px`,s.style.minHeight=`${D+Ke}px`});return()=>cancelAnimationFrame(d)},[n,r]),t.useEffect(()=>{const s={};n.forEach(d=>{r[d.id]||(s[d.id]={height:je,width:je,maxHeight:!1,position:d.position})}),Object.keys(s).length>0&&x(d=>({...d,...s}))},[n,r]),t.useEffect(()=>{if(E||R)return;let s=null;const d=()=>{Object.entries(r).forEach(([h,D])=>{if(!D.position)return;const C=n.find(Z=>Z.id===h);if(!C)return;const v=C.position,G=D.position;((v==null?void 0:v.x)!==G.x||(v==null?void 0:v.y)!==G.y)&&o(h,G)})};return s=window.setTimeout(d,100),()=>{s&&window.clearTimeout(s)}},[r,E,R,n,o]);const w=t.useCallback((s,d)=>{let h=null;const D=()=>{var G;const v=(G=q.current)==null?void 0:G.parentElement;v&&(h&&window.clearInterval(h),h=window.setInterval(()=>{if(!s.current){C();return}const{horizontal:Z,vertical:ee}=d();Z!==0&&(v.scrollLeft+=Z*ut),ee!==0&&(v.scrollTop+=ee*ut)},dn))},C=()=>{h&&(window.clearInterval(h),h=null)};return{startAutoScroll:D,clearAutoScroll:C}},[]),T=t.useCallback((s,d,h,D)=>{const C=q.current;if(!C)return;const v=parseInt(C.style.minWidth||"0",10),G=parseInt(C.style.minHeight||"0",10),Z=s+h+Ke,ee=d+D+Ke;Z>v&&(C.style.minWidth=`${Z}px`),ee>G&&(C.style.minHeight=`${ee}px`)},[]),I=t.useCallback(s=>U?{x:qe(s.x,Ve),y:qe(s.y,Ve)}:s,[U]),Y=t.useCallback(s=>U?{width:Math.max(tt,qe(s.width,Ve)),height:Math.max(nt,qe(s.height,Ve))}:s,[U]),S=t.useCallback((s,d)=>{if(s.preventDefault(),s.stopPropagation(),!s.target.closest(".frame-drag-handle"))return;M(!0),j(d);const h=ce.current[d],D=q.current;if(!h||!D)return;const C=s.target.closest(".frame-drag-handle"),v=h.getBoundingClientRect(),G=D.getBoundingClientRect(),Z=window.getComputedStyle(D).transform,re=new DOMMatrix(Z).a||1,De=s.clientX,ke=s.clientY,J=v.left-G.left+D.scrollLeft,N=v.top-G.top+D.scrollTop,ne=(r[d]||{width:v.width,height:v.height,position:{x:J,y:N}}).position||{x:J,y:N};u(d,{position:ne}),g(d);const be={current:!0};de.current=document.body.style.cursor,document.body.style.cursor="grabbing",C&&C.requestPointerLock();let ve=0,ye=0,Ce=performance.now(),Le={x:ne.x,y:ne.y};const Ye=()=>{const W=D.parentElement;if(!W)return{horizontal:0,vertical:0};const X=W.getBoundingClientRect(),pe=xe.current.x,y=xe.current.y;let $=0,a=0;return pe>X.right-le?$=1:pe<X.left+le&&($=-1),y>X.bottom-le?a=1:y<X.top+le&&(a=-1),{horizontal:$,vertical:a}},{startAutoScroll:Ze,clearAutoScroll:Be}=w(be,Ye),Ee=W=>{var Me,it;if(!be.current)return;W.preventDefault(),W.stopPropagation(),xe.current={x:W.clientX,y:W.clientY};let X,pe;document.pointerLockElement===C?(ve+=W.movementX,ye+=W.movementY,X=ve/re,pe=ye/re):(X=(W.clientX-De)/re,pe=(W.clientY-ke)/re);let y=Math.max(0,ne.x+X),a=Math.max(60,ne.y+pe);const z=I({x:y,y:a});y=z.x,a=z.y;const K=performance.now();(K-Ce>16||Math.abs(y-Le.x)>10||Math.abs(a-Le.y)>10)&&(u(d,{position:{x:y,y:a}}),Ce=K,Le={x:y,y:a});const Q=D.parentElement;if(Q){const _e=Q.getBoundingClientRect();(W.clientX>_e.right-le||W.clientX<_e.left+le||W.clientY>_e.bottom-le||W.clientY<_e.top+le)&&Ze()}const te=((Me=r[d])==null?void 0:Me.width)||je,we=((it=r[d])==null?void 0:it.height)||je;T(y,a,te,we)},ie=()=>{var X;be.current=!1,M(!1),j(null),document.pointerLockElement===C&&document.exitPointerLock(),i();const W=((X=r[d])==null?void 0:X.position)||Le;o(d,W),Be(),document.body.style.cursor=de.current,document.removeEventListener("mousemove",Ee),document.removeEventListener("mouseup",ie),document.removeEventListener("mouseleave",Ie),document.removeEventListener("pointerlockchange",Pe)},Ie=W=>{var X;document.pointerLockElement!==C&&(W!=null&&W.target)&&((X=W.target)==null?void 0:X.nodeName)==="HTML"&&ie()},Pe=()=>{document.pointerLockElement!==C&&be.current&&ie()};document.addEventListener("mousemove",Ee),document.addEventListener("mouseup",ie),document.addEventListener("mouseleave",Ie),document.addEventListener("pointerlockchange",Pe)},[r,I,w,T,u,i,g,o]),ue=t.useCallback((s,d,h)=>{var W,X,pe;s.preventDefault(),s.stopPropagation(),b(d),k(h),j(d);const D=ce.current[d],C=q.current;if(!D||!C)return;oe.current=s.target;const v=window.getComputedStyle(C).transform,Z=new DOMMatrix(v).a||1,ee=D.getBoundingClientRect(),re=C.getBoundingClientRect(),De=s.clientX,ke=s.clientY,J=((W=r[d])==null?void 0:W.width)||ee.width,N=((X=r[d])==null?void 0:X.height)||ee.height,ae=((pe=r[d])==null?void 0:pe.position)||{x:ee.left-re.left+C.scrollLeft,y:ee.top-re.top+C.scrollTop};g(d);const ne={current:!0};de.current=document.body.style.cursor,document.body.style.cursor=hn(h),oe.current&&oe.current.requestPointerLock();let be=0,ve=0,ye=performance.now(),Ce={x:ae.x,y:ae.y,width:J,height:N};const Le=()=>{const y=C.parentElement;if(!y)return{horizontal:0,vertical:0};const{x:$,y:a,width:z,height:K}=Be();let Q=0,te=0;return h.includes("e")&&$+z>y.scrollLeft+y.clientWidth-le?Q=1:h.includes("w")&&$<y.scrollLeft+le&&(Q=-1),h.includes("s")&&a+K>y.scrollTop+y.clientHeight-le?te=1:h.includes("n")&&a<y.scrollTop+le&&(te=-1),{horizontal:Q,vertical:te}},{startAutoScroll:Ye,clearAutoScroll:Ze}=w(ne,Le),Be=()=>{let y=J,$=N,a=ae.x,z=ae.y;const K=be/Z,Q=ve/Z;if(h.includes("e")&&(y=Math.max(tt,J+K)),h.includes("w")){const te=Math.max(tt,J-K);y=te,a=ae.x+(J-te)}if(h.includes("s")&&($=Math.max(nt,N+Q)),h.includes("n")){const we=Math.max(nt,N-Q);$=we;const Me=ae.y+(N-we);z=Math.max(60,Me),z>Me&&($=N-(z-ae.y)*Z)}if(U){const te=I({x:a,y:z});a=te.x,z=te.y;const we=Y({width:y,height:$});y=we.width,$=we.height}return{x:a,y:z,width:y,height:$}},Ee=y=>{if(!ne.current)return;y.preventDefault(),y.stopPropagation(),document.pointerLockElement===oe.current?(be+=y.movementX,ve+=y.movementY):(be=y.clientX-De,ve=y.clientY-ke);const{x:$,y:a,width:z,height:K}=Be(),Q=performance.now();(Q-ye>16||Math.abs(z-Ce.width)>5||Math.abs(K-Ce.height)>5||Math.abs($-Ce.x)>5||Math.abs(a-Ce.y)>5)&&(u(d,{width:z,height:K,position:{x:$,y:a},maxHeight:!1}),ye=Q,Ce={x:$,y:a,width:z,height:K}),Ye(),T($,a,z,K)},ie=()=>{ne.current=!1,document.pointerLockElement===oe.current&&document.exitPointerLock(),i();const y=r[d];y!=null&&y.position&&o(d,y.position),b(null),k(null),j(null),Ze(),document.body.style.cursor=de.current,document.removeEventListener("mousemove",Ee),document.removeEventListener("mouseup",ie),document.removeEventListener("mouseleave",Ie),document.removeEventListener("pointerlockchange",Pe)},Ie=y=>{var $;document.pointerLockElement!==oe.current&&(y!=null&&y.target)&&(($=y.target)==null?void 0:$.nodeName)==="HTML"&&ie()},Pe=()=>{document.pointerLockElement!==oe.current&&ne.current&&ie()};document.addEventListener("mousemove",Ee),document.addEventListener("mouseup",ie),document.addEventListener("mouseleave",Ie),document.addEventListener("pointerlockchange",Pe)},[r,I,Y,w,T,u,i,g,o,U]),se=t.useCallback(s=>{x(d=>{const h=d[s];if(!h)return d;const D=h.maxHeight?je:window.innerHeight-180,C={...h,height:D,maxHeight:!h.maxHeight};return g(s),C.position&&o(s,C.position),{...d,[s]:C}})},[g,o]),he=t.useCallback((s,d=je,h=je)=>{x(D=>{var v;const C=(v=D[s])==null?void 0:v.position;return{...D,[s]:{height:h,width:d,maxHeight:!1,position:C}}})},[]),fe=t.useCallback(s=>{f(d=>{const h=new Set(d);return h.has(s)?h.delete(s):h.add(s),h})},[]);return{frameLayouts:r,resizingFrameId:R,resizeDirection:P,draggedFrameId:L,dragOverFrameId:B,draggingFrame:E,activeFrameId:m,frameRefs:ce,framesContainerRef:q,expandedConfigFrames:F,handleFrameMoveStart:S,handleMultiDirectionResize:ue,toggleMaximizeHeight:se,resetFrameSize:he,toggleConfigPanel:fe,setActiveFrameId:j,setResizingFrameId:b,setResizeDirection:k,setDraggedFrameId:A,setDragOverFrameId:H,snapToGrid:U,setSnapToGrid:Te}},mn=n=>{const[o,g]=t.useState(100),[p,r]=t.useState(!1),{containerRef:x,controlsHideDelay:R=2e3}=n||{},b=t.useRef(null),P=()=>{b.current!==null&&(window.clearTimeout(b.current),b.current=null)},k=t.useCallback(()=>{P(),b.current=window.setTimeout(()=>{r(!1)},R)},[R]),L=t.useCallback((E,M)=>{g(M)},[]),A=t.useCallback(()=>{g(E=>Math.min(E+10,200)),r(!0),k()},[k]),B=t.useCallback(()=>{g(E=>Math.max(E-10,50)),r(!0),k()},[k]),H=t.useCallback(()=>{r(E=>(E||P(),!E))},[]);return t.useEffect(()=>{const E=(x==null?void 0:x.current)||window,M=m=>{const j=m;(j.ctrlKey||j.metaKey)&&(j.preventDefault(),r(!0),j.deltaY<0?g(F=>Math.min(F+5,200)):g(F=>Math.max(F-5,50)),k())};return E.addEventListener("wheel",M,{passive:!1}),()=>{E.removeEventListener("wheel",M),P()}},[x,k]),t.useEffect(()=>()=>{P()},[]),{zoomLevel:o,showZoomControls:p,handleZoomChange:L,handleZoomIn:A,handleZoomOut:B,toggleZoomControls:H,setShowZoomControls:r}},gn=({parentRef:n})=>{const[o,g]=t.useState(!1),[p,r]=t.useState(!1),x=t.useRef({x:0,y:0}),R=t.useRef({left:0,top:0}),b=t.useRef(!1),P=t.useRef(""),k=t.useRef(new Map),L=t.useCallback(m=>{document.querySelectorAll("iframe").forEach(F=>{k.current.has(F)||k.current.set(F,F.style.pointerEvents||"auto"),F.style.pointerEvents=m})},[]),A=t.useCallback(()=>{k.current.forEach((m,j)=>{j.style.pointerEvents=m}),k.current.clear()},[]);t.useEffect(()=>{P.current=document.documentElement.style.overflow;const m=F=>{if(F.key===" "||F.code==="Space")return F.preventDefault(),F.stopPropagation(),F.stopImmediatePropagation(),F.type==="keydown"&&!F.repeat&&!b.current&&(b.current=!0,r(!0),document.body.style.cursor="grab",document.documentElement.style.overflow="hidden",L("none")),F.type==="keyup"&&(b.current=!1,r(!1),document.body.style.cursor="",document.documentElement.style.overflow=P.current,L("auto"),A(),E()),!1},j=F=>{if(b.current)return F.preventDefault(),F.stopPropagation(),!1};return document.addEventListener("keydown",m,{capture:!0,passive:!1}),document.addEventListener("keypress",m,{capture:!0,passive:!1}),document.addEventListener("keyup",m,{capture:!0,passive:!1}),document.addEventListener("scroll",j,{capture:!0,passive:!1}),document.addEventListener("wheel",j,{capture:!0,passive:!1}),document.addEventListener("focusin",()=>{b.current&&(document.documentElement.style.overflow="hidden",L("none"))},{capture:!0}),window.addEventListener("blur",()=>{b.current&&(b.current=!1,r(!1),document.body.style.cursor="",document.documentElement.style.overflow=P.current,A(),E())}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("keypress",m,{capture:!0}),document.removeEventListener("keyup",m,{capture:!0}),document.removeEventListener("scroll",j,{capture:!0}),document.removeEventListener("wheel",j,{capture:!0}),document.documentElement.style.overflow=P.current,document.body.style.cursor="",A()}},[L,A]);const B=t.useCallback(m=>{if(!o||!n.current)return;m.preventDefault(),m.stopPropagation();const j=m.clientX-x.current.x,F=m.clientY-x.current.y;n.current.scrollLeft=R.current.left-j,n.current.scrollTop=R.current.top-F,document.body.style.cursor="grabbing"},[o,n]);t.useEffect(()=>{if(o)return document.addEventListener("mousemove",B,{passive:!1}),document.addEventListener("mouseup",E),()=>{document.removeEventListener("mousemove",B),document.removeEventListener("mouseup",E)}},[o,B]);const H=t.useCallback(m=>{!p||!n.current||(m.preventDefault(),m.stopPropagation(),g(!0),x.current={x:m.clientX,y:m.clientY},R.current={left:n.current.scrollLeft,top:n.current.scrollTop},document.body.style.cursor="grabbing",L("none"))},[p,n,L]),E=t.useCallback(()=>{g(!1),document.body.style.cursor=b.current?"grab":"",b.current||A()},[A]),M=t.useCallback(()=>{r(m=>!m)},[]);return{isPanning:o,isPanningEnabled:p,startPanning:H,stopPanning:E,togglePanningMode:M}},ze={position:"absolute",width:20,height:20,zIndex:100,display:"flex",justifyContent:"center",alignItems:"center",transition:"background-color 0.2s ease"},Oe={width:10,height:10,borderRadius:"50%",backgroundColor:"currentColor",transition:"transform 0.2s ease, background-color 0.2s ease, box-shadow 0.2s ease",boxShadow:"0 0 0 2px rgba(255, 255, 255, 0.5), 0 0 0 1px rgba(0, 0, 0, 0.2)","&:hover":{transform:"scale(1.5)",boxShadow:"0 0 0 2px rgba(255, 255, 255, 0.8), 0 0 0 1px rgba(0, 0, 0, 0.5)"}},xn=({frameId:n,onResize:o})=>{const g=Re(),r={color:g.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.5)","&::before":{content:'""',position:"absolute",width:"100%",height:"100%",borderRadius:"50%",backgroundColor:"rgba(255, 255, 255, 0.1)",zIndex:-1},"&:hover":{color:g.palette.primary.main,"&::before":{backgroundColor:"rgba(255, 255, 255, 0.3)"}}};return e.jsxs(e.Fragment,{children:[e.jsx(O,{sx:{...ze,top:0,left:0,cursor:"nwse-resize",...r},onMouseDown:x=>o(x,n,"nw"),children:e.jsx(O,{sx:Oe})}),e.jsx(O,{sx:{...ze,top:0,right:0,cursor:"nesw-resize",...r},onMouseDown:x=>o(x,n,"ne"),children:e.jsx(O,{sx:Oe})}),e.jsx(O,{sx:{...ze,bottom:0,left:0,cursor:"nesw-resize",...r},onMouseDown:x=>o(x,n,"sw"),children:e.jsx(O,{sx:Oe})}),e.jsx(O,{sx:{...ze,bottom:0,right:0,cursor:"nwse-resize",...r},onMouseDown:x=>o(x,n,"se"),children:e.jsx(O,{sx:Oe})}),e.jsx(O,{sx:{...ze,top:"50%",right:0,transform:"translateY(-50%)",cursor:"ew-resize",...r},onMouseDown:x=>o(x,n,"e"),children:e.jsx(O,{sx:Oe})}),e.jsx(O,{sx:{...ze,top:"50%",left:0,transform:"translateY(-50%)",cursor:"ew-resize",...r},onMouseDown:x=>o(x,n,"w"),children:e.jsx(O,{sx:Oe})}),e.jsx(O,{sx:{...ze,top:0,left:"50%",transform:"translateX(-50%)",cursor:"ns-resize",...r},onMouseDown:x=>o(x,n,"n"),children:e.jsx(O,{sx:Oe})}),e.jsx(O,{sx:{...ze,bottom:0,left:"50%",transform:"translateX(-50%)",cursor:"ns-resize",...r},onMouseDown:x=>o(x,n,"s"),children:e.jsx(O,{sx:Oe})})]})},fn=({frame:n,onChangeCountry:o,onOptionChange:g})=>{const p=Re(),[r,x]=t.useState(null),R=!!r,b=ge[n.countryLanguageCode]||{},P=b.hasLexus||!1,k=b.hasStock||!1,L=b.hasUsed!==!1,A=M=>{x(M.currentTarget)},B=()=>{x(null)},H=M=>{const m=M.target.name,j=M.target.value;g(n.id,m,j)},E=M=>{o(n.id,M)};return e.jsxs(e.Fragment,{children:[e.jsx(yt,{size:"small",color:"default","aria-label":"configuration options",onClick:A,sx:{position:"absolute",bottom:16,right:16,bgcolor:R?p.palette.primary.main:p.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.4)",color:R?"#fff":p.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)","&:hover":{bgcolor:p.palette.primary.main,color:"#fff"},transition:"background-color 0.3s, color 0.3s, opacity 0.3s",boxShadow:R?p.shadows[8]:"none",backdropFilter:"blur(4px)",opacity:R?1:.7,zIndex:100},children:e.jsx(ot,{})}),e.jsxs(Ct,{open:R,anchorEl:r,onClose:B,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"right"},slots:{transition:st},slotProps:{transition:{timeout:{enter:200,exit:200}},paper:{elevation:4,sx:{borderRadius:2,bgcolor:p.palette.background.paper,maxWidth:380,width:"100%",overflow:"hidden",backdropFilter:"blur(8px)"}}},children:[e.jsxs(O,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:2,borderBottom:`1px solid ${p.palette.divider}`,bgcolor:p.palette.mode==="dark"?"rgba(66, 66, 66, 0.2)":"rgba(248, 248, 248, 0.8)"},children:[e.jsx(V,{variant:"subtitle1",fontWeight:"medium",color:"primary",children:"Frame Configuration"}),e.jsx(Se,{size:"small",onClick:B,children:e.jsx(rt,{fontSize:"small"})})]}),e.jsx(O,{sx:{p:2,maxHeight:"40rem",overflowY:"auto",scrollbarWidth:"thin","&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-track":{background:p.palette.background.default},"&::-webkit-scrollbar-thumb":{backgroundColor:p.palette.divider,borderRadius:"4px"}},children:e.jsxs(Ne,{spacing:2.5,children:[e.jsxs(O,{sx:{backgroundColor:p.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.9)",p:1.5,borderRadius:1,boxShadow:p.shadows[1]},children:[e.jsx(V,{variant:"subtitle2",color:"primary",gutterBottom:!0,fontWeight:"medium",children:"Country"}),e.jsxs(He,{fullWidth:!0,size:"small",children:[e.jsx(Ue,{id:"country-label",children:"Country"}),e.jsx(Ae,{labelId:"country-label",id:"country",value:n.countryLanguageCode,label:"Country",onChange:M=>E(M.target.value),MenuProps:{PaperProps:{style:{maxHeight:300}}},children:Object.entries(ge).map(([M,m])=>e.jsxs(_,{value:M,children:[m.pretty," (",M,")"]},M))}),e.jsx(We,{children:"Use the dropdown to change country"})]})]}),e.jsx(Xe,{}),e.jsxs(O,{sx:{backgroundColor:p.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.9)",p:1.5,borderRadius:1,boxShadow:p.shadows[1]},children:[e.jsx(V,{variant:"subtitle2",color:"primary",gutterBottom:!0,fontWeight:"medium",children:"Environment"}),e.jsxs(Ne,{spacing:1.5,children:[e.jsxs(He,{fullWidth:!0,size:"small",children:[e.jsx(Ue,{id:"environment-label",children:"Deployment Environment"}),e.jsxs(Ae,{labelId:"environment-label",id:"environment",name:"environment",value:n.selectedOptions.environment||"prev",label:"Deployment Environment",onChange:H,children:[e.jsx(_,{value:"localhost",children:"Localhost"}),e.jsx(_,{value:"dev",children:"Development"}),e.jsx(_,{value:"acc",children:"Acceptance"}),e.jsx(_,{value:"prev",children:"Preview"}),e.jsx(_,{value:"prod",children:"Production"})]}),e.jsx(We,{children:"Select the deployment environment"})]}),e.jsxs(He,{fullWidth:!0,size:"small",children:[e.jsx(Ue,{id:"usc-env-label",children:"USC Environment"}),e.jsxs(Ae,{labelId:"usc-env-label",id:"uscEnv",name:"uscEnv",value:n.selectedOptions.uscEnv||"uat",label:"USC Environment",onChange:H,children:[e.jsx(_,{value:"uat",children:"UAT"}),e.jsx(_,{value:"production",children:"Production"})]}),e.jsx(We,{children:"Backend environment"})]})]})]}),e.jsx(Xe,{}),e.jsxs(O,{sx:{backgroundColor:p.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.9)",p:1.5,borderRadius:1,boxShadow:p.shadows[1]},children:[e.jsx(V,{variant:"subtitle2",color:"primary",gutterBottom:!0,fontWeight:"medium",children:"Component"}),e.jsxs(He,{fullWidth:!0,size:"small",children:[e.jsx(Ue,{id:"component-label",children:"Component"}),e.jsx(Ae,{labelId:"component-label",id:"component",name:"component",value:n.selectedOptions.component||"car-filter",label:"Component",onChange:H,children:Object.entries(en).map(([M,{title:m,description:j}])=>e.jsxs(_,{value:M,sx:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[m,e.jsx(O,{sx:{fontSize:"0.8em",color:"text.secondary"},children:j})]},M))}),e.jsx(We,{children:"Select the component to test"})]})]}),e.jsx(Xe,{}),e.jsxs(O,{sx:{backgroundColor:p.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.9)",p:1.5,borderRadius:1,boxShadow:p.shadows[1]},children:[e.jsx(V,{variant:"subtitle2",color:"primary",gutterBottom:!0,fontWeight:"medium",children:"USC Context"}),e.jsxs(He,{fullWidth:!0,size:"small",children:[e.jsx(Ue,{id:"usc-context-label",children:"USC Context"}),e.jsxs(Ae,{labelId:"usc-context-label",id:"uscContext",name:"uscContext",value:n.selectedOptions.uscContext||"used",label:"USC Context",onChange:H,disabled:n.selectedOptions.component==="used-stock-cars-pdf",children:[e.jsxs(_,{value:"used",disabled:!L,children:["Used ",!L&&"(Not Available)"]}),e.jsxs(_,{value:"stock",disabled:!k,children:["Stock ",!k&&"(Not Available)"]})]}),e.jsx(We,{children:!k&&n.selectedOptions.uscContext==="used"?"Stock is not available for this country":!L&&n.selectedOptions.uscContext==="stock"?"Used is not available for this country":"Used or Stock cars"})]})]}),e.jsx(Xe,{}),e.jsxs(O,{sx:{backgroundColor:p.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.9)",p:1.5,borderRadius:1,boxShadow:p.shadows[1]},children:[e.jsx(V,{variant:"subtitle2",color:"primary",gutterBottom:!0,fontWeight:"medium",children:"Brand Settings"}),e.jsxs(Ne,{spacing:1.5,children:[e.jsxs(He,{fullWidth:!0,size:"small",children:[e.jsx(Ue,{id:"brand-label",children:"Brand"}),e.jsxs(Ae,{labelId:"brand-label",id:"brand",name:"brand",value:n.selectedOptions.brand||"toyota",label:"Brand",onChange:H,children:[e.jsx(_,{value:"toyota",children:"Toyota"}),e.jsxs(_,{value:"lexus",disabled:!P,children:["Lexus ",!P&&"(Not Available)"]})]}),e.jsx(We,{children:!P&&n.selectedOptions.brand==="toyota"?"Lexus is not available for this country":"Brand selection"})]}),e.jsxs(He,{fullWidth:!0,size:"small",children:[e.jsx(Ue,{id:"variant-brand-label",children:"Variant Brand"}),e.jsxs(Ae,{labelId:"variant-brand-label",id:"variantBrand",name:"variantBrand",value:n.selectedOptions.variantBrand||"toyota",label:"Variant Brand",onChange:H,children:[e.jsx(_,{value:"toyota",children:"Toyota"}),e.jsx(_,{value:"lexus",children:"Lexus"})]}),e.jsx(We,{children:"Variant brand for the component"})]})]})]})]})})]})]})},ht=[{key:"environment",label:"Environment",description:"Deployment environment (dev, acc, prev, prod)"},{key:"component",label:"Component",description:"Component type (car-filter, used-stock-cars, etc.)"},{key:"uscContext",label:"USC Context",description:"Used or Stock vehicles context"},{key:"uscEnv",label:"USC Environment",description:"Backend environment (UAT, Production)"},{key:"brand",label:"Brand",description:"Main brand (Toyota, Lexus)"},{key:"variantBrand",label:"Variant Brand",description:"Variant brand displayed in components"},{key:"country",label:"Country",description:"Country and language selection"}],bn=({open:n,onClose:o,frame:g,onUpdateSyncOption:p})=>{const r=Re(),x={environment:!0,component:!0,uscContext:!0,uscEnv:!0,brand:!0,variantBrand:!0,country:!0},R=g.syncOptions||x,b=k=>L=>{p(g.id,k,L.target.checked)},P=ht.reduce((k,L,A)=>(k.push(e.jsx(wt,{secondaryAction:e.jsx(St,{edge:"end",onChange:b(L.key),checked:R[L.key],color:"primary"}),children:e.jsx(Je,{primary:L.label,secondary:L.description,primaryTypographyProps:{fontWeight:500}})},L.key)),A<ht.length-1&&k.push(e.jsx(Xe,{variant:"inset",component:"li"},`divider-${L.key}`)),k),[]);return e.jsxs(vt,{open:n,onClose:o,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[e.jsxs(jt,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:r.palette.mode==="dark"?"rgba(66, 66, 66, 0.2)":"rgba(248, 248, 248, 0.8)",borderBottom:`1px solid ${r.palette.divider}`,p:2},children:[e.jsxs(O,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ot,{color:"primary",sx:{mr:1}}),e.jsx(V,{variant:"h6",component:"div",children:"Sync Configuration Settings"})]}),e.jsx(Se,{onClick:o,size:"small",children:e.jsx(rt,{fontSize:"small"})})]}),e.jsxs(kt,{children:[e.jsx(V,{variant:"body2",color:"text.secondary",component:"p",sx:{mt:2},children:"Choose which settings should be synchronized between frames when sync is enabled. Disabled settings will remain independent for each frame."}),e.jsx(Lt,{sx:{pt:2},children:P})]}),e.jsx(Et,{sx:{p:2,backgroundColor:r.palette.mode==="dark"?"rgba(66, 66, 66, 0.2)":"rgba(248, 248, 248, 0.8)",borderTop:`1px solid ${r.palette.divider}`},children:e.jsx(Mt,{onClick:o,color:"primary",children:"Close"})})]})},gt=t.memo(({frame:n,layout:o,isActive:g,isDragging:p,isResizing:r,isDraggedOver:x,globalSyncEnabled:R,onMove:b,onResize:P,onRemove:k,onCopyUrl:L,onMenuOpen:A,onToggleSync:B,onIframeLoad:H,onOptionChange:E,onChangeCountry:M,onShowNotification:m,onUpdateSyncOption:j,onReload:F})=>{var fe;const f=Re(),U=t.useRef(null),[Te,q]=t.useState(!1),[ce,de]=t.useState(!1),[oe,xe]=t.useState(!1);t.useEffect(()=>{let s=null;return ce&&!p&&!r?s=window.setTimeout(()=>xe(!0),150):s=window.setTimeout(()=>xe(!1),100),()=>{s!==null&&clearTimeout(s)}},[ce,p,r,g]);const c=()=>{},l=()=>{},i=()=>q(!0),u=()=>q(!1),w=((fe=ge[n.countryLanguageCode])==null?void 0:fe.pretty)||"Frame",T=t.useMemo(()=>p?"frame-dragging":r?"frame-resizing":x?"frame-drag-over":g?"frame-active":"",[p,r,x,g]),I=t.useMemo(()=>({height:o.height||400,display:"flex",flexDirection:"column",overflow:"hidden",transition:r||p?"none":f.transitions.create(["box-shadow","transform"],{duration:200}),transform:x?"scale(1.01)":"scale(1)",position:"relative",boxShadow:g?f.shadows[12]:ce?f.shadows[6]:f.shadows[3],border:`1px solid ${g?f.palette.primary.main:x?me(f.palette.primary.main,.5):f.palette.divider}`,"&:hover":{boxShadow:f.shadows[8]},"&::before":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,opacity:.03,pointerEvents:"none",backgroundImage:`radial-gradient(${f.palette.primary.light} 1px, transparent 1px)`,backgroundSize:"20px 20px",zIndex:0},backgroundColor:f.palette.background.paper}),[o.height,r,p,g,ce,x,f]),Y=t.useMemo(()=>({p:1,bgcolor:f.palette.mode==="dark"?me(f.palette.background.paper,.7):me(f.palette.background.paper,.85),backdropFilter:"blur(8px)",borderBottom:`1px solid ${f.palette.divider}`,display:"flex",alignItems:"center",justifyContent:"space-between",minHeight:"48px",position:"relative",zIndex:10,"&:hover":{backgroundColor:f.palette.mode==="dark"?me(f.palette.background.default,.8):me(f.palette.background.paper,.95)}}),[f]),S=t.useMemo(()=>({display:"flex",alignItems:"center",flex:1,cursor:"move",borderRadius:"4px",py:.5,pl:.5,pr:1,transition:"background-color 0.2s ease",".MuiSvgIcon-root":{transition:"transform 0.2s ease"},"&:hover .MuiSvgIcon-root":{transform:"scale(1.1)"}}),[]),ue=t.useMemo(()=>e.jsx(Ft,{size:"small",variant:"outlined",label:`${Math.round(o.width)||400}×${Math.round(o.height)||400}`,sx:{height:"22px",fontSize:"0.7rem",borderRadius:"4px",fontFamily:"monospace",fontWeight:"medium",bgcolor:me(f.palette.background.default,.7),backdropFilter:"blur(4px)",borderColor:f.palette.divider,color:f.palette.text.secondary,ml:1,"& .MuiChip-label":{px:.75}}}),[o.width,o.height,f]),se=t.useMemo(()=>{const s=o.width||400,d=[];return s>=220&&d.push("reload"),s>=280&&d.push("sync"),s>=350&&d.push("copy"),s>=420&&d.push("syncOptions"),d},[o.width]),he=t.useMemo(()=>oe||g,[oe,g]);return e.jsxs(zt,{elevation:0,sx:I,className:`frame ${T}`,onMouseEnter:()=>!p&&!r&&de(!0),onMouseLeave:()=>de(!1),children:[e.jsxs(O,{sx:Y,children:[e.jsxs(O,{className:"frame-drag-handle",sx:S,onMouseDown:s=>b(s,n.id),children:[e.jsx($e,{title:"Drag to move frame",children:e.jsx(at,{fontSize:"small",sx:{mr:1,color:f.palette.primary.main,opacity:.7}})}),e.jsx(on,{selectedOptions:n.selectedOptions,countryLanguageCode:n.countryLanguageCode,maxWidth:o.width?Math.max(60,o.width-260):120}),o.width>280&&ue]}),e.jsxs(Ne,{direction:"row",spacing:.5,sx:{ml:"auto","& .MuiButtonBase-root":{color:f.palette.text.secondary},minWidth:"72px",justifyContent:"flex-end"},children:[e.jsx(dt,{initial:!1,onExitComplete:c,children:he&&e.jsx(an.div,{initial:{opacity:0,width:0},animate:{opacity:1,width:"auto",transition:{duration:.2,ease:"easeOut"}},exit:{opacity:0,width:0,transition:{duration:.15,ease:"easeIn"}},onAnimationStart:l,onAnimationComplete:c,style:{display:"flex",overflow:"hidden"},children:e.jsxs(Ot,{variant:"text",size:"small",sx:{display:"flex",alignItems:"center",backgroundColor:me(f.palette.background.paper,1),backdropFilter:"blur(8px)",border:`1px solid ${f.palette.divider}`,borderColor:g?f.palette.primary.main:f.palette.divider,boxShadow:f.shadows[2],borderRadius:"4px",mr:.5,"& .MuiButtonGroup-grouped":{minWidth:"auto",px:.5}},children:[se.includes("reload")&&e.jsx($e,{title:"Reload frame",placement:"top",children:e.jsx(Se,{size:"small",onClick:()=>F(n.id),children:e.jsx(Rt,{fontSize:"small"})})}),se.includes("copy")&&e.jsx($e,{title:"Copy URL",placement:"top",children:e.jsx(Se,{size:"small",onClick:()=>L(n.generatedUrl),children:e.jsx(Tt,{fontSize:"small"})})}),se.includes("sync")&&e.jsx($e,{title:n.syncEnabled?"Disable config sync":"Enable config sync",placement:"top",children:e.jsx(Se,{size:"small",onClick:()=>B(n.id),color:n.syncEnabled||R?"primary":"default",disabled:R,children:n.syncEnabled?e.jsx(Dt,{fontSize:"small"}):e.jsx(It,{fontSize:"small"})})}),se.includes("syncOptions")&&e.jsx($e,{title:"Sync configuration options",placement:"top",children:e.jsx(Se,{size:"small",onClick:i,color:n.syncEnabled||R?"primary":"default",disabled:R,children:e.jsx(Pt,{fontSize:"small"})})})]})})}),e.jsx($e,{title:"Configure",placement:"top",children:e.jsx(Se,{size:"small",onClick:s=>A(s,n.id),sx:{bgcolor:me(f.palette.background.default,.5),"&:hover":{bgcolor:me(f.palette.background.default,.8)}},children:e.jsx(ot,{fontSize:"small"})})}),e.jsx($e,{title:"Remove frame",placement:"top",children:e.jsx(Se,{size:"small",color:"error",onClick:()=>k(n.id),sx:{bgcolor:me(f.palette.error.light,.1),"&:hover":{bgcolor:me(f.palette.error.light,.2)}},children:e.jsx(rt,{fontSize:"small"})})})]})]}),e.jsxs(O,{sx:{flex:1,position:"relative",minHeight:"360px",overflow:"hidden",bgcolor:f.palette.mode==="dark"?"#121212":"#fafafa"},children:[e.jsx(dt,{children:n.iframeLoading&&e.jsx(ln,{message:`Loading ${w}...`})}),e.jsx("iframe",{ref:U,src:n.generatedUrl,style:{border:"none",width:"100%",height:"100%",display:"block",backgroundColor:f.palette.mode==="dark"?"#1E1E1E":"#FFFFFF"},onLoad:()=>H(n.id),title:`Frame ${n.id}`}),e.jsx(fn,{frame:n,onChangeCountry:M,onOptionChange:E,onShowNotification:m})]}),e.jsx(xn,{frameId:n.id,onResize:P}),e.jsx(bn,{open:Te,onClose:u,frame:n,onUpdateSyncOption:j})]})});gt.displayName="Frame";const xt=Qt.memo(({zoomLevel:n,onZoomChange:o,onZoomIn:g,onZoomOut:p})=>e.jsx(pt,{elevation:3,sx:{p:2,width:240,borderRadius:2},children:e.jsxs(Ne,{spacing:2,children:[e.jsxs(V,{variant:"subtitle2",textAlign:"center",children:["Zoom Level: ",n,"%"]}),e.jsxs(Ne,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(Se,{onClick:p,size:"small",children:e.jsx(Ht,{})}),e.jsx(Ut,{value:n,onChange:o,min:50,max:200,step:5,valueLabelDisplay:"auto",valueLabelFormat:r=>`${r}%`}),e.jsx(Se,{onClick:g,size:"small",children:e.jsx(At,{})})]})]})}));xt.displayName="ZoomControls";const ft=t.memo(({open:n,onOpen:o,onClose:g,globalSyncEnabled:p,showGrid:r,snapToGrid:x,showZoomControls:R,isPanningEnabled:b,onAddFrame:P,onToggleGlobalSync:k,onToggleGrid:L,onToggleSnapToGrid:A,onToggleZoomControls:B,onTogglePanningMode:H,onSyncFrameSizes:E,onShowKeyboardShortcuts:M})=>{const m=Re(),j=f=>({bgcolor:f?m.palette.mode==="dark"?"#2c5282":"#e3f2fd":m.palette.mode==="dark"?"#333333":"#ffffff",color:f?m.palette.primary.main:"inherit","&:hover":{bgcolor:f?m.palette.mode==="dark"?"#3b6eb4":"#bbdefb":m.palette.mode==="dark"?"#444444":"#f5f5f5",transform:"scale(1.05)"},boxShadow:m.shadows[2]}),F={bgcolor:m.palette.mode==="dark"?"#333333":"#ffffff","&:hover":{bgcolor:m.palette.mode==="dark"?"#444444":"#f5f5f5",transform:"scale(1.05)"},boxShadow:m.shadows[2]};return e.jsxs(Wt,{ariaLabel:"Action controls",open:n,onOpen:o,onClose:g,sx:{position:"fixed",bottom:16,right:16,zIndex:1501,"& .MuiFab-primary":{bgcolor:m.palette.primary.main,"&:hover":{bgcolor:m.palette.primary.dark},transition:"all 0.3s ease"},"& .MuiSpeedDial-actions":{gap:.5}},icon:e.jsx(lt,{}),direction:"up",openIcon:e.jsx(lt,{}),FabProps:{sx:{boxShadow:m.shadows[4],"&:hover":{boxShadow:m.shadows[8],transform:"scale(1.05)"}}},children:[e.jsx(Fe,{icon:e.jsx($t,{}),tooltipTitle:"Add new frame",tooltipPlacement:"left",onClick:P,sx:F},"add-frame"),e.jsx(Fe,{icon:e.jsx(Bt,{}),tooltipTitle:p?"Disable global sync":"Enable global sync",tooltipPlacement:"left",onClick:k,sx:j(p)},"toggle-sync"),e.jsx(Fe,{icon:r?e.jsx(Gt,{}):e.jsx(Nt,{}),tooltipTitle:r?"Hide grid":"Show grid",tooltipPlacement:"left",onClick:L,sx:j(r)},"toggle-grid"),e.jsx(Fe,{icon:e.jsx(Yt,{}),tooltipTitle:x?"Disable snap to grid":"Enable snap to grid",tooltipPlacement:"left",onClick:A,sx:j(x)},"toggle-snap"),e.jsx(Fe,{icon:e.jsx(Zt,{}),tooltipTitle:"Zoom controls",tooltipPlacement:"left",onClick:B,sx:j(R)},"toggle-zoom"),e.jsx(Fe,{icon:e.jsx(Xt,{}),tooltipTitle:"Sync all frame sizes",tooltipPlacement:"left",onClick:E,sx:F},"sync-frame-sizes"),e.jsx(Fe,{icon:e.jsx(at,{}),tooltipTitle:b?"Disable panning mode":"Enable panning mode",tooltipPlacement:"left",onClick:H,sx:j(b)},"toggle-panning"),e.jsx(Fe,{icon:e.jsx(mt,{}),tooltipTitle:"Keyboard shortcuts",tooltipPlacement:"left",onClick:M,sx:F},"toggle-keyboard-shortcuts")]})});ft.displayName="ActionSpeedDial";const yn=({visible:n,onClose:o})=>{const g=Re();return n?e.jsx(st,{in:n,children:e.jsxs(pt,{elevation:3,sx:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"auto",minWidth:300,maxWidth:400,p:3,zIndex:1600,backdropFilter:"blur(5px)",backgroundColor:g.palette.mode==="dark"?"rgba(30, 30, 30, 0.9)":"rgba(255, 255, 255, 0.9)",borderRadius:2,border:`1px solid ${g.palette.divider}`},children:[e.jsxs(V,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(mt,{sx:{mr:1}})," Keyboard Shortcuts"]}),e.jsxs(O,{sx:{display:"grid",gridTemplateColumns:"auto 1fr",gap:2,alignItems:"center"},children:[e.jsx(V,{variant:"body2",fontWeight:"bold",children:"Space + Drag"}),e.jsx(V,{variant:"body2",children:"Pan around the canvas"}),e.jsx(V,{variant:"body2",fontWeight:"bold",children:"Ctrl + Scroll"}),e.jsx(V,{variant:"body2",children:"Zoom in/out"}),e.jsx(V,{variant:"body2",fontWeight:"bold",children:"Esc"}),e.jsx(V,{variant:"body2",children:"Close this panel"})]}),e.jsx(O,{sx:{display:"flex",justifyContent:"flex-end",mt:2},children:e.jsx(V,{variant:"body2",color:"primary",sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:o,children:"Close"})})]})}):null},bt=t.memo(({showGrid:n,zoomLevel:o,isPanningEnabled:g,onStartPanning:p,containerStyle:r,containerRef:x,children:R})=>{const b=Re(),P=t.useRef(null),k=x||P,L=20,A=t.useMemo(()=>L*(100/o),[L,o]),B=t.useMemo(()=>({backgroundSize:n?`${A}px ${A}px`:"initial",backgroundImage:n?`linear-gradient(to right, ${b.palette.divider} 1px, transparent 1px),
       linear-gradient(to bottom, ${b.palette.divider} 1px, transparent 1px)`:"none","&::after":n?{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,pointerEvents:"none",background:`radial-gradient(
        circle at center,
        transparent 30%,
        ${b.palette.background.default} 100%
      )`,zIndex:0}:{}}),[n,A,b.palette.divider,b.palette.background.default]),H=t.useMemo(()=>({display:"flex",flexWrap:"wrap",gap:2,position:"relative",transform:`scale(${o/100})`,transformOrigin:"top left",transition:"transform 0.2s ease",padding:o<100?`${(100-o)/2}px`:0,minWidth:`${1e4/o}%`,height:o<100?`${1e4/o*.01}%`:"auto",...B,...r}),[o,B,r]);return e.jsxs(e.Fragment,{children:[g&&e.jsx(st,{in:!0,children:e.jsxs(O,{sx:{position:"fixed",bottom:80,left:16,zIndex:1e3,backgroundColor:b.palette.mode==="dark"?"rgba(0,0,0,0.7)":"rgba(255,255,255,0.7)",backdropFilter:"blur(4px)",borderRadius:2,padding:1,display:"flex",alignItems:"center",boxShadow:b.shadows[3],border:`1px solid ${b.palette.divider}`},children:[e.jsx(at,{sx:{mr:1,color:b.palette.primary.main}}),e.jsxs(V,{variant:"body2",children:["Press ",e.jsx("b",{children:"Space + Drag"})," to pan"]})]})}),e.jsx(O,{ref:k,className:"frames-container",sx:H,onMouseDown:E=>{g&&(E.target===E.currentTarget||E.target.closest(".frames-container"))&&p(E)},children:R})]})});bt.displayName="FrameGridContainer";const En=()=>{var y,$;const n=Re(),o=_t(n.breakpoints.down("md")),[g,p]=t.useState(null),[r,x]=t.useState(!1),[R,b]=t.useState(!1),[P,k]=t.useState(!1),[L,A]=t.useState(null),B=t.useRef(null),{frames:H,notification:E,globalSyncEnabled:M,addNewFrame:m,removeFrame:j,handleOptionChange:F,changeCountry:f,copyUrlToClipboard:U,handleIframeLoad:Te,showNotification:q,markFrameAsCustomSized:ce,resetFrameCustomSize:de,updateFramePosition:oe,toggleFrameSync:xe,toggleGlobalSync:c,updateFrameSyncOptions:l,refreshFrame:i}=cn(),{frameLayouts:u,resizingFrameId:w,draggedFrameId:T,dragOverFrameId:I,draggingFrame:Y,activeFrameId:S,frameRefs:ue,framesContainerRef:se,expandedConfigFrames:he,handleFrameMoveStart:fe,handleMultiDirectionResize:s,toggleMaximizeHeight:d,resetFrameSize:h,setActiveFrameId:D,snapToGrid:C,setSnapToGrid:v}=pn({frames:H,onUpdateFramePosition:oe,onMarkFrameAsCustomSized:ce}),{zoomLevel:G,showZoomControls:Z,handleZoomChange:ee,handleZoomIn:re,handleZoomOut:De,toggleZoomControls:ke}=mn({containerRef:B}),{isPanning:J,isPanningEnabled:N,startPanning:ae,stopPanning:ne,togglePanningMode:be}=gn({parentRef:B});t.useEffect(()=>{const a=z=>{z.key==="Escape"&&P&&k(!1)};return document.addEventListener("keydown",a),()=>{document.removeEventListener("keydown",a)}},[P]),t.useEffect(()=>{const a=()=>{J&&ne()},z=()=>{J&&ne()};return document.addEventListener("mouseup",a),document.addEventListener("mouseleave",z),()=>{document.removeEventListener("mouseup",a),document.removeEventListener("mouseleave",z)}},[J,ne]);const ve=t.useCallback((a,z)=>{p(a.currentTarget),D(z)},[D]),ye=t.useCallback(()=>{p(null),D(null)},[D]),Ce=t.useCallback(a=>{A(a.currentTarget)},[]),Le=t.useCallback(()=>{A(null)},[]),Ye=t.useCallback((a,z)=>{S&&h(S,a,z)},[S,h]),Ze=t.useCallback(()=>{x(a=>!a)},[]),Be=t.useCallback(()=>{v(!C),q(C?"Snap to grid disabled":"Snap to grid enabled")},[C,v,q]),Ee=t.useCallback(()=>{k(a=>!a)},[]),ie=t.useCallback(a=>z=>{ue.current[a]=z},[ue]),Ie=t.useCallback(()=>{S&&h(S,o?window.innerWidth-40:400)},[S,h,o]),Pe=t.useCallback(()=>{S&&(h(S,o?window.innerWidth-40:400),de(S)),ye()},[S,h,de,ye,o]),W=t.useCallback(()=>{var K,Q,te,we;if(!H.length)return;const a=S&&((K=u[S])!=null&&K.width)?u[S].width:((Q=u[H[0].id])==null?void 0:Q.width)||400,z=S&&((te=u[S])!=null&&te.height)?u[S].height:((we=u[H[0].id])==null?void 0:we.height)||400;H.forEach(Me=>{Me.id!==S&&h(Me.id,a,z)}),q(`All frames synced to ${a}px width and ${z}px height`)},[H,S,u,h,q]),X=t.useMemo(()=>H.map(a=>{const z=u[a.id]||{width:400,height:400,maxHeight:!1},K=z.position||a.position||{x:0,y:0},Q={width:z.width||400,height:z.height||"auto",position:"absolute",left:K.x,top:K.y,transition:T===a.id||w===a.id||Y?"none":"all 0.2s ease",opacity:T===a.id?.6:1,transform:I===a.id?"scale(1.01)":"scale(1)",zIndex:S===a.id?1001:Y&&T===a.id?1e3:1,boxShadow:w===a.id||S===a.id?n.shadows[8]:n.shadows[2]};return e.jsx(O,{ref:ie(a.id),sx:Q,children:e.jsx(gt,{frame:a,layout:z,isActive:S===a.id,isDragging:T===a.id,isResizing:w===a.id,isDraggedOver:I===a.id,isConfigExpanded:he.has(a.id),globalSyncEnabled:M,onMove:fe,onResize:s,onRemove:j,onCopyUrl:U,onMenuOpen:ve,onToggleSync:xe,onIframeLoad:Te,onOptionChange:F,onChangeCountry:f,onShowNotification:q,frameRef:null,onUpdateSyncOption:l,onReload:i})},a.id)}),[H,u,T,w,Y,S,he,M,n.shadows,fe,s,j,U,ve,xe,Te,F,f,q,ie,I]),pe=t.useMemo(()=>{var a;return e.jsx(_,{onClick:()=>S&&d(S),children:S&&((a=u[S])!=null&&a.maxHeight)?e.jsxs(e.Fragment,{children:[e.jsx(Kt,{fontSize:"small",sx:{mr:1}}),"Reset Height"]}):e.jsxs(e.Fragment,{children:[e.jsx(Vt,{fontSize:"small",sx:{mr:1}}),"Maximize Height"]})})},[S,u,d]);return e.jsxs(O,{ref:B,sx:{height:"100%",width:"100%",overflow:"auto",p:2,backgroundColor:n.palette.background.default,position:"relative",cursor:N?J?"grabbing":"grab":"default"},children:[e.jsx(bt,{showGrid:r,zoomLevel:G,isPanningEnabled:N,isPanning:J,onStartPanning:ae,containerRef:se,parentRef:B,children:X}),e.jsx(yn,{visible:P,onClose:Ee}),e.jsxs(qt,{anchorEl:g,open:!!g,onClose:ye,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[pe,e.jsxs(_,{onClick:Ce,children:[e.jsx(Qe,{children:e.jsx(et,{fontSize:"small"})}),e.jsx(Je,{primary:"Change Frame Size",secondary:S?`Current: ${((y=u[S])==null?void 0:y.width)||400}px`:void 0}),e.jsx(Jt,{fontSize:"small"})]}),e.jsxs(_,{onClick:()=>Ie(),children:[e.jsx(Qe,{children:e.jsx(et,{fontSize:"small"})}),e.jsx(Je,{primary:"Reset Size"})]}),e.jsxs(_,{onClick:Pe,children:[e.jsx(Qe,{children:e.jsx(et,{fontSize:"small"})}),e.jsx(Je,{primary:"Reset All"})]})]}),e.jsx(sn,{anchorEl:L,currentWidth:S&&(($=u[S])==null?void 0:$.width)||400,onClose:Le,onSelect:Ye,onCloseParentMenu:ye}),e.jsx(rn,{message:E,open:!!E}),e.jsx(ft,{open:R,onOpen:()=>b(!0),onClose:()=>b(!1),globalSyncEnabled:M,showGrid:r,snapToGrid:C,showZoomControls:Z,isPanningEnabled:N,onAddFrame:m,onToggleGlobalSync:c,onToggleGrid:Ze,onToggleSnapToGrid:Be,onToggleZoomControls:ke,onTogglePanningMode:be,onSyncFrameSizes:W,onShowKeyboardShortcuts:Ee}),Z&&e.jsx(O,{sx:{position:"fixed",bottom:16,right:80,zIndex:1e3,transition:n.transitions.create("all")},children:e.jsx(xt,{zoomLevel:G,onZoomChange:ee,onZoomIn:re,onZoomOut:De})})]})};export{En as default};
