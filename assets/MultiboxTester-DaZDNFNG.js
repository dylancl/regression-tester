import{u as Pe,j as e,B as M,$ as yt,ab as ot,ak as Ct,a5 as st,d as K,I as we,al as rt,S as Ye,a6 as Fe,a7 as ze,a8 as Oe,f as N,aa as Re,a3 as Ne,m as St,am as Je,an as wt,ao as vt,ap as jt,aq as kt,H as Lt,ar as Et,h as Mt,a as me,ah as Ft,as as zt,r as $e,at,w as Ot,au as Rt,ae as Tt,av as Dt,aw as It,ax as Pt,P as pt,ay as Ht,az as Ut,aA as Wt,aB as At,aC as Te,aD as $t,aE as Bt,aF as Gt,aG as Nt,aH as Yt,aI as Zt,aJ as Xt,aK as mt,a9 as lt,b as _t,aL as Kt,F as Vt,e as qt,n as Qe,ai as et,U as Jt}from"./mui-Be33Q-K3.js";import{r as t,a as Qt}from"./vendor-By_F_pnL.js";import{g as Ge,c as ge,d as en}from"./index-9eOP6H1w.js";import{c as tn,a as nn,d as ct,F as on,D as sn,N as rn}from"./DeviceSizeMenu-PLcf9Flg.js";import{m as an,L as ln}from"./index-BTN6umcJ.js";import{A as dt}from"./index-jvwznmng.js";const cn=()=>{const[n,o]=t.useState([]),[g,u]=t.useState(null),[r,x]=t.useState(!0),[R,b]=t.useState(!1);t.useEffect(()=>{n.length===0&&H()},[]),t.useEffect(()=>{if(n.length>0){const c=n[0];tn({selectedOptions:c.selectedOptions,countryLanguageCode:c.countryLanguageCode})}},[n]);const H=()=>{const c=nn(),l=c?k(0,c.selectedOptions,c.countryLanguageCode):L(0),i=L(1);o([l,i])},k=(c,l,i)=>{const h=`frame-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,S=Ge(l,i),T=60;return{id:h,selectedOptions:{...l},countryLanguageCode:i,generatedUrl:S,iframeLoading:!0,customSized:!1,syncEnabled:!1,syncOptions:{environment:!0,component:!0,uscContext:!0,uscEnv:!0,brand:!0,variantBrand:!0,retailerscreen:!0,country:!0},position:{x:100+T*c,y:100+T*c}}},L=c=>{const l=`frame-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,i=Object.keys(ge)[0],h=Ge(ct,i),S=60;return{id:l,selectedOptions:{...ct},countryLanguageCode:i,generatedUrl:h,iframeLoading:!0,customSized:!1,syncEnabled:!1,syncOptions:{environment:!0,component:!0,uscContext:!0,uscEnv:!0,brand:!0,variantBrand:!0,retailerscreen:!0,country:!0},position:{x:100+S*c,y:100+S*c}}};t.useEffect(()=>{if(g){const c=setTimeout(()=>{u(null)},3e3);return()=>{clearTimeout(c)}}},[g]);const W=()=>{const c=L(n.length);o(l=>[...l,c])},B=(c,l)=>{o(i=>i.map(h=>h.id===c?{...h,position:l,customSized:!0}:h))},P=(c,l)=>{o(i=>{const h=[...i],S=h.findIndex(Z=>Z.id===c),T=h.findIndex(Z=>Z.id===l);if(S===-1||T===-1)return i;const[I]=h.splice(S,1);return h.splice(T,0,I),h})},E=c=>{if(n.length<=1){U("Cannot remove the last frame");return}o(l=>l.filter(i=>i.id!==c))},F=(c,l,i)=>{o(h=>{var s,d,p,D;const S=[...h],T=S.findIndex(C=>C.id===c);if(T===-1)return h;const I=S[T],Z={...I.selectedOptions,[l]:i},w=(s=ge[I.countryLanguageCode])==null?void 0:s.hasLexus,ue=(d=ge[I.countryLanguageCode])==null?void 0:d.hasStock,se=((p=ge[I.countryLanguageCode])==null?void 0:p.hasUsed)!==!1;l==="brand"&&i==="lexus"&&!w&&(U("Lexus is not available for this country"),Z.brand="toyota"),l==="uscContext"&&i==="stock"&&!ue&&(U("Stock Cars is not set up for this country"),Z.uscContext="used"),l==="uscContext"&&i==="used"&&!se&&(U("Used Cars is not available for this country"),Z.uscContext="stock");const he=Ge(Z,I.countryLanguageCode);return S[T]={...I,selectedOptions:Z,generatedUrl:he,iframeLoading:!0},(R||I.syncEnabled)&&(((D=I.syncOptions)==null?void 0:D[l])!==!1?(U(`Syncing ${l} to other frames`),S.forEach((v,G)=>{var X,ee,re;if(G!==T){const Ue=(X=ge[v.countryLanguageCode])==null?void 0:X.hasLexus,ke=(ee=ge[v.countryLanguageCode])==null?void 0:ee.hasStock,J=((re=ge[v.countryLanguageCode])==null?void 0:re.hasUsed)!==!1;let Y={...v.selectedOptions};l==="brand"&&i==="lexus"?Y.brand=Ue?i:"toyota":l==="uscContext"&&i==="stock"?Y.uscContext=ke?i:J?"used":"stock":l==="uscContext"&&i==="used"?Y.uscContext=J?i:ke?"stock":"used":Y[l]=i;const ae=Ge(Y,v.countryLanguageCode);S[G]={...v,selectedOptions:Y,generatedUrl:ae,iframeLoading:!0}}})):U(`Sync for "${l}" is disabled in settings`)),S})},m=(c,l)=>{o(i=>{var w;const h=[...i],S=h.findIndex(ue=>ue.id===c);if(S===-1)return i;const T=h[S],I=Ge(T.selectedOptions,l);return h[S]={...T,countryLanguageCode:l,generatedUrl:I,iframeLoading:!0},(R||T.syncEnabled)&&(((w=T.syncOptions)==null?void 0:w.country)!==!1?(U("Syncing country to other frames"),h.forEach((se,he)=>{if(he!==S){const fe=Ge(se.selectedOptions,l);h[he]={...se,countryLanguageCode:l,generatedUrl:fe,iframeLoading:!0}}})):U("Country sync is disabled in settings")),h})},j=async c=>{try{await navigator.clipboard.writeText(c),U("URL copied to clipboard")}catch{U("Failed to copy URL")}},z=c=>{o(l=>l.map(i=>i.id===c?{...i,iframeLoading:!1}:i))},f=()=>{x(!r)},U=c=>{u(c)};return{frames:n,notification:g,sidebarOpen:r,globalSyncEnabled:R,addNewFrame:W,removeFrame:E,handleOptionChange:F,changeCountry:m,copyUrlToClipboard:j,handleIframeLoad:z,toggleSidebar:f,showNotification:U,reorderFrames:P,markFrameAsCustomSized:c=>{o(l=>l.map(i=>i.id===c?{...i,customSized:!0}:i))},resetFrameCustomSize:c=>{o(l=>l.map(i=>i.id===c?{...i,customSized:!1}:i))},updateFramePosition:B,toggleFrameSync:c=>{var S;const l=n.find(T=>T.id===c);if(!l)return;const i=!l.syncEnabled;o(T=>T.map(I=>I.id===c?{...I,syncEnabled:i}:I));const h=((S=ge[l.countryLanguageCode])==null?void 0:S.pretty)||"Frame";U(i?`Frame sync enabled for ${h}`:`Frame sync disabled for ${h}`)},toggleGlobalSync:()=>{const c=!R;b(c),U(c?"Global sync enabled":"Global sync disabled")},updateFrameSyncOptions:(c,l,i)=>{o(h=>h.map(S=>S.id===c?{...S,syncOptions:{...S.syncOptions||{},[l]:i}}:S)),U(`${i?"Enabled":"Disabled"} syncing ${l}`)},refreshFrame:c=>{const l=n.find(i=>i.id===c);if(l){const i=Date.now(),h=l.generatedUrl.includes("?")?"&":"?",S=`${l.generatedUrl}${h}_t=${i}`;o(T=>T.map(I=>I.id===c?{...I,generatedUrl:S,iframeLoading:!0}:I)),U("Reloading frame...")}}}},Ke=200,tt=400,nt=800,je=800,le=100,ut=15,dn=16,Ve=20,qe=(n,o)=>Math.round(n/o)*o,un={n:"ns-resize",s:"ns-resize",e:"ew-resize",w:"ew-resize",ne:"nesw-resize",nw:"nwse-resize",se:"nwse-resize",sw:"nesw-resize"},hn=n=>un[n]||"default",pn=({frames:n,onUpdateFramePosition:o,onMarkFrameAsCustomSized:g,snapToGrid:u=!1})=>{const[r,x]=t.useState({}),[R,b]=t.useState(null),[H,k]=t.useState(null),[L,W]=t.useState(null),[B,P]=t.useState(null),[E,F]=t.useState(!1),[m,j]=t.useState(null),[z,f]=t.useState(new Set),[U,He]=t.useState(u),q=t.useRef(null),ce=t.useRef({}),de=t.useRef(""),oe=t.useRef(null),xe=t.useRef({x:0,y:0}),c=t.useRef({}),l=t.useRef(null),i=t.useCallback(()=>{Object.keys(c.current).length!==0&&(x(s=>({...s,...c.current})),c.current={},l.current=null)},[]),h=t.useCallback((s,d)=>{c.current[s]={...r[s]||{width:je,height:je,maxHeight:!1},...d},l.current!==null&&window.cancelAnimationFrame(l.current),l.current=window.requestAnimationFrame(i)},[r,i]);t.useEffect(()=>()=>{l.current!==null&&window.cancelAnimationFrame(l.current)},[]),t.useEffect(()=>{const s=q.current;if(!s)return;const d=requestAnimationFrame(()=>{let p=0,D=0;n.forEach(C=>{const v=r[C.id],G=(v==null?void 0:v.position)||C.position||{x:0,y:0};v&&(p=Math.max(p,G.x+v.width),D=Math.max(D,G.y+v.height))}),s.style.minWidth=`${p+Ke}px`,s.style.minHeight=`${D+Ke}px`});return()=>cancelAnimationFrame(d)},[n,r]),t.useEffect(()=>{const s={};n.forEach(d=>{r[d.id]||(s[d.id]={height:je,width:je,maxHeight:!1,position:d.position})}),Object.keys(s).length>0&&x(d=>({...d,...s}))},[n,r]),t.useEffect(()=>{if(E||R)return;let s=null;const d=()=>{Object.entries(r).forEach(([p,D])=>{if(!D.position)return;const C=n.find(X=>X.id===p);if(!C)return;const v=C.position,G=D.position;((v==null?void 0:v.x)!==G.x||(v==null?void 0:v.y)!==G.y)&&o(p,G)})};return s=window.setTimeout(d,100),()=>{s&&window.clearTimeout(s)}},[r,E,R,n,o]);const S=t.useCallback((s,d)=>{let p=null;const D=()=>{var G;const v=(G=q.current)==null?void 0:G.parentElement;v&&(p&&window.clearInterval(p),p=window.setInterval(()=>{if(!s.current){C();return}const{horizontal:X,vertical:ee}=d();X!==0&&(v.scrollLeft+=X*ut),ee!==0&&(v.scrollTop+=ee*ut)},dn))},C=()=>{p&&(window.clearInterval(p),p=null)};return{startAutoScroll:D,clearAutoScroll:C}},[]),T=t.useCallback((s,d,p,D)=>{const C=q.current;if(!C)return;const v=parseInt(C.style.minWidth||"0",10),G=parseInt(C.style.minHeight||"0",10),X=s+p+Ke,ee=d+D+Ke;X>v&&(C.style.minWidth=`${X}px`),ee>G&&(C.style.minHeight=`${ee}px`)},[]),I=t.useCallback(s=>U?{x:qe(s.x,Ve),y:qe(s.y,Ve)}:s,[U]),Z=t.useCallback(s=>U?{width:Math.max(tt,qe(s.width,Ve)),height:Math.max(nt,qe(s.height,Ve))}:s,[U]),w=t.useCallback((s,d)=>{if(s.preventDefault(),s.stopPropagation(),!s.target.closest(".frame-drag-handle"))return;F(!0),j(d);const p=ce.current[d],D=q.current;if(!p||!D)return;const C=s.target.closest(".frame-drag-handle"),v=p.getBoundingClientRect(),G=D.getBoundingClientRect(),X=window.getComputedStyle(D).transform,re=new DOMMatrix(X).a||1,Ue=s.clientX,ke=s.clientY,J=v.left-G.left+D.scrollLeft,Y=v.top-G.top+D.scrollTop,ne=(r[d]||{width:v.width,height:v.height,position:{x:J,y:Y}}).position||{x:J,y:Y};h(d,{position:ne}),g(d);const be={current:!0};de.current=document.body.style.cursor,document.body.style.cursor="grabbing",C&&C.requestPointerLock();let ve=0,ye=0,Ce=performance.now(),Le={x:ne.x,y:ne.y};const Ze=()=>{const A=D.parentElement;if(!A)return{horizontal:0,vertical:0};const _=A.getBoundingClientRect(),pe=xe.current.x,y=xe.current.y;let $=0,a=0;return pe>_.right-le?$=1:pe<_.left+le&&($=-1),y>_.bottom-le?a=1:y<_.top+le&&(a=-1),{horizontal:$,vertical:a}},{startAutoScroll:Xe,clearAutoScroll:Be}=S(be,Ze),Ee=A=>{var Me,it;if(!be.current)return;A.preventDefault(),A.stopPropagation(),xe.current={x:A.clientX,y:A.clientY};let _,pe;document.pointerLockElement===C?(ve+=A.movementX,ye+=A.movementY,_=ve/re,pe=ye/re):(_=(A.clientX-Ue)/re,pe=(A.clientY-ke)/re);let y=Math.max(0,ne.x+_),a=Math.max(60,ne.y+pe);const O=I({x:y,y:a});y=O.x,a=O.y;const V=performance.now();(V-Ce>16||Math.abs(y-Le.x)>10||Math.abs(a-Le.y)>10)&&(h(d,{position:{x:y,y:a}}),Ce=V,Le={x:y,y:a});const Q=D.parentElement;if(Q){const _e=Q.getBoundingClientRect();(A.clientX>_e.right-le||A.clientX<_e.left+le||A.clientY>_e.bottom-le||A.clientY<_e.top+le)&&Xe()}const te=((Me=r[d])==null?void 0:Me.width)||je,Se=((it=r[d])==null?void 0:it.height)||je;T(y,a,te,Se)},ie=()=>{var _;be.current=!1,F(!1),j(null),document.pointerLockElement===C&&document.exitPointerLock(),i();const A=((_=r[d])==null?void 0:_.position)||Le;o(d,A),Be(),document.body.style.cursor=de.current,document.removeEventListener("mousemove",Ee),document.removeEventListener("mouseup",ie),document.removeEventListener("mouseleave",We),document.removeEventListener("pointerlockchange",Ae)},We=A=>{var _;document.pointerLockElement!==C&&(A!=null&&A.target)&&((_=A.target)==null?void 0:_.nodeName)==="HTML"&&ie()},Ae=()=>{document.pointerLockElement!==C&&be.current&&ie()};document.addEventListener("mousemove",Ee),document.addEventListener("mouseup",ie),document.addEventListener("mouseleave",We),document.addEventListener("pointerlockchange",Ae)},[r,I,S,T,h,i,g,o]),ue=t.useCallback((s,d,p)=>{var A,_,pe;s.preventDefault(),s.stopPropagation(),b(d),k(p),j(d);const D=ce.current[d],C=q.current;if(!D||!C)return;oe.current=s.target;const v=window.getComputedStyle(C).transform,X=new DOMMatrix(v).a||1,ee=D.getBoundingClientRect(),re=C.getBoundingClientRect(),Ue=s.clientX,ke=s.clientY,J=((A=r[d])==null?void 0:A.width)||ee.width,Y=((_=r[d])==null?void 0:_.height)||ee.height,ae=((pe=r[d])==null?void 0:pe.position)||{x:ee.left-re.left+C.scrollLeft,y:ee.top-re.top+C.scrollTop};g(d);const ne={current:!0};de.current=document.body.style.cursor,document.body.style.cursor=hn(p),oe.current&&oe.current.requestPointerLock();let be=0,ve=0,ye=performance.now(),Ce={x:ae.x,y:ae.y,width:J,height:Y};const Le=()=>{const y=C.parentElement;if(!y)return{horizontal:0,vertical:0};const{x:$,y:a,width:O,height:V}=Be();let Q=0,te=0;return p.includes("e")&&$+O>y.scrollLeft+y.clientWidth-le?Q=1:p.includes("w")&&$<y.scrollLeft+le&&(Q=-1),p.includes("s")&&a+V>y.scrollTop+y.clientHeight-le?te=1:p.includes("n")&&a<y.scrollTop+le&&(te=-1),{horizontal:Q,vertical:te}},{startAutoScroll:Ze,clearAutoScroll:Xe}=S(ne,Le),Be=()=>{let y=J,$=Y,a=ae.x,O=ae.y;const V=be/X,Q=ve/X;if(p.includes("e")&&(y=Math.max(tt,J+V)),p.includes("w")){const te=Math.max(tt,J-V);y=te,a=ae.x+(J-te)}if(p.includes("s")&&($=Math.max(nt,Y+Q)),p.includes("n")){const Se=Math.max(nt,Y-Q);$=Se;const Me=ae.y+(Y-Se);O=Math.max(60,Me),O>Me&&($=Y-(O-ae.y)*X)}if(U){const te=I({x:a,y:O});a=te.x,O=te.y;const Se=Z({width:y,height:$});y=Se.width,$=Se.height}return{x:a,y:O,width:y,height:$}},Ee=y=>{if(!ne.current)return;y.preventDefault(),y.stopPropagation(),document.pointerLockElement===oe.current?(be+=y.movementX,ve+=y.movementY):(be=y.clientX-Ue,ve=y.clientY-ke);const{x:$,y:a,width:O,height:V}=Be(),Q=performance.now();(Q-ye>16||Math.abs(O-Ce.width)>5||Math.abs(V-Ce.height)>5||Math.abs($-Ce.x)>5||Math.abs(a-Ce.y)>5)&&(h(d,{width:O,height:V,position:{x:$,y:a},maxHeight:!1}),ye=Q,Ce={x:$,y:a,width:O,height:V}),Ze(),T($,a,O,V)},ie=()=>{ne.current=!1,document.pointerLockElement===oe.current&&document.exitPointerLock(),i();const y=r[d];y!=null&&y.position&&o(d,y.position),b(null),k(null),j(null),Xe(),document.body.style.cursor=de.current,document.removeEventListener("mousemove",Ee),document.removeEventListener("mouseup",ie),document.removeEventListener("mouseleave",We),document.removeEventListener("pointerlockchange",Ae)},We=y=>{var $;document.pointerLockElement!==oe.current&&(y!=null&&y.target)&&(($=y.target)==null?void 0:$.nodeName)==="HTML"&&ie()},Ae=()=>{document.pointerLockElement!==oe.current&&ne.current&&ie()};document.addEventListener("mousemove",Ee),document.addEventListener("mouseup",ie),document.addEventListener("mouseleave",We),document.addEventListener("pointerlockchange",Ae)},[r,I,Z,S,T,h,i,g,o,U]),se=t.useCallback(s=>{x(d=>{const p=d[s];if(!p)return d;const D=p.maxHeight?je:window.innerHeight-180,C={...p,height:D,maxHeight:!p.maxHeight};return g(s),C.position&&o(s,C.position),{...d,[s]:C}})},[g,o]),he=t.useCallback((s,d=je,p=je)=>{x(D=>{var v;const C=(v=D[s])==null?void 0:v.position;return{...D,[s]:{height:p,width:d,maxHeight:!1,position:C}}})},[]),fe=t.useCallback(s=>{f(d=>{const p=new Set(d);return p.has(s)?p.delete(s):p.add(s),p})},[]);return{frameLayouts:r,resizingFrameId:R,resizeDirection:H,draggedFrameId:L,dragOverFrameId:B,draggingFrame:E,activeFrameId:m,frameRefs:ce,framesContainerRef:q,expandedConfigFrames:z,handleFrameMoveStart:w,handleMultiDirectionResize:ue,toggleMaximizeHeight:se,resetFrameSize:he,toggleConfigPanel:fe,setActiveFrameId:j,setResizingFrameId:b,setResizeDirection:k,setDraggedFrameId:W,setDragOverFrameId:P,snapToGrid:U,setSnapToGrid:He}},mn=n=>{const[o,g]=t.useState(100),[u,r]=t.useState(!1),{containerRef:x,controlsHideDelay:R=2e3}=n||{},b=t.useRef(null),H=()=>{b.current!==null&&(window.clearTimeout(b.current),b.current=null)},k=t.useCallback(()=>{H(),b.current=window.setTimeout(()=>{r(!1)},R)},[R]),L=t.useCallback((E,F)=>{g(F)},[]),W=t.useCallback(()=>{g(E=>Math.min(E+10,200)),r(!0),k()},[k]),B=t.useCallback(()=>{g(E=>Math.max(E-10,50)),r(!0),k()},[k]),P=t.useCallback(()=>{r(E=>(E||H(),!E))},[]);return t.useEffect(()=>{const E=(x==null?void 0:x.current)||window,F=m=>{const j=m;(j.ctrlKey||j.metaKey)&&(j.preventDefault(),r(!0),j.deltaY<0?g(z=>Math.min(z+5,200)):g(z=>Math.max(z-5,50)),k())};return E.addEventListener("wheel",F,{passive:!1}),()=>{E.removeEventListener("wheel",F),H()}},[x,k]),t.useEffect(()=>()=>{H()},[]),{zoomLevel:o,showZoomControls:u,handleZoomChange:L,handleZoomIn:W,handleZoomOut:B,toggleZoomControls:P,setShowZoomControls:r}},gn=({parentRef:n})=>{const[o,g]=t.useState(!1),[u,r]=t.useState(!1),x=t.useRef({x:0,y:0}),R=t.useRef({left:0,top:0}),b=t.useRef(!1),H=t.useRef(""),k=t.useRef(new Map),L=t.useCallback(m=>{document.querySelectorAll("iframe").forEach(z=>{k.current.has(z)||k.current.set(z,z.style.pointerEvents||"auto"),z.style.pointerEvents=m})},[]),W=t.useCallback(()=>{k.current.forEach((m,j)=>{j.style.pointerEvents=m}),k.current.clear()},[]);t.useEffect(()=>{H.current=document.documentElement.style.overflow;const m=z=>{if(z.key===" "||z.code==="Space")return z.preventDefault(),z.stopPropagation(),z.stopImmediatePropagation(),z.type==="keydown"&&!z.repeat&&!b.current&&(b.current=!0,r(!0),document.body.style.cursor="grab",document.documentElement.style.overflow="hidden",L("none")),z.type==="keyup"&&(b.current=!1,r(!1),document.body.style.cursor="",document.documentElement.style.overflow=H.current,L("auto"),W(),E()),!1},j=z=>{if(b.current)return z.preventDefault(),z.stopPropagation(),!1};return document.addEventListener("keydown",m,{capture:!0,passive:!1}),document.addEventListener("keypress",m,{capture:!0,passive:!1}),document.addEventListener("keyup",m,{capture:!0,passive:!1}),document.addEventListener("scroll",j,{capture:!0,passive:!1}),document.addEventListener("wheel",j,{capture:!0,passive:!1}),document.addEventListener("focusin",()=>{b.current&&(document.documentElement.style.overflow="hidden",L("none"))},{capture:!0}),window.addEventListener("blur",()=>{b.current&&(b.current=!1,r(!1),document.body.style.cursor="",document.documentElement.style.overflow=H.current,W(),E())}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("keypress",m,{capture:!0}),document.removeEventListener("keyup",m,{capture:!0}),document.removeEventListener("scroll",j,{capture:!0}),document.removeEventListener("wheel",j,{capture:!0}),document.documentElement.style.overflow=H.current,document.body.style.cursor="",W()}},[L,W]);const B=t.useCallback(m=>{if(!o||!n.current)return;m.preventDefault(),m.stopPropagation();const j=m.clientX-x.current.x,z=m.clientY-x.current.y;n.current.scrollLeft=R.current.left-j,n.current.scrollTop=R.current.top-z,document.body.style.cursor="grabbing"},[o,n]);t.useEffect(()=>{if(o)return document.addEventListener("mousemove",B,{passive:!1}),document.addEventListener("mouseup",E),()=>{document.removeEventListener("mousemove",B),document.removeEventListener("mouseup",E)}},[o,B]);const P=t.useCallback(m=>{!u||!n.current||(m.preventDefault(),m.stopPropagation(),g(!0),x.current={x:m.clientX,y:m.clientY},R.current={left:n.current.scrollLeft,top:n.current.scrollTop},document.body.style.cursor="grabbing",L("none"))},[u,n,L]),E=t.useCallback(()=>{g(!1),document.body.style.cursor=b.current?"grab":"",b.current||W()},[W]),F=t.useCallback(()=>{r(m=>!m)},[]);return{isPanning:o,isPanningEnabled:u,startPanning:P,stopPanning:E,togglePanningMode:F}},De={position:"absolute",width:20,height:20,zIndex:100,display:"flex",justifyContent:"center",alignItems:"center",transition:"background-color 0.2s ease"},Ie={width:10,height:10,borderRadius:"50%",backgroundColor:"currentColor",transition:"transform 0.2s ease, background-color 0.2s ease, box-shadow 0.2s ease",boxShadow:"0 0 0 2px rgba(255, 255, 255, 0.5), 0 0 0 1px rgba(0, 0, 0, 0.2)","&:hover":{transform:"scale(1.5)",boxShadow:"0 0 0 2px rgba(255, 255, 255, 0.8), 0 0 0 1px rgba(0, 0, 0, 0.5)"}},xn=({frameId:n,onResize:o})=>{const g=Pe(),r={color:g.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.5)","&::before":{content:'""',position:"absolute",width:"100%",height:"100%",borderRadius:"50%",backgroundColor:"rgba(255, 255, 255, 0.1)",zIndex:-1},"&:hover":{color:g.palette.primary.main,"&::before":{backgroundColor:"rgba(255, 255, 255, 0.3)"}}};return e.jsxs(e.Fragment,{children:[e.jsx(M,{sx:{...De,top:0,left:0,cursor:"nwse-resize",...r},onMouseDown:x=>o(x,n,"nw"),children:e.jsx(M,{sx:Ie})}),e.jsx(M,{sx:{...De,top:0,right:0,cursor:"nesw-resize",...r},onMouseDown:x=>o(x,n,"ne"),children:e.jsx(M,{sx:Ie})}),e.jsx(M,{sx:{...De,bottom:0,left:0,cursor:"nesw-resize",...r},onMouseDown:x=>o(x,n,"sw"),children:e.jsx(M,{sx:Ie})}),e.jsx(M,{sx:{...De,bottom:0,right:0,cursor:"nwse-resize",...r},onMouseDown:x=>o(x,n,"se"),children:e.jsx(M,{sx:Ie})}),e.jsx(M,{sx:{...De,top:"50%",right:0,transform:"translateY(-50%)",cursor:"ew-resize",...r},onMouseDown:x=>o(x,n,"e"),children:e.jsx(M,{sx:Ie})}),e.jsx(M,{sx:{...De,top:"50%",left:0,transform:"translateY(-50%)",cursor:"ew-resize",...r},onMouseDown:x=>o(x,n,"w"),children:e.jsx(M,{sx:Ie})}),e.jsx(M,{sx:{...De,top:0,left:"50%",transform:"translateX(-50%)",cursor:"ns-resize",...r},onMouseDown:x=>o(x,n,"n"),children:e.jsx(M,{sx:Ie})}),e.jsx(M,{sx:{...De,bottom:0,left:"50%",transform:"translateX(-50%)",cursor:"ns-resize",...r},onMouseDown:x=>o(x,n,"s"),children:e.jsx(M,{sx:Ie})})]})},fn=({frame:n,onChangeCountry:o,onOptionChange:g})=>{const u=Pe(),[r,x]=t.useState(null),R=!!r,b=ge[n.countryLanguageCode]||{},H=b.hasLexus||!1,k=b.hasStock||!1,L=b.hasUsed!==!1,W=F=>{x(F.currentTarget)},B=()=>{x(null)},P=F=>{const m=F.target.name,j=F.target.value;g(n.id,m,j)},E=F=>{o(n.id,F)};return e.jsxs(e.Fragment,{children:[e.jsx(yt,{size:"small",color:"default","aria-label":"configuration options",onClick:W,sx:{position:"absolute",bottom:16,right:16,bgcolor:R?u.palette.primary.main:u.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.4)",color:R?"#fff":u.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)","&:hover":{bgcolor:u.palette.primary.main,color:"#fff"},transition:"background-color 0.3s, color 0.3s, opacity 0.3s",boxShadow:R?u.shadows[8]:"none",backdropFilter:"blur(4px)",opacity:R?1:.7,zIndex:100},children:e.jsx(ot,{})}),e.jsxs(Ct,{open:R,anchorEl:r,onClose:B,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"right"},slots:{transition:st},slotProps:{transition:{timeout:{enter:200,exit:200}},paper:{elevation:4,sx:{borderRadius:2,bgcolor:u.palette.background.paper,maxWidth:380,width:"100%",overflow:"hidden",backdropFilter:"blur(8px)"}}},children:[e.jsxs(M,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:2,borderBottom:`1px solid ${u.palette.divider}`,bgcolor:u.palette.mode==="dark"?"rgba(66, 66, 66, 0.2)":"rgba(248, 248, 248, 0.8)"},children:[e.jsx(K,{variant:"subtitle1",fontWeight:"medium",color:"primary",children:"Frame Configuration"}),e.jsx(we,{size:"small",onClick:B,children:e.jsx(rt,{fontSize:"small"})})]}),e.jsx(M,{sx:{p:2,maxHeight:"40rem",overflowY:"auto",scrollbarWidth:"thin","&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-track":{background:u.palette.background.default},"&::-webkit-scrollbar-thumb":{backgroundColor:u.palette.divider,borderRadius:"4px"}},children:e.jsxs(Ye,{spacing:2.5,children:[e.jsxs(M,{sx:{backgroundColor:u.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.9)",p:1.5,borderRadius:1,boxShadow:u.shadows[1]},children:[e.jsx(K,{variant:"subtitle2",color:"primary",gutterBottom:!0,fontWeight:"medium",children:"Country"}),e.jsxs(Fe,{fullWidth:!0,size:"small",children:[e.jsx(ze,{id:"country-label",children:"Country"}),e.jsx(Oe,{labelId:"country-label",id:"country",value:n.countryLanguageCode,label:"Country",onChange:F=>E(F.target.value),MenuProps:{PaperProps:{style:{maxHeight:300}}},children:Object.entries(ge).map(([F,m])=>e.jsxs(N,{value:F,children:[m.pretty," (",F,")"]},F))}),e.jsx(Re,{children:"Use the dropdown to change country"})]})]}),e.jsx(Ne,{}),e.jsxs(M,{sx:{backgroundColor:u.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.9)",p:1.5,borderRadius:1,boxShadow:u.shadows[1]},children:[e.jsx(K,{variant:"subtitle2",color:"primary",gutterBottom:!0,fontWeight:"medium",children:"Environment"}),e.jsxs(Ye,{spacing:1.5,children:[e.jsxs(Fe,{fullWidth:!0,size:"small",children:[e.jsx(ze,{id:"environment-label",children:"Deployment Environment"}),e.jsxs(Oe,{labelId:"environment-label",id:"environment",name:"environment",value:n.selectedOptions.environment||"prev",label:"Deployment Environment",onChange:P,children:[e.jsx(N,{value:"localhost",children:"Localhost"}),e.jsx(N,{value:"dev",children:"Development"}),e.jsx(N,{value:"acc",children:"Acceptance"}),e.jsx(N,{value:"prev",children:"Preview"}),e.jsx(N,{value:"prod",children:"Production"})]}),e.jsx(Re,{children:"Select the deployment environment"})]}),e.jsxs(Fe,{fullWidth:!0,size:"small",children:[e.jsx(ze,{id:"usc-env-label",children:"USC Environment"}),e.jsxs(Oe,{labelId:"usc-env-label",id:"uscEnv",name:"uscEnv",value:n.selectedOptions.uscEnv||"uat",label:"USC Environment",onChange:P,children:[e.jsx(N,{value:"uat",children:"UAT"}),e.jsx(N,{value:"production",children:"Production"})]}),e.jsx(Re,{children:"Backend environment"})]})]})]}),e.jsx(Ne,{}),e.jsxs(M,{sx:{backgroundColor:u.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.9)",p:1.5,borderRadius:1,boxShadow:u.shadows[1]},children:[e.jsx(K,{variant:"subtitle2",color:"primary",gutterBottom:!0,fontWeight:"medium",children:"Component"}),e.jsxs(Fe,{fullWidth:!0,size:"small",children:[e.jsx(ze,{id:"component-label",children:"Component"}),e.jsx(Oe,{labelId:"component-label",id:"component",name:"component",value:n.selectedOptions.component||"car-filter",label:"Component",onChange:P,children:Object.entries(en).map(([F,{title:m,description:j}])=>e.jsxs(N,{value:F,sx:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[m,e.jsx(M,{sx:{fontSize:"0.8em",color:"text.secondary"},children:j})]},F))}),e.jsx(Re,{children:"Select the component to test"})]})]}),e.jsx(Ne,{}),e.jsxs(M,{sx:{backgroundColor:u.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.9)",p:1.5,borderRadius:1,boxShadow:u.shadows[1]},children:[e.jsx(K,{variant:"subtitle2",color:"primary",gutterBottom:!0,fontWeight:"medium",children:"USC Context"}),e.jsxs(Fe,{fullWidth:!0,size:"small",children:[e.jsx(ze,{id:"usc-context-label",children:"USC Context"}),e.jsxs(Oe,{labelId:"usc-context-label",id:"uscContext",name:"uscContext",value:n.selectedOptions.uscContext||"used",label:"USC Context",onChange:P,disabled:n.selectedOptions.component==="used-stock-cars-pdf",children:[e.jsxs(N,{value:"used",disabled:!L,children:["Used ",!L&&"(Not Available)"]}),e.jsxs(N,{value:"stock",disabled:!k,children:["Stock ",!k&&"(Not Available)"]})]}),e.jsx(Re,{children:!k&&n.selectedOptions.uscContext==="used"?"Stock is not available for this country":!L&&n.selectedOptions.uscContext==="stock"?"Used is not available for this country":"Used or Stock cars"})]})]}),e.jsx(Ne,{}),e.jsxs(M,{sx:{backgroundColor:u.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.9)",p:1.5,borderRadius:1,boxShadow:u.shadows[1]},children:[e.jsx(K,{variant:"subtitle2",color:"primary",gutterBottom:!0,fontWeight:"medium",children:"Brand Settings"}),e.jsxs(Ye,{spacing:1.5,children:[e.jsxs(Fe,{fullWidth:!0,size:"small",children:[e.jsx(ze,{id:"brand-label",children:"Brand"}),e.jsxs(Oe,{labelId:"brand-label",id:"brand",name:"brand",value:n.selectedOptions.brand||"toyota",label:"Brand",onChange:P,children:[e.jsx(N,{value:"toyota",children:"Toyota"}),e.jsxs(N,{value:"lexus",disabled:!H,children:["Lexus ",!H&&"(Not Available)"]})]}),e.jsx(Re,{children:!H&&n.selectedOptions.brand==="toyota"?"Lexus is not available for this country":"Brand selection"})]}),e.jsxs(Fe,{fullWidth:!0,size:"small",children:[e.jsx(ze,{id:"variant-brand-label",children:"Variant Brand"}),e.jsxs(Oe,{labelId:"variant-brand-label",id:"variantBrand",name:"variantBrand",value:n.selectedOptions.variantBrand||"toyota",label:"Variant Brand",onChange:P,children:[e.jsx(N,{value:"toyota",children:"Toyota"}),e.jsx(N,{value:"lexus",children:"Lexus"})]}),e.jsx(Re,{children:"Variant brand for the component"})]})]})]}),e.jsx(Ne,{}),e.jsxs(M,{sx:{backgroundColor:u.palette.mode==="dark"?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.9)",p:1.5,borderRadius:1,boxShadow:u.shadows[1]},children:[e.jsx(K,{variant:"subtitle2",color:"primary",gutterBottom:!0,fontWeight:"medium",children:"Retailer Screen"}),e.jsxs(Fe,{fullWidth:!0,size:"small",children:[e.jsx(ze,{id:"retailerscreen-label",children:"Retailer Screen"}),e.jsxs(Oe,{labelId:"retailerscreen-label",id:"retailerscreen",name:"retailerscreen",value:n.selectedOptions.retailerscreen||"false",label:"Retailer Screen",onChange:P,children:[e.jsx(N,{value:"true",children:"Enabled"}),e.jsx(N,{value:"false",children:"Disabled"})]}),e.jsx(Re,{children:"Enable or disable retailer screen mode"})]})]})]})})]})]})},ht=[{key:"environment",label:"Environment",description:"Deployment environment (dev, acc, prev, prod)"},{key:"component",label:"Component",description:"Component type (car-filter, used-stock-cars, etc.)"},{key:"uscContext",label:"USC Context",description:"Used or Stock vehicles context"},{key:"uscEnv",label:"USC Environment",description:"Backend environment (UAT, Production)"},{key:"brand",label:"Brand",description:"Main brand (Toyota, Lexus)"},{key:"variantBrand",label:"Variant Brand",description:"Variant brand displayed in components"},{key:"retailerscreen",label:"Retailer Screen",description:"Enable or disable retailer screen mode"},{key:"country",label:"Country",description:"Country and language selection"}],bn=({open:n,onClose:o,frame:g,onUpdateSyncOption:u})=>{const r=Pe(),x={environment:!0,component:!0,uscContext:!0,uscEnv:!0,brand:!0,variantBrand:!0,retailerscreen:!0,country:!0},R=g.syncOptions||x,b=k=>L=>{u(g.id,k,L.target.checked)},H=ht.reduce((k,L,W)=>(k.push(e.jsx(St,{secondaryAction:e.jsx(wt,{edge:"end",onChange:b(L.key),checked:R[L.key],color:"primary"}),children:e.jsx(Je,{primary:L.label,secondary:L.description,primaryTypographyProps:{fontWeight:500}})},L.key)),W<ht.length-1&&k.push(e.jsx(Ne,{variant:"inset",component:"li"},`divider-${L.key}`)),k),[]);return e.jsxs(vt,{open:n,onClose:o,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[e.jsxs(jt,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:r.palette.mode==="dark"?"rgba(66, 66, 66, 0.2)":"rgba(248, 248, 248, 0.8)",borderBottom:`1px solid ${r.palette.divider}`,p:2},children:[e.jsxs(M,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ot,{color:"primary",sx:{mr:1}}),e.jsx(K,{variant:"h6",component:"div",children:"Sync Configuration Settings"})]}),e.jsx(we,{onClick:o,size:"small",children:e.jsx(rt,{fontSize:"small"})})]}),e.jsxs(kt,{children:[e.jsx(K,{variant:"body2",color:"text.secondary",component:"p",sx:{mt:2},children:"Choose which settings should be synchronized between frames when sync is enabled. Disabled settings will remain independent for each frame."}),e.jsx(Lt,{sx:{pt:2},children:H})]}),e.jsx(Et,{sx:{p:2,backgroundColor:r.palette.mode==="dark"?"rgba(66, 66, 66, 0.2)":"rgba(248, 248, 248, 0.8)",borderTop:`1px solid ${r.palette.divider}`},children:e.jsx(Mt,{onClick:o,color:"primary",children:"Close"})})]})},gt=t.memo(({frame:n,layout:o,isActive:g,isDragging:u,isResizing:r,isDraggedOver:x,globalSyncEnabled:R,onMove:b,onResize:H,onRemove:k,onCopyUrl:L,onMenuOpen:W,onToggleSync:B,onIframeLoad:P,onOptionChange:E,onChangeCountry:F,onShowNotification:m,onUpdateSyncOption:j,onReload:z})=>{var fe;const f=Pe(),U=t.useRef(null),[He,q]=t.useState(!1),[ce,de]=t.useState(!1),[oe,xe]=t.useState(!1);t.useEffect(()=>{let s=null;return ce&&!u&&!r?s=window.setTimeout(()=>xe(!0),150):s=window.setTimeout(()=>xe(!1),100),()=>{s!==null&&clearTimeout(s)}},[ce,u,r,g]);const c=()=>{},l=()=>{},i=()=>q(!0),h=()=>q(!1),S=((fe=ge[n.countryLanguageCode])==null?void 0:fe.pretty)||"Frame",T=t.useMemo(()=>u?"frame-dragging":r?"frame-resizing":x?"frame-drag-over":g?"frame-active":"",[u,r,x,g]),I=t.useMemo(()=>({height:o.height||400,display:"flex",flexDirection:"column",overflow:"hidden",transition:r||u?"none":f.transitions.create(["box-shadow","transform"],{duration:200}),transform:x?"scale(1.01)":"scale(1)",position:"relative",boxShadow:g?f.shadows[12]:ce?f.shadows[6]:f.shadows[3],border:`1px solid ${g?f.palette.primary.main:x?me(f.palette.primary.main,.5):f.palette.divider}`,"&:hover":{boxShadow:f.shadows[8]},"&::before":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,opacity:.03,pointerEvents:"none",backgroundImage:`radial-gradient(${f.palette.primary.light} 1px, transparent 1px)`,backgroundSize:"20px 20px",zIndex:0},backgroundColor:f.palette.background.paper}),[o.height,r,u,g,ce,x,f]),Z=t.useMemo(()=>({p:1,bgcolor:f.palette.mode==="dark"?me(f.palette.background.paper,.7):me(f.palette.background.paper,.85),backdropFilter:"blur(8px)",borderBottom:`1px solid ${f.palette.divider}`,display:"flex",alignItems:"center",justifyContent:"space-between",minHeight:"48px",position:"relative",zIndex:10,"&:hover":{backgroundColor:f.palette.mode==="dark"?me(f.palette.background.default,.8):me(f.palette.background.paper,.95)}}),[f]),w=t.useMemo(()=>({display:"flex",alignItems:"center",flex:1,cursor:"move",borderRadius:"4px",py:.5,pl:.5,pr:1,transition:"background-color 0.2s ease",".MuiSvgIcon-root":{transition:"transform 0.2s ease"},"&:hover .MuiSvgIcon-root":{transform:"scale(1.1)"}}),[]),ue=t.useMemo(()=>e.jsx(Ft,{size:"small",variant:"outlined",label:`${Math.round(o.width)||400}Ã—${Math.round(o.height)||400}`,sx:{height:"22px",fontSize:"0.7rem",borderRadius:"4px",fontFamily:"monospace",fontWeight:"medium",bgcolor:me(f.palette.background.default,.7),backdropFilter:"blur(4px)",borderColor:f.palette.divider,color:f.palette.text.secondary,ml:1,"& .MuiChip-label":{px:.75}}}),[o.width,o.height,f]),se=t.useMemo(()=>{const s=o.width||400,d=[];return s>=220&&d.push("reload"),s>=280&&d.push("sync"),s>=350&&d.push("copy"),s>=420&&d.push("syncOptions"),d},[o.width]),he=t.useMemo(()=>oe||g,[oe,g]);return e.jsxs(zt,{elevation:0,sx:I,className:`frame ${T}`,onMouseEnter:()=>!u&&!r&&de(!0),onMouseLeave:()=>de(!1),children:[e.jsxs(M,{sx:Z,children:[e.jsxs(M,{className:"frame-drag-handle",sx:w,onMouseDown:s=>b(s,n.id),children:[e.jsx($e,{title:"Drag to move frame",children:e.jsx(at,{fontSize:"small",sx:{mr:1,color:f.palette.primary.main,opacity:.7}})}),e.jsx(on,{selectedOptions:n.selectedOptions,countryLanguageCode:n.countryLanguageCode,maxWidth:o.width?Math.max(60,o.width-260):120}),o.width>280&&ue]}),e.jsxs(Ye,{direction:"row",spacing:.5,sx:{ml:"auto","& .MuiButtonBase-root":{color:f.palette.text.secondary},minWidth:"72px",justifyContent:"flex-end"},children:[e.jsx(dt,{initial:!1,onExitComplete:c,children:he&&e.jsx(an.div,{initial:{opacity:0,width:0},animate:{opacity:1,width:"auto",transition:{duration:.2,ease:"easeOut"}},exit:{opacity:0,width:0,transition:{duration:.15,ease:"easeIn"}},onAnimationStart:l,onAnimationComplete:c,style:{display:"flex",overflow:"hidden"},children:e.jsxs(Ot,{variant:"text",size:"small",sx:{display:"flex",alignItems:"center",backgroundColor:me(f.palette.background.paper,1),backdropFilter:"blur(8px)",border:`1px solid ${f.palette.divider}`,borderColor:g?f.palette.primary.main:f.palette.divider,boxShadow:f.shadows[2],borderRadius:"4px",mr:.5,"& .MuiButtonGroup-grouped":{minWidth:"auto",px:.5}},children:[se.includes("reload")&&e.jsx($e,{title:"Reload frame",placement:"top",children:e.jsx(we,{size:"small",onClick:()=>z(n.id),children:e.jsx(Rt,{fontSize:"small"})})}),se.includes("copy")&&e.jsx($e,{title:"Copy URL",placement:"top",children:e.jsx(we,{size:"small",onClick:()=>L(n.generatedUrl),children:e.jsx(Tt,{fontSize:"small"})})}),se.includes("sync")&&e.jsx($e,{title:n.syncEnabled?"Disable config sync":"Enable config sync",placement:"top",children:e.jsx(we,{size:"small",onClick:()=>B(n.id),color:n.syncEnabled||R?"primary":"default",disabled:R,children:n.syncEnabled?e.jsx(Dt,{fontSize:"small"}):e.jsx(It,{fontSize:"small"})})}),se.includes("syncOptions")&&e.jsx($e,{title:"Sync configuration options",placement:"top",children:e.jsx(we,{size:"small",onClick:i,color:n.syncEnabled||R?"primary":"default",disabled:R,children:e.jsx(Pt,{fontSize:"small"})})})]})})}),e.jsx($e,{title:"Configure",placement:"top",children:e.jsx(we,{size:"small",onClick:s=>W(s,n.id),sx:{bgcolor:me(f.palette.background.default,.5),"&:hover":{bgcolor:me(f.palette.background.default,.8)}},children:e.jsx(ot,{fontSize:"small"})})}),e.jsx($e,{title:"Remove frame",placement:"top",children:e.jsx(we,{size:"small",color:"error",onClick:()=>k(n.id),sx:{bgcolor:me(f.palette.error.light,.1),"&:hover":{bgcolor:me(f.palette.error.light,.2)}},children:e.jsx(rt,{fontSize:"small"})})})]})]}),e.jsxs(M,{sx:{flex:1,position:"relative",minHeight:"360px",overflow:"hidden",bgcolor:f.palette.mode==="dark"?"#121212":"#fafafa"},children:[e.jsx(dt,{children:n.iframeLoading&&e.jsx(ln,{message:`Loading ${S}...`})}),e.jsx("iframe",{ref:U,src:n.generatedUrl,style:{border:"none",width:"100%",height:"100%",display:"block",backgroundColor:f.palette.mode==="dark"?"#1E1E1E":"#FFFFFF"},onLoad:()=>P(n.id),title:`Frame ${n.id}`}),e.jsx(fn,{frame:n,onChangeCountry:F,onOptionChange:E,onShowNotification:m})]}),e.jsx(xn,{frameId:n.id,onResize:H}),e.jsx(bn,{open:He,onClose:h,frame:n,onUpdateSyncOption:j})]})});gt.displayName="Frame";const xt=Qt.memo(({zoomLevel:n,onZoomChange:o,onZoomIn:g,onZoomOut:u})=>e.jsx(pt,{elevation:3,sx:{p:2,width:240,borderRadius:2},children:e.jsxs(Ye,{spacing:2,children:[e.jsxs(K,{variant:"subtitle2",textAlign:"center",children:["Zoom Level: ",n,"%"]}),e.jsxs(Ye,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(we,{onClick:u,size:"small",children:e.jsx(Ht,{})}),e.jsx(Ut,{value:n,onChange:o,min:50,max:200,step:5,valueLabelDisplay:"auto",valueLabelFormat:r=>`${r}%`}),e.jsx(we,{onClick:g,size:"small",children:e.jsx(Wt,{})})]})]})}));xt.displayName="ZoomControls";const ft=t.memo(({open:n,onOpen:o,onClose:g,globalSyncEnabled:u,showGrid:r,snapToGrid:x,showZoomControls:R,isPanningEnabled:b,onAddFrame:H,onToggleGlobalSync:k,onToggleGrid:L,onToggleSnapToGrid:W,onToggleZoomControls:B,onTogglePanningMode:P,onSyncFrameSizes:E,onShowKeyboardShortcuts:F})=>{const m=Pe(),j=f=>({bgcolor:f?m.palette.mode==="dark"?"#2c5282":"#e3f2fd":m.palette.mode==="dark"?"#333333":"#ffffff",color:f?m.palette.primary.main:"inherit","&:hover":{bgcolor:f?m.palette.mode==="dark"?"#3b6eb4":"#bbdefb":m.palette.mode==="dark"?"#444444":"#f5f5f5",transform:"scale(1.05)"},boxShadow:m.shadows[2]}),z={bgcolor:m.palette.mode==="dark"?"#333333":"#ffffff","&:hover":{bgcolor:m.palette.mode==="dark"?"#444444":"#f5f5f5",transform:"scale(1.05)"},boxShadow:m.shadows[2]};return e.jsxs(At,{ariaLabel:"Action controls",open:n,onOpen:o,onClose:g,sx:{position:"fixed",bottom:16,right:16,zIndex:1501,"& .MuiFab-primary":{bgcolor:m.palette.primary.main,"&:hover":{bgcolor:m.palette.primary.dark},transition:"all 0.3s ease"},"& .MuiSpeedDial-actions":{gap:.5}},icon:e.jsx(lt,{}),direction:"up",openIcon:e.jsx(lt,{}),FabProps:{sx:{boxShadow:m.shadows[4],"&:hover":{boxShadow:m.shadows[8],transform:"scale(1.05)"}}},children:[e.jsx(Te,{icon:e.jsx($t,{}),tooltipTitle:"Add new frame",tooltipPlacement:"left",onClick:H,sx:z},"add-frame"),e.jsx(Te,{icon:e.jsx(Bt,{}),tooltipTitle:u?"Disable global sync":"Enable global sync",tooltipPlacement:"left",onClick:k,sx:j(u)},"toggle-sync"),e.jsx(Te,{icon:r?e.jsx(Gt,{}):e.jsx(Nt,{}),tooltipTitle:r?"Hide grid":"Show grid",tooltipPlacement:"left",onClick:L,sx:j(r)},"toggle-grid"),e.jsx(Te,{icon:e.jsx(Yt,{}),tooltipTitle:x?"Disable snap to grid":"Enable snap to grid",tooltipPlacement:"left",onClick:W,sx:j(x)},"toggle-snap"),e.jsx(Te,{icon:e.jsx(Zt,{}),tooltipTitle:"Zoom controls",tooltipPlacement:"left",onClick:B,sx:j(R)},"toggle-zoom"),e.jsx(Te,{icon:e.jsx(Xt,{}),tooltipTitle:"Sync all frame sizes",tooltipPlacement:"left",onClick:E,sx:z},"sync-frame-sizes"),e.jsx(Te,{icon:e.jsx(at,{}),tooltipTitle:b?"Disable panning mode":"Enable panning mode",tooltipPlacement:"left",onClick:P,sx:j(b)},"toggle-panning"),e.jsx(Te,{icon:e.jsx(mt,{}),tooltipTitle:"Keyboard shortcuts",tooltipPlacement:"left",onClick:F,sx:z},"toggle-keyboard-shortcuts")]})});ft.displayName="ActionSpeedDial";const yn=({visible:n,onClose:o})=>{const g=Pe();return n?e.jsx(st,{in:n,children:e.jsxs(pt,{elevation:3,sx:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"auto",minWidth:300,maxWidth:400,p:3,zIndex:1600,backdropFilter:"blur(5px)",backgroundColor:g.palette.mode==="dark"?"rgba(30, 30, 30, 0.9)":"rgba(255, 255, 255, 0.9)",borderRadius:2,border:`1px solid ${g.palette.divider}`},children:[e.jsxs(K,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(mt,{sx:{mr:1}})," Keyboard Shortcuts"]}),e.jsxs(M,{sx:{display:"grid",gridTemplateColumns:"auto 1fr",gap:2,alignItems:"center"},children:[e.jsx(K,{variant:"body2",fontWeight:"bold",children:"Space + Drag"}),e.jsx(K,{variant:"body2",children:"Pan around the canvas"}),e.jsx(K,{variant:"body2",fontWeight:"bold",children:"Ctrl + Scroll"}),e.jsx(K,{variant:"body2",children:"Zoom in/out"}),e.jsx(K,{variant:"body2",fontWeight:"bold",children:"Esc"}),e.jsx(K,{variant:"body2",children:"Close this panel"})]}),e.jsx(M,{sx:{display:"flex",justifyContent:"flex-end",mt:2},children:e.jsx(K,{variant:"body2",color:"primary",sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:o,children:"Close"})})]})}):null},bt=t.memo(({showGrid:n,zoomLevel:o,isPanningEnabled:g,onStartPanning:u,containerStyle:r,containerRef:x,children:R})=>{const b=Pe(),H=t.useRef(null),k=x||H,L=20,W=t.useMemo(()=>L*(100/o),[L,o]),B=t.useMemo(()=>({backgroundSize:n?`${W}px ${W}px`:"initial",backgroundImage:n?`linear-gradient(to right, ${b.palette.divider} 1px, transparent 1px),
       linear-gradient(to bottom, ${b.palette.divider} 1px, transparent 1px)`:"none","&::after":n?{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,pointerEvents:"none",background:`radial-gradient(
        circle at center,
        transparent 30%,
        ${b.palette.background.default} 100%
      )`,zIndex:0}:{}}),[n,W,b.palette.divider,b.palette.background.default]),P=t.useMemo(()=>({display:"flex",flexWrap:"wrap",gap:2,position:"relative",transform:`scale(${o/100})`,transformOrigin:"top left",transition:"transform 0.2s ease",padding:o<100?`${(100-o)/2}px`:0,minWidth:`${1e4/o}%`,height:o<100?`${1e4/o*.01}%`:"auto",...B,...r}),[o,B,r]);return e.jsxs(e.Fragment,{children:[g&&e.jsx(st,{in:!0,children:e.jsxs(M,{sx:{position:"fixed",bottom:80,left:16,zIndex:1e3,backgroundColor:b.palette.mode==="dark"?"rgba(0,0,0,0.7)":"rgba(255,255,255,0.7)",backdropFilter:"blur(4px)",borderRadius:2,padding:1,display:"flex",alignItems:"center",boxShadow:b.shadows[3],border:`1px solid ${b.palette.divider}`},children:[e.jsx(at,{sx:{mr:1,color:b.palette.primary.main}}),e.jsxs(K,{variant:"body2",children:["Press ",e.jsx("b",{children:"Space + Drag"})," to pan"]})]})}),e.jsx(M,{ref:k,className:"frames-container",sx:P,onMouseDown:E=>{g&&(E.target===E.currentTarget||E.target.closest(".frames-container"))&&u(E)},children:R})]})});bt.displayName="FrameGridContainer";const En=()=>{var y,$;const n=Pe(),o=_t(n.breakpoints.down("md")),[g,u]=t.useState(null),[r,x]=t.useState(!1),[R,b]=t.useState(!1),[H,k]=t.useState(!1),[L,W]=t.useState(null),B=t.useRef(null),{frames:P,notification:E,globalSyncEnabled:F,addNewFrame:m,removeFrame:j,handleOptionChange:z,changeCountry:f,copyUrlToClipboard:U,handleIframeLoad:He,showNotification:q,markFrameAsCustomSized:ce,resetFrameCustomSize:de,updateFramePosition:oe,toggleFrameSync:xe,toggleGlobalSync:c,updateFrameSyncOptions:l,refreshFrame:i}=cn(),{frameLayouts:h,resizingFrameId:S,draggedFrameId:T,dragOverFrameId:I,draggingFrame:Z,activeFrameId:w,frameRefs:ue,framesContainerRef:se,expandedConfigFrames:he,handleFrameMoveStart:fe,handleMultiDirectionResize:s,toggleMaximizeHeight:d,resetFrameSize:p,setActiveFrameId:D,snapToGrid:C,setSnapToGrid:v}=pn({frames:P,onUpdateFramePosition:oe,onMarkFrameAsCustomSized:ce}),{zoomLevel:G,showZoomControls:X,handleZoomChange:ee,handleZoomIn:re,handleZoomOut:Ue,toggleZoomControls:ke}=mn({containerRef:B}),{isPanning:J,isPanningEnabled:Y,startPanning:ae,stopPanning:ne,togglePanningMode:be}=gn({parentRef:B});t.useEffect(()=>{const a=O=>{O.key==="Escape"&&H&&k(!1)};return document.addEventListener("keydown",a),()=>{document.removeEventListener("keydown",a)}},[H]),t.useEffect(()=>{const a=()=>{J&&ne()},O=()=>{J&&ne()};return document.addEventListener("mouseup",a),document.addEventListener("mouseleave",O),()=>{document.removeEventListener("mouseup",a),document.removeEventListener("mouseleave",O)}},[J,ne]);const ve=t.useCallback((a,O)=>{u(a.currentTarget),D(O)},[D]),ye=t.useCallback(()=>{u(null),D(null)},[D]),Ce=t.useCallback(a=>{W(a.currentTarget)},[]),Le=t.useCallback(()=>{W(null)},[]),Ze=t.useCallback((a,O)=>{w&&p(w,a,O)},[w,p]),Xe=t.useCallback(()=>{x(a=>!a)},[]),Be=t.useCallback(()=>{v(!C),q(C?"Snap to grid disabled":"Snap to grid enabled")},[C,v,q]),Ee=t.useCallback(()=>{k(a=>!a)},[]),ie=t.useCallback(a=>O=>{ue.current[a]=O},[ue]),We=t.useCallback(()=>{w&&p(w,o?window.innerWidth-40:400)},[w,p,o]),Ae=t.useCallback(()=>{w&&(p(w,o?window.innerWidth-40:400),de(w)),ye()},[w,p,de,ye,o]),A=t.useCallback(()=>{var V,Q,te,Se;if(!P.length)return;const a=w&&((V=h[w])!=null&&V.width)?h[w].width:((Q=h[P[0].id])==null?void 0:Q.width)||400,O=w&&((te=h[w])!=null&&te.height)?h[w].height:((Se=h[P[0].id])==null?void 0:Se.height)||400;P.forEach(Me=>{Me.id!==w&&p(Me.id,a,O)}),q(`All frames synced to ${a}px width and ${O}px height`)},[P,w,h,p,q]),_=t.useMemo(()=>P.map(a=>{const O=h[a.id]||{width:400,height:400,maxHeight:!1},V=O.position||a.position||{x:0,y:0},Q={width:O.width||400,height:O.height||"auto",position:"absolute",left:V.x,top:V.y,transition:T===a.id||S===a.id||Z?"none":"all 0.2s ease",opacity:T===a.id?.6:1,transform:I===a.id?"scale(1.01)":"scale(1)",zIndex:w===a.id?1001:Z&&T===a.id?1e3:1,boxShadow:S===a.id||w===a.id?n.shadows[8]:n.shadows[2]};return e.jsx(M,{ref:ie(a.id),sx:Q,children:e.jsx(gt,{frame:a,layout:O,isActive:w===a.id,isDragging:T===a.id,isResizing:S===a.id,isDraggedOver:I===a.id,isConfigExpanded:he.has(a.id),globalSyncEnabled:F,onMove:fe,onResize:s,onRemove:j,onCopyUrl:U,onMenuOpen:ve,onToggleSync:xe,onIframeLoad:He,onOptionChange:z,onChangeCountry:f,onShowNotification:q,frameRef:null,onUpdateSyncOption:l,onReload:i})},a.id)}),[P,h,T,S,Z,w,he,F,n.shadows,fe,s,j,U,ve,xe,He,z,f,q,ie,I]),pe=t.useMemo(()=>{var a;return e.jsx(N,{onClick:()=>w&&d(w),children:w&&((a=h[w])!=null&&a.maxHeight)?e.jsxs(e.Fragment,{children:[e.jsx(Kt,{fontSize:"small",sx:{mr:1}}),"Reset Height"]}):e.jsxs(e.Fragment,{children:[e.jsx(Vt,{fontSize:"small",sx:{mr:1}}),"Maximize Height"]})})},[w,h,d]);return e.jsxs(M,{ref:B,sx:{height:"100%",width:"100%",overflow:"auto",p:2,backgroundColor:n.palette.background.default,position:"relative",cursor:Y?J?"grabbing":"grab":"default"},children:[e.jsx(bt,{showGrid:r,zoomLevel:G,isPanningEnabled:Y,isPanning:J,onStartPanning:ae,containerRef:se,parentRef:B,children:_}),e.jsx(yn,{visible:H,onClose:Ee}),e.jsxs(qt,{anchorEl:g,open:!!g,onClose:ye,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[pe,e.jsxs(N,{onClick:Ce,children:[e.jsx(Qe,{children:e.jsx(et,{fontSize:"small"})}),e.jsx(Je,{primary:"Change Frame Size",secondary:w?`Current: ${((y=h[w])==null?void 0:y.width)||400}px`:void 0}),e.jsx(Jt,{fontSize:"small"})]}),e.jsxs(N,{onClick:()=>We(),children:[e.jsx(Qe,{children:e.jsx(et,{fontSize:"small"})}),e.jsx(Je,{primary:"Reset Size"})]}),e.jsxs(N,{onClick:Ae,children:[e.jsx(Qe,{children:e.jsx(et,{fontSize:"small"})}),e.jsx(Je,{primary:"Reset All"})]})]}),e.jsx(sn,{anchorEl:L,currentWidth:w&&(($=h[w])==null?void 0:$.width)||400,onClose:Le,onSelect:Ze,onCloseParentMenu:ye}),e.jsx(rn,{message:E,open:!!E}),e.jsx(ft,{open:R,onOpen:()=>b(!0),onClose:()=>b(!1),globalSyncEnabled:F,showGrid:r,snapToGrid:C,showZoomControls:X,isPanningEnabled:Y,onAddFrame:m,onToggleGlobalSync:c,onToggleGrid:Xe,onToggleSnapToGrid:Be,onToggleZoomControls:ke,onTogglePanningMode:be,onSyncFrameSizes:A,onShowKeyboardShortcuts:Ee}),X&&e.jsx(M,{sx:{position:"fixed",bottom:16,right:80,zIndex:1e3,transition:n.transitions.create("all")},children:e.jsx(xt,{zoomLevel:G,onZoomChange:ee,onZoomIn:re,onZoomOut:Ue})})]})};export{En as default};
